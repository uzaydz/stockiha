# ๐ ุฃุฏุงุฉ ุชุดุฎูุต ุงููุฒุงููุฉ - ุฏููู ุงูุงุณุชุฎุฏุงู

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ุฃุฏุงุฉ ุชุดุฎูุต ุดุงููุฉ ููุดุงูู ุงููุฒุงููุฉ ูู ูุงูุฐุฉ ุญุงูุฉ ุงููุฒุงููุฉ. ูุฐู ุงูุฃุฏุงุฉ ุชุณุงุนุฏ ูู:
- ุงูุชุดุงู ุงููุดุงูู ุชููุงุฆูุงู
- ุชูุฏูู ุงูุชุฑุงุญุงุช ููุญููู
- ุฅุตูุงุญ ุงููุดุงูู ุงูุดุงุฆุนุฉ ุจููุฑุฉ ูุงุญุฏุฉ

## ููููุฉ ุงููุตูู

1. ุงููุฑ ุนูู ุฃููููุฉ ุงููุฒุงููุฉ ูู ุดุฑูุท ุงูุนููุงู
2. ูู ุงููุงูุฐุฉ ุงูููุจุซูุฉุ ุงููุฑ ุนูู ุฒุฑ **"ุชุดุฎูุต"** ๐ฉบ
3. ุงูุชุธุฑ ุจุถุน ุซูุงูู ุญุชู ููุชูู ุงููุญุต

## ูุง ูุชู ูุญุตู

### 1. ูุดุงูู Outbox
- โ ุงูุนูููุงุช ุงููุงุดูุฉ
- โ ุงูุนูููุงุช ุงูุนุงููุฉ ูู ุญุงูุฉ "ููุฏ ุงูุฅุฑุณุงู"
- โ ุงูุนูููุงุช ูุน ูุญุงููุงุช ูุชูุฑุฑุฉ

### 2. ุงูุจูุงูุงุช ุบูุฑ ุงููุชุฒุงููุฉ
- โ ุทูุจุงุช ุบูุฑ ูุชุฒุงููุฉ ูููุณุช ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
- โ ุนูุงุตุฑ ุทูุจุงุช ุจุฏูู `order_id`
- โ ุนูุงุตุฑ ูุฑุชุจุทุฉ ุจุทูุจุงุช ูุญุฐููุฉ

### 3. ุณูุงูุฉ ุงูุจูุงูุงุช
- โ ุทูุจุงุช ุจุฏูู `payment_method`
- โ ุนูุงุตุฑ ุจุฏูู `product_id`
- โ ุญููู ูุทููุจุฉ ูุงุฑุบุฉ

### 4. ุงูุนูููุงุช ุงููุญุฐููุฉ
- โ ุนุฑุถ ุขุฎุฑ 20 ุนูููุฉ ุชู ุญุฐููุง ุจุณุจุจ ุฃุฎุทุงุก ุฏุงุฆูุฉ

## ูุฑุงุกุฉ ุงูุชูุฑูุฑ

### ุงูููุฎุต
ูุนุฑุถ 3 ุฃุฑูุงู:
- ๐ด **ุฃุฎุทุงุก**: ูุดุงูู ุฎุทูุฑุฉ ุชููุน ุงููุฒุงููุฉ
- ๐ก **ุชุญุฐูุฑุงุช**: ูุดุงูู ูุฏ ุชุณุจุจ ูุดุงูู ูุงุญูุงู
- ๐ต **ูุนูููุงุช**: ุจูุงูุงุช ููุนูู ููุท

### ูุงุฆูุฉ ุงููุดุงูู
ูู ูุดููุฉ ุชุญุชูู ุนูู:
- **ุงูุฑุณุงูุฉ**: ูุตู ุงููุดููุฉ
- **ุงูุชูุงุตูู**: ูุนูููุงุช ุฅุถุงููุฉ (ุฑูู ุงูุทูุจุ IDุ ุฅูุฎ)
- **๐ก ุงูุงูุชุฑุงุญ**: ููููุฉ ุญู ุงููุดููุฉ

## ุงูุฅุตูุงุญ ุงูุชููุงุฆู

ุนูุฏ ุงูููุฑ ุนูู ุฒุฑ **"๐ง ุฅุตูุงุญ ุชููุงุฆู"**ุ ุณูุชู:

1. โ ุฅุนุงุฏุฉ ุงูุนูููุงุช ุงูุนุงููุฉ ูู `sending` ุฅูู `pending`
2. โ ุชูุธูู ุงูู payloads ูู ุงูุจูุงูุงุช ุบูุฑ ุงูุตุงูุญุฉ
3. โ ุฅุตูุงุญ ุงูุทูุจุงุช ุจุฏูู `payment_method` (ุชุนููู `cash`)
4. โ ุฅุถุงูุฉ ุงูุทูุจุงุช ุบูุฑ ุงููุชุฒุงููุฉ ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
5. โ ุฅุถุงูุฉ ุนูุงุตุฑ ุงูุทูุจุงุช ุงูููููุฏุฉ

## ูุซุงู ุนูู ุงูุงุณุชุฎุฏุงู

### ุงูุณููุงุฑูู: ุทูุจุงุช ูุง ุชุชุฒุงูู

**ุงูุฃุนุฑุงุถ:**
- ุงูุทูุจุงุช ููุฌูุฏุฉ ูุญููุงู
- ูุง ุชุธูุฑ ูู ุงูุณูุฑูุฑ
- ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูุงุถุญุฉ

**ุงูุญู:**
1. ุงูุชุญ ูุงูุฐุฉ ุงููุฒุงููุฉ
2. ุงููุฑ ุนูู "ุชุดุฎูุต"
3. ุณุชุธูุฑ ุฑุณุงูุฉ: "ุทูุจ ุบูุฑ ูุชุฒุงูู ูููุณ ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ"
4. ุงููุฑ ุนูู "ุฅุตูุงุญ ุชููุงุฆู"
5. ุงูุชุธุฑ ุญุชู ููุชูู ุงูุฅุตูุงุญ
6. ุงููุฑ ุนูู "ูุฒุงููุฉ" ูุฅุฑุณุงู ุงูุทูุจุงุช

## ุงูุฅุตูุงุญุงุช ุงูุชููุงุฆูุฉ ูู ุงูุฎูููุฉ

ุจุงูุฅุถุงูุฉ ููุฅุตูุงุญ ุงููุฏููุ ูุชู ุชุดุบูู ุฅุตูุงุญุงุช ุชููุงุฆูุฉ ุนูุฏ ุจุฏุก ุงูุชุทุจูู:

### `ensureDataIntegrity()` ูู SyncManager
ูุชู ุชุดุบูููุง ุชููุงุฆูุงู ุนูุฏ ุจุฏุก ุงููุฒุงููุฉ:
- ุชุตูุญ `payment_method` ุงููุงุฑุบุฉ ูู `pos_orders`
- ุชุตูุญ `payment_method` ูู ุนูููุงุช `sync_outbox` ุงููุนููุฉ

### `backfillUnsyncedOrders()`
ูููู ุชุดุบูููุง ูุฏููุงู ุฃู ุชููุงุฆูุงู:
- ุชุฌุฏ ุงูุทูุจุงุช ุบูุฑ ุงููุชุฒุงููุฉ
- ุชุถูููุง ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
- ุชุตูุญ ุงูุจูุงูุงุช ุงูููููุฏุฉ ูุจู ุงูุฅุถุงูุฉ

## ูุตุงุฆุญ

### ูุชู ุชุณุชุฎุฏู ุงูุชุดุฎูุตุ
- โ ุนูุฏ ููุงุญุธุฉ ุทูุจุงุช ูุง ุชุชุฒุงูู
- โ ุจุนุฏ ุงููุทุงุน ุทููู ูู ุงูุฅูุชุฑูุช
- โ ุนูุฏ ุธููุฑ ุฃุฎุทุงุก ูุชูุฑุฑุฉ
- โ ูุจู ุฅุบูุงู ุงูููู ููุชุฃูุฏ ูู ูุฒุงููุฉ ูู ุดูุก

### ูุชู ุชุณุชุฎุฏู ุงูุฅุตูุงุญ ุงูุชููุงุฆูุ
- โ ุนูุฏ ูุฌูุฏ ุฃุฎุทุงุก ุฃู ุชุญุฐูุฑุงุช ูู ุงูุชูุฑูุฑ
- โ ุนูุฏ ุธููุฑ "ุทูุจ ุบูุฑ ูุชุฒุงูู ูููุณ ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ"
- โ ุจุนุฏ ุชุญุฏูุซ ุงูุชุทุจูู
- โ๏ธ **ูุง ุชุณุชุฎุฏูู** ุฅุฐุง ูุงู ูู ุดูุก ูุนูู ุจุดูู ุทุจูุนู

### ูุงุฐุง ูู ูู ูุญู ุงูุฅุตูุงุญ ุงูุชููุงุฆู ุงููุดููุฉุ
1. ุดุบูู ุงูุชุดุฎูุต ูุฑุฉ ุฃุฎุฑู ูุฑุคูุฉ ูุง ุชุจูู
2. ุงูุฑุฃ ุงูุงูุชุฑุงุญุงุช ุจุนูุงูุฉ
3. ุชุญูู ูู ุณุฌูุงุช Console ูููุฒูุฏ ูู ุงูุชูุงุตูู
4. ุชูุงุตู ูุน ุงูุฏุนู ุงูููู ูุน ููุทุฉ ุดุงุดุฉ ููุชูุฑูุฑ

## ุงููููุงุช ุงููุนููุฉ

- `src/lib/sync/SyncDiagnostics.ts` - ูุญุฑู ุงูุชุดุฎูุต
- `src/lib/sync/SyncManager.ts` - ุงูุฅุตูุงุญุงุช ุงูุชููุงุฆูุฉ
- `src/components/navbar/NavbarSyncIndicator.tsx` - ูุงุฌูุฉ ุงููุณุชุฎุฏู

## API ูููุทูุฑูู

ูููู ุงุณุชุฎุฏุงู ุฃุฏุงุฉ ุงูุชุดุฎูุต ุจุฑูุฌูุงู:

```typescript
import { syncDiagnostics } from '@/lib/sync/SyncDiagnostics';

// ุชุนููู ุงููุคุณุณุฉ
syncDiagnostics.setOrganizationId('org-id');

// ุชุดุบูู ุงูุชุดุฎูุต
const report = await syncDiagnostics.runFullDiagnostics();
console.log(report);

// ุงูุฅุตูุงุญ ุงูุชููุงุฆู
const result = await syncDiagnostics.autoFix();
console.log(result.details);
```

ุฃู ูู Console:
```javascript
// ูุชุงุญ ุนุงูููุงู
window.syncDiagnostics.setOrganizationId('org-id');
const report = await window.syncDiagnostics.runFullDiagnostics();
console.table(report.issues);
```
