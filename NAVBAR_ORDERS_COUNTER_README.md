# عداد الطلبيات في النافبار

## نظرة عامة
نظام عداد ذكي يظهر في النافبار للمشتركين في خطة "تجار إلكترونيين مبتدئين" لمراقبة الطلبيات المتاحة.

## المميزات

### 🎯 **العرض الذكي**
- **يظهر فقط** للمشتركين في الخطة المحددة
- **عداد مرئي** بجانب الإشعارات في النافبار
- **ألوان ذكية** تعكس حالة الاستخدام:
  - 🟢 **أخضر**: عند وجود طلبيات كافية
  - 🟠 **برتقالي**: عند الاقتراب من النهاية (≤30 طلبية)
  - 🔴 **أحمر**: عند تجاوز الحد أو انتهاء الطلبيات

### 📊 **البيانات المعروضة**
- **الطلبيات المتبقية**: العدد المتبقي من الطلبيات
- **حالة المتجر**: نشط/محظور/قريب من الحد
- **نسبة الاستخدام**: شريط تقدم بصري
- **رسائل توضيحية**: tooltips مع تفاصيل الحالة

### 🔔 **الإشعارات الذكية**
- **تنبيهات تلقائية** تحت النافبار
- **مستويات مختلفة**:
  - ℹ️ **معلومات**: عند استخدام 70% من الحد
  - ⚠️ **تحذير**: عند الاقتراب من النهاية (≤30 طلبية)
  - 🚨 **عاجل**: عند الاقتراب من النهاية جداً (≤5 طلبيات)
  - 🚫 **حظر**: عند تجاوز الحد المسموح
- **إخفاء تلقائي** للتنبيهات غير الحرجة
- **إمكانية تجاهل** التنبيهات

## التنفيذ التقني

### 📁 **الملفات الجديدة**

#### `src/hooks/useOnlineOrdersLimit.ts`
```typescript
// Hook لجلب بيانات حدود الطلبيات
const { limitInfo, loading, error, refreshLimit } = useOnlineOrdersLimit();
```

#### `src/components/navbar/OnlineOrdersCounter.tsx`
```typescript
// مكون عداد الطلبيات في النافبار
<OnlineOrdersCounter variant="compact" />
```

#### `src/components/navbar/OrdersLimitNotifications.tsx`
```typescript
// مكون الإشعارات الذكية
<OrdersLimitNotifications />
```

### 🔧 **التكامل مع النافبار**

#### في `src/components/navbar/AdminNavbar.tsx`:
```tsx
// إضافة عداد الطلبيات
<div className="navbar-action-item">
  <OnlineOrdersCounter variant="compact" />
</div>

// إضافة الإشعارات تحت النافبار
<div className="fixed top-16 left-0 right-0 z-40 px-4 py-2">
  <OrdersLimitNotifications />
</div>
```

## التجربة البصرية

### 🎨 **تصميم العداد**
```
┌─────────────┐
│ 🛒 25      │  ← أيقونة عربة + العدد المتبقي
│    ⚫       │  ← مؤشر الحالة (أخضر/برتقالي/أحمر)
└─────────────┘
```

### 📱 **الاستجابة للأجهزة المحمولة**
- **عرض مدمج** على الهواتف
- **عرض كامل** على الأجهزة اللوحية والحاسوب
- **إخفاء ذكي** عند عدم وجود مساحة كافية

## إدارة الحالات

### 🔄 **تحديث البيانات**
- **تحديث تلقائي** كل 5 دقائق
- **تحديث يدوي** عبر زر التحديث
- **تحديث فوري** عند إنشاء طلبية جديدة

### ⚠️ **معالجة الأخطاء**
- **عرض بديل** عند فشل التحميل
- **إخفاء العداد** عند وجود أخطاء
- **إشعار المستخدم** بمشاكل الاتصال

## الاستخدام العملي

### 👤 **للمستخدمين**
1. **مراقبة الاستخدام** الشهري بسهولة
2. **تنبيهات مسبقة** قبل انتهاء الطلبيات
3. **إمكانية الترقية** السريعة من النافبار

### 📊 **للمشرفين**
1. **مراقبة الاستخدام** لجميع المشتركين
2. **تحليل السلوكيات** لتحسين الخطط
3. **دعم فني** مبني على البيانات الفعلية

## الأمان والأداء

### 🔒 **الأمان**
- **التحقق من الصلاحيات** قبل عرض البيانات
- **تشفير البيانات** الحساسة
- **حماية من التزييف** للبيانات

### ⚡ **الأداء**
- **التخزين المؤقت** للبيانات
- **تحميل ذكي** عند الحاجة فقط
- **تحديث تدريجي** للعداد

## التخصيص والتطوير

### 🎨 **تخصيص الألوان**
```css
/* تخصيص ألوان العداد */
.navbar-orders-counter {
  --success-color: #22c55e;
  --warning-color: #f59e0b;
  --danger-color: #ef4444;
}
```

### 🔧 **إضافة مميزات جديدة**
```typescript
// إضافة تنبيهات مخصصة
interface CustomAlert {
  type: 'success' | 'warning' | 'danger';
  message: string;
  action?: () => void;
  autoHide?: boolean;
  duration?: number;
}
```

## الاختبار والجودة

### 🧪 **اختبار المكونات**
```bash
# اختبار مكون عداد الطلبيات
npm test -- --testPathPattern=OnlineOrdersCounter

# اختبار مكون الإشعارات
npm test -- --testPathPattern=OrdersLimitNotifications
```

### 📊 **مراقبة الاستخدام**
```sql
-- مراقبة استخدام المكونات
SELECT
    component_name,
    COUNT(*) as usage_count,
    AVG(load_time) as avg_load_time
FROM component_usage_logs
WHERE component_name IN ('OnlineOrdersCounter', 'OrdersLimitNotifications')
GROUP BY component_name;
```

## الخلاصة

### ✅ **الفوائد الرئيسية**
- **مراقبة فورية** للطلبيات المتاحة
- **تنبيهات ذكية** لإدارة الحدود
- **تجربة مستخدم محسنة**
- **سهولة الترقية** والإدارة

### 🎯 **التأثير على الأعمال**
- **زيادة الوعي** بالاستخدام الشهري
- **تقليل الشكاوى** من انتهاء الطلبيات
- **زيادة معدلات الترقية**
- **تحسين رضا العملاء**

### 🚀 **المستقبل**
- **إضافة إحصائيات مفصلة** في tooltip
- **تكامل مع التقارير** الشهرية
- **إشعارات push** للأجهزة المحمولة
- **تحليلات متقدمة** لسلوكيات الاستخدام

---

**تم تطوير هذا النظام ليوفر أفضل تجربة ممكنة لمستخدمي خطة "تجار إلكترونيين مبتدئين" مع الحفاظ على الأداء والأمان العالي.** 🚀
