<!DOCTYPE html>
<html lang="ar" dir="rtl" class="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>منصة الألعاب الشاملة</title>
    <meta name="description" content="منصة الألعاب الشاملة - متجر ألعاب متكامل لبيع وإصلاح أجهزة الألعاب والإكسسوارات" />
    <meta name="author" content="Game Shop" />
    
    <!-- إضافة سكريبت للتعامل مع وضع الإضاءة -->
    <script>
      // حاول تطبيق الوضع المحفوظ قبل تحميل الصفحة لمنع وميض الشاشة
      const storedTheme = localStorage.getItem('theme') || 'light';
      const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      const initialTheme = storedTheme === 'system' ? systemTheme : storedTheme;
      document.documentElement.classList.add(initialTheme);
      document.documentElement.style.colorScheme = initialTheme;
    </script>
    
    <!-- Polyfill for process -->
    <script>
      window.process = window.process || { env: {} };
      window.global = window.global || window;
    </script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">

    <meta property="og:title" content="منصة الألعاب الشاملة" />
    <meta property="og:description" content="متجر ألعاب متكامل لبيع وإصلاح أجهزة الألعاب والإكسسوارات" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@gameshop" />
    <meta name="twitter:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />
    
    <!-- PWA Support -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#6b21a8">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
    
    <!-- مخصص لـ Vercel و SPA -->
    <meta name="vercel-deployment" content="true">
    <meta name="format-detection" content="telephone=no">

    <!-- تطبيق ألوان المؤسسة فوراً قبل عرض المحتوى -->
    <script>
      (function() {
        try {
          // تحديد hostname الحالي
          const hostname = window.location.hostname;
          
          // محاولة جلب الألوان المخزنة محلياً
          const cachedTheme = localStorage.getItem(`org_theme_${hostname}`);
          if (cachedTheme) {
            const theme = JSON.parse(cachedTheme);
            
            // تطبيق الألوان فوراً على document root
            if (theme.primary) {
              document.documentElement.style.setProperty('--primary', theme.primary, 'important');
              document.documentElement.style.setProperty('--ring', theme.primary, 'important');
              document.documentElement.style.setProperty('--sidebar-primary', theme.primary, 'important');
              document.documentElement.style.setProperty('--sidebar-ring', theme.primary, 'important');
            }
            
            if (theme.secondary) {
              document.documentElement.style.setProperty('--secondary', theme.secondary, 'important');
            }
          }
          
          // جلب الألوان الفردية من localStorage أيضاً كخيار احتياطي
          const primaryColor = localStorage.getItem('theme_primary_color');
          const secondaryColor = localStorage.getItem('theme_secondary_color');
          
          if (primaryColor && !cachedTheme) {
            // تحويل HEX إلى HSL مبسط
            function hexToHSL(hex) {
              const r = parseInt(hex.slice(1, 3), 16) / 255;
              const g = parseInt(hex.slice(3, 5), 16) / 255;
              const b = parseInt(hex.slice(5, 7), 16) / 255;
              
              const max = Math.max(r, g, b);
              const min = Math.min(r, g, b);
              let h, s, l = (max + min) / 2;
              
              if (max === min) {
                h = s = 0;
              } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                  case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                  case g: h = (b - r) / d + 2; break;
                  case b: h = (r - g) / d + 4; break;
                }
                h /= 6;
              }
              
              h = Math.round(h * 360);
              s = Math.round(s * 100);
              l = Math.round(l * 100);
              
              return `${h} ${s}% ${l}%`;
            }
            
            const primaryHSL = hexToHSL(primaryColor);
            document.documentElement.style.setProperty('--primary', primaryHSL, 'important');
            document.documentElement.style.setProperty('--ring', primaryHSL, 'important');
            document.documentElement.style.setProperty('--sidebar-primary', primaryHSL, 'important');
            document.documentElement.style.setProperty('--sidebar-ring', primaryHSL, 'important');
          }
          
          if (secondaryColor && !cachedTheme) {
            const secondaryHSL = hexToHSL(secondaryColor);
            document.documentElement.style.setProperty('--secondary', secondaryHSL, 'important');
          }
          
        } catch (error) {
          console.warn('خطأ في تطبيق الألوان المخزنة محلياً:', error);
        }
      })();
    </script>
  </head>

  <body>
    <div id="root"></div>
    <!-- IMPORTANT: DO NOT REMOVE THIS SCRIPT TAG OR THIS VERY COMMENT! -->
    <script src="https://cdn.gpteng.co/gptengineer.js" type="module"></script>
  </body>
</html>
