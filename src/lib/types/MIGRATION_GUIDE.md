# ุฏููู ุงูุชุฑุญูู ููุฃููุงุน ุงูููุญุฏุฉ

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅูุดุงุก ูุธุงู ุฃููุงุน ููุญุฏ ุฌุฏูุฏ ูุชูุงูู 100% ูุน Supabase schema. ูุฐุง ุงูุฏููู ููุถุญ ููููุฉ ุงูุงูุชูุงู ุงูุชุฏุฑูุฌู ูู ุงูุฃููุงุน ุงููุฏููุฉ ุฅูู ุงูุฌุฏูุฏุฉ.

## ุงููุจุงุฏุฆ ุงูุฃุณุงุณูุฉ

1. **ุฌููุน ุงูุฃุณูุงุก snake_case** - ูุง ููุฌุฏ ุฃู camelCase
2. **ุงูุฃุนูุฏุฉ ุงููุญููุฉ ุชุจุฏุฃ ุจู `_`** - ูุซู `_synced`, `_sync_status`
3. **ุฃุณูุงุก ุงูุฌุฏุงูู ุชุทุงุจู Supabase** - ูุซู `orders` ุจุฏูุงู ูู `pos_orders`

## ุฎุฑูุทุฉ ุงูุฃููุงุน

### ุงูุทูุจูุงุช (Orders)

| ุงููุฏูู | ุงูุฌุฏูุฏ | ุงูููุงุญุธุงุช |
|--------|--------|-----------|
| `LocalPOSOrder` | `LocalOrder` | ููุณ ุงูุญููู ูุน ุชุณููุฉ ููุญุฏุฉ |
| `LocalPOSOrderItem` | `LocalOrderItem` | ููุณ ุงูุญููู |
| - | `CreateOrderInput` | ููุฅูุดุงุก (ุญููู ุงุฎุชูุงุฑูุฉ) |
| - | `CreateOrderItemInput` | ููุฅูุดุงุก (ุญููู ุงุฎุชูุงุฑูุฉ) |

### ุงูููุชุฌุงุช (Products)

| ุงููุฏูู | ุงูุฌุฏูุฏ | ุงูููุงุญุธุงุช |
|--------|--------|-----------|
| `LocalProduct` | `LocalProduct` | ููุณ ุงูุงุณูุ ุจููุฉ ุฌุฏูุฏุฉ |
| - | `LocalProductWithVariants` | ููุชุฌ ูุน ุงูุฃููุงู ูุงูููุงุณุงุช |

### ุงูุนููุงุก (Customers)

| ุงููุฏูู | ุงูุฌุฏูุฏ | ุงูููุงุญุธุงุช |
|--------|--------|-----------|
| `LocalCustomer` (localDb) | `LocalCustomer` (entities) | ุจููุฉ ููุญุฏุฉ |

### ุงูููุธููู (Employees)

| ุงููุฏูู | ุงูุฌุฏูุฏ | ุงูููุงุญุธุงุช |
|--------|--------|-----------|
| - | `LocalEmployee` | ููุน ุฌุฏูุฏ |
| - | `LocalEmployeeSalary` | ุฑูุงุชุจ ุงูููุธููู |

## ููููุฉ ุงูุงุณุชุฎุฏุงู

### ุงูุทุฑููุฉ 1: ุงูุงุณุชูุฑุงุฏ ุงููุจุงุดุฑ (ูููุถูู ููููุฏ ุงูุฌุฏูุฏ)

```typescript
// ุงุณุชูุฑุงุฏ ุงูุฃููุงุน ุงูููุญุฏุฉ ูุจุงุดุฑุฉ
import type {
  LocalOrder,
  LocalOrderItem,
  CreateOrderInput,
} from '@/lib/types/entities/order';

// ุงุณุชุฎุฏุงู
const order: LocalOrder = { ... };
```

### ุงูุทุฑููุฉ 2: ูู localDb (ููุชูุงูู ุงูุนูุณู)

```typescript
// ุงูุฃููุงุน ุงููุฏููุฉ (ููุชูุงูู)
import type { LocalPOSOrder, LocalPOSOrderItem } from '@/database/localDb';

// ุงูุฃููุงุน ุงูุฌุฏูุฏุฉ (ููุชุฑุญูู)
import type {
  UnifiedLocalOrder,
  UnifiedLocalOrderItem,
} from '@/database/localDb';
```

### ุงูุทุฑููุฉ 3: ูู ุงูููุฑุณ ุงูุฑุฆูุณู

```typescript
import type {
  LocalOrder,
  LocalOrderItem,
  LocalProduct,
  LocalCustomer,
} from '@/lib/types';
```

## ุชุญุฏูุซ ุงูุฎุฏูุงุช

### ูุจู (ุงููุฏูู)

```typescript
import type { LocalPOSOrder } from '@/database/localDb';

const createOrder = async (data: any): Promise<LocalPOSOrder> => {
  // ...
};
```

### ุจุนุฏ (ุงูุฌุฏูุฏ)

```typescript
import type { LocalOrder, CreateOrderInput } from '@/lib/types/entities/order';

const createOrder = async (data: CreateOrderInput): Promise<LocalOrder> => {
  // ...
};
```

## ุงูุญููู ุงููุญููุฉ (Local-Only)

ุงูุญููู ุงูุชู ุชุจุฏุฃ ุจู `_` ูู ููุงุณุชุฎุฏุงู ุงููุญูู ููุท ููุง ุชูุฑุณู ูู Supabase:

```typescript
interface LocalSyncColumns {
  _synced: boolean;           // ุญุงูุฉ ุงููุฒุงููุฉ
  _sync_status: SyncStatus;   // pending | syncing | synced | error
  _pending_operation?: PendingOperation; // create | update | delete
  _error?: string;            // ุฑุณุงูุฉ ุงูุฎุทุฃ
  _last_sync_attempt?: string; // ุขุฎุฑ ูุญุงููุฉ ูุฒุงููุฉ
  _local_created_at: string;  // ุชุงุฑูุฎ ุงูุฅูุดุงุก ุงููุญูู
  _server_created_at?: string; // ุชุงุฑูุฎ ุงูุฅูุดุงุก ุนูู ุงูุณูุฑูุฑ
}
```

## ุฃุณูุงุก ุงูุฌุฏุงูู

| ุงููุฏูู (SQLite) | Supabase | ุงูููุงุญุธุงุช |
|-----------------|----------|-----------|
| `pos_orders` | `orders` | ุชู ุชูุญูุฏ ุงูุงุณู |
| `pos_order_items` | `order_items` | ุชู ุชูุญูุฏ ุงูุงุณู |
| `products` | `products` | ููุณ ุงูุงุณู |
| `customers` | `customers` | ููุณ ุงูุงุณู |

## ุงูุชุฑุญูู ุงูุชุฏุฑูุฌู

### ุงููุฑุญูุฉ 1: ุฅุถุงูุฉ ุงูุฃููุงุน ุงูุฌุฏูุฏุฉ โ
- [x] ุฅูุดุงุก ูููุงุช ุงูุฃููุงุน ูู `@/lib/types/entities/`
- [x] ุฅุนุงุฏุฉ ุชุตุฏูุฑ ุงูุฃููุงุน ูู `@/database/localDb`

### ุงููุฑุญูุฉ 2: ุชุญุฏูุซ ุงูุฎุฏูุงุช ๐
- [x] `localPosOrderService.ts` - ุฅุถุงูุฉ ุชุนูููุงุช ุงูุชุฑุญูู
- [x] `DeltaWriteService.ts` - ุชุตุฏูุฑ ุงูุฃููุงุน ุงูููุญุฏุฉ
- [ ] ุชุญุฏูุซ ุจุงูู ุงูุฎุฏูุงุช

### ุงููุฑุญูุฉ 3: ุชุญุฏูุซ ุงูููููุงุช
- [ ] ุชุญุฏูุซ ููููุงุช POS
- [ ] ุชุญุฏูุซ ููููุงุช ุงูููุชุฌุงุช
- [ ] ุชุญุฏูุซ ููููุงุช ุงูุนููุงุก

### ุงููุฑุญูุฉ 4: ุฅุฒุงูุฉ ุงูุฃููุงุน ุงููุฏููุฉ
- [ ] ุฅุฒุงูุฉ ุงูุชุนุฑููุงุช ุงููุฏููุฉ ูู `localDb.ts`
- [ ] ุชุญุฏูุซ ุฌููุน ุงูุงุณุชูุฑุงุฏุงุช

## ุงูุฃููุงุน ุงููุชุงุญุฉ

### ุงูููุงูุงุช

```
@/lib/types/entities/
โโโ product.ts       # ุงูููุชุฌุงุช ูุงูุฃููุงู ูุงูููุงุณุงุช
โโโ order.ts         # ุงูุทูุจูุงุช ูุนูุงุตุฑูุง
โโโ customer.ts      # ุงูุนููุงุก ูุงูุนูุงููู
โโโ supplier.ts      # ุงูููุฑุฏูู
โโโ employee.ts      # ุงูููุธููู ูุงูุฑูุงุชุจ
โโโ work-session.ts  # ุฌูุณุงุช ุงูุนูู
โโโ repair.ts        # ุงูุชุตููุญุงุช
โโโ invoice.ts       # ุงูููุงุชูุฑ
โโโ return.ts        # ุงููุฑุชุฌุนุงุช
โโโ expense.ts       # ุงููุตุฑููุงุช
โโโ loss.ts          # ุงูุฎุณุงุฆุฑ
โโโ supplier-purchase.ts # ูุดุชุฑูุงุช ุงูููุฑุฏูู
โโโ index.ts         # ุงูููุฑุณ
```

### ุงูุฃููุงุน ุงููุดุชุฑูุฉ

```typescript
// @/lib/types/common.ts

type Nullable<T> = T | null;
type SyncStatus = 'pending' | 'syncing' | 'synced' | 'error';
type PendingOperation = 'create' | 'update' | 'delete';
type PaymentMethod = 'cash' | 'card' | 'bank_transfer' | ...;
type PaymentStatus = 'pending' | 'partial' | 'paid' | 'refunded' | ...;
```

## ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ

### ุณ: ูู ูุฌุจ ุชุญุฏูุซ ุฌููุน ุงููููุงุช ููุฑุงูุ
**ุฌ:** ูุง. ุงูุฃููุงุน ุงููุฏููุฉ ูุง ุชุฒุงู ุชุนูู. ููููู ุงูุชุฑุญูู ุชุฏุฑูุฌูุงู.

### ุณ: ูุงุฐุง ูู ุงุณุชุฎุฏูุช ุงูุฃููุงุน ุงูุฌุฏูุฏุฉ ูุงููุฏููุฉ ูุนุงูุ
**ุฌ:** ูุนูู ุจุดูู ุทุจูุนู. ุงูุฃููุงุน ูุชูุงููุฉ.

### ุณ: ูู ูุชุบูุฑ schema ูุงุนุฏุฉ ุงูุจูุงูุงุชุ
**ุฌ:** ูุง. ููุท ุงูุฃููุงุน ูู TypeScript ุชุชุบูุฑ.
