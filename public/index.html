<!DOCTYPE html>
<html lang="ar" dir="rtl" class="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=5">
  
  <!-- 🔥 سكريپت ديناميكي مبسط للعنوان والأيقونة -->
  <script>
    console.log('🔥 START: بدء السكريپت الديناميكي');
    
    try {
      const hostname = window.location.hostname;
      console.log('🔍 فحص النطاق:', hostname);
      
      // فحص النطاق الفرعي في localhost
      if (hostname.includes('.localhost')) {
        const subdomain = hostname.split('.')[0];
        console.log('✅ نطاق فرعي مكتشف:', subdomain);
        
        if (subdomain && subdomain !== 'www' && subdomain !== 'localhost') {
          console.log('🏪 متجر مكتشف:', subdomain);
          
          // محاولة قراءة البيانات المحفوظة
          try {
            const storeData = sessionStorage.getItem('store_' + subdomain);
            if (storeData) {
              const data = JSON.parse(storeData);
              console.log('💾 بيانات محفوظة موجودة:', data.name);
              document.title = data.name;
              console.log('✅ تم تحديث العنوان إلى:', document.title);
              
              // تحديث الأيقونة إذا وجدت
              if (data.favicon_url || data.logo_url) {
                setTimeout(function() {
                  const favicon = document.querySelector('link[rel="icon"]');
                  if (favicon) {
                    favicon.href = data.favicon_url || data.logo_url;
                    console.log('✅ تم تحديث الأيقونة');
                  }
                }, 10);
              }
            } else {
              console.log('💡 لا توجد بيانات محفوظة، استخدام عنوان افتراضي');
              document.title = 'متجر ' + subdomain;
              console.log('✅ تم تعيين عنوان افتراضي:', document.title);
            }
          } catch (e) {
            console.error('❌ خطأ في قراءة البيانات:', e);
            document.title = 'متجر ' + subdomain;
          }
        } else {
          console.log('🌐 صفحة رئيسية أو لوحة تحكم');
        }
      } else {
        console.log('🌍 نطاق عادي أو عام');
      }
      
    } catch (error) {
      console.error('❌ خطأ في السكريپت الديناميكي:', error);
    }
    
    console.log('🔥 END: انتهاء السكريپت الديناميكي');
  </script>
  
  <!-- العنوان والوصف الافتراضي -->
  <title>سطوكيها - منصة إدارة المتاجر الذكية</title>
  <meta name="description" content="سطوكيها - منصة إدارة المتاجر الذكية لإنشاء متجرك الإلكتروني وإدارة المبيعات والمخزون بكل سهولة" />
  <meta name="keywords" content="إدارة متجر، نقطة بيع، متجر إلكتروني، POS، إدارة مخزون، سطوكيها" />
  <meta name="author" content="سطوكيها" />
  
  <!-- الأيقونة الافتراضية -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  
  <!-- نظام إدارة الثيمات -->
  <script>
    try {
      const storedTheme = localStorage.getItem('theme') || 'light';
      const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      const initialTheme = storedTheme === 'system' ? systemTheme : storedTheme;
      
      document.documentElement.classList.add(initialTheme);
      document.documentElement.style.colorScheme = initialTheme;
      
      const orgTheme = localStorage.getItem('bazaar_org_theme');
      if (orgTheme) {
        try {
          const theme = JSON.parse(orgTheme);
          if (theme.primaryColor) {
            document.documentElement.style.setProperty('--primary', theme.primaryColor);
          }
        } catch (e) {}
      }
    } catch (error) {
      console.warn('خطأ في تطبيق الثيم:', error);
    }
  </script>
  
  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="سطوكيها - منصة إدارة المتاجر الذكية" />
  <meta property="og:description" content="سطوكيها - منصة إدارة المتاجر الذكية لإنشاء متجرك الإلكتروني وإدارة المبيعات والمخزون بكل سهولة" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="سطوكيها" />
  <meta property="og:locale" content="ar_SA" />
  
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="سطوكيها - منصة إدارة المتاجر الذكية" />
  <meta name="twitter:description" content="سطوكيها - منصة إدارة المتاجر الذكية لإنشاء متجرك الإلكتروني وإدارة المبيعات والمخزون بكل سهولة" />
  
  <!-- الخطوط -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- الأنماط الأساسية -->
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Cairo', sans-serif;
      background-color: #f8fafc;
      color: #1e293b;
      line-height: 1.6;
    }
    
    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #ffffff;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    
    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #e2e8f0;
      border-top: 4px solid #3b82f6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .loading-text {
      color: #64748b;
      font-size: 16px;
      text-align: center;
    }
    
    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <!-- شاشة التحميل -->
  <div class="loading-screen" id="loadingScreen">
    <div class="loading-spinner"></div>
    <div class="loading-text" id="loadingText">جاري تحميل المتجر...</div>
  </div>
  
  <!-- المحتوى الرئيسي -->
  <div id="root"></div>
  
  <!-- تحديث نص التحميل حسب نوع الصفحة -->
  <script>
    try {
      const hostname = window.location.hostname;
      const loadingText = document.getElementById('loadingText');
      
      if (hostname.includes('.localhost')) {
        const subdomain = hostname.split('.')[0];
        if (subdomain && subdomain !== 'www' && subdomain !== 'localhost') {
          loadingText.textContent = 'جاري تحميل متجر ' + subdomain + '...';
        }
      } else if (window.location.pathname.startsWith('/admin') || window.location.pathname.startsWith('/dashboard')) {
        loadingText.textContent = 'جاري تحميل لوحة التحكم...';
      } else {
        loadingText.textContent = 'جاري تحميل سطوكيها...';
      }
    } catch (e) {
      console.warn('خطأ في تحديث نص التحميل:', e);
    }
  </script>
  
  <!-- إخفاء شاشة التحميل عند اكتمال التحميل -->
  <script>
    window.addEventListener('load', function() {
      setTimeout(function() {
        const loadingScreen = document.getElementById('loadingScreen');
        if (loadingScreen) {
          loadingScreen.classList.add('hidden');
        }
      }, 500);
    });
    
    // إخفاء شاشة التحميل إذا استغرق React وقتاً طويلاً
    setTimeout(function() {
      const loadingScreen = document.getElementById('loadingScreen');
      if (loadingScreen) {
        loadingScreen.classList.add('hidden');
      }
    }, 5000);
  </script>
  
  <!-- سكريپت React (سيتم إضافته بواسطة Vite) -->
  <script type="module" src="/src/main.tsx"></script>
</body>
</html> 