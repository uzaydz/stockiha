-- ======================================================================
-- تحديث حدود خطة التجار المبتدئين
-- تاريخ الإنشاء: 2025-08-25
-- ======================================================================

-- 1. تحديث حدود خطة التجار المبتدئين
UPDATE subscription_plans 
SET 
  limits = '{"max_pos": 0, "max_users": 3, "max_products": null}'::jsonb,
  features = '[
    "100 طلبية إلكترونية شهرياً",
    "متجر إلكتروني كامل الميزات", 
    "إدارة منتجات ومخزون",
    "تقارير المبيعات الأساسية",
    "دعم فني عبر البريد الإلكتروني",
    "إمكانية ترقية للمزيد من الطلبيات",
    "حتى 3 مستخدمين",
    "منتجات غير محدودة"
  ]'::jsonb
WHERE code = 'ecommerce_starter';

-- 2. التحقق من التحديث
SELECT 
  name,
  code,
  limits,
  features
FROM subscription_plans 
WHERE code = 'ecommerce_starter';

-- 3. إعادة بناء التخزين المؤقت لجميع المؤسسات التي تستخدم هذه الخطة
-- (اختياري - يمكن تشغيله لاحقاً)
-- SELECT check_organization_subscription_enhanced(org.id)
-- FROM organizations org
-- JOIN organization_subscriptions os ON org.id = os.organization_id
-- JOIN subscription_plans sp ON os.plan_id = sp.id
-- WHERE sp.code = 'ecommerce_starter';

-- ======================================================================
-- ملاحظات:
-- ======================================================================
-- 1. تم تحديث max_users من 1 إلى 3
-- 2. تم تحديث max_products من 50 إلى null (غير محدود)
-- 3. تم تحديث الميزات لتشمل المعلومات الجديدة
-- 4. بعد التحديث، ستظهر البيانات الصحيحة في الواجهة
-- ======================================================================
