# ๐ ุฏููู ุตูุงูุฉ ูุงุนุฏุฉ ุจูุงูุงุช Bazaar

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ
ูุฐุง ุงููุฌูุฏ ูุญุชูู ุนูู ูููุงุช SQL ูุชุญุณูู ูุตูุงูุฉ ูุงุนุฏุฉ ุจูุงูุงุช ูุธุงู Bazaar.

## ๐ ุงููููุงุช ุงููุชุงุญุฉ

### 1. `bazaar_performance_optimization.sql`
**ุงูุบุฑุถ**: ุงูุชุญุณููุงุช ุงูุฃุณุงุณูุฉ ููุฃุฏุงุก
**ุงูุชุดุบูู**: ูุฑุฉ ูุงุญุฏุฉ ููุท
**ุงูููุช**: ูู ููุช ุงูุตูุงูุฉ (ููุถู ูููุงู)

```sql
-- ูู Supabase SQL Editor
\i sql/bazaar_performance_optimization.sql
```

**ุงููุญุชูู**:
- ุฅูุดุงุก ููุงุฑุณ ูุญุณูุฉ
- ุฅูุดุงุก ุฌุฏูู cache
- ุฅูุดุงุก triggers ูุฏูุงู ูุญุณูุฉ
- ููุก cache ูููุคุณุณุงุช ุงููุดุทุฉ

### 2. `bazaar_maintenance_jobs.sql`
**ุงูุบุฑุถ**: ููุงู ุงูุตูุงูุฉ ุงูุฏูุฑูุฉ
**ุงูุชุดุบูู**: ุฏูุฑูุงู (ููููุงู/ุฃุณุจูุนูุงู/ุดูุฑูุงู)
**ุงูููุช**: ูููู ุชุดุบููู ุฃุซูุงุก ุนูู ุงููุธุงู

```sql
-- ูู Supabase SQL Editor
\i sql/bazaar_maintenance_jobs.sql
```

**ุงููุญุชูู**:
- ุชูุธูู cache ุงูููุชูู ุงูุตูุงุญูุฉ
- ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช
- ูุญุต ุตุญุฉ cache
- ุชุญุณูู ุงูุฌุฏุงูู

### 3. `bazaar_concurrent_maintenance.sql`
**ุงูุบุฑุถ**: ููุงู ุงูุตูุงูุฉ ุงููุชุฒุงููุฉ
**ุงูุชุดุบูู**: ุฃุณุจูุนูุงู
**ุงูููุช**: ูุฌุจ ุชุดุบููู ุจุฏูู transaction block

```sql
-- ูู Supabase SQL Editor (ุจุฏูู transaction)
\i sql/bazaar_concurrent_maintenance.sql
```

**ุงููุญุชูู**:
- ุฅุนุงุฏุฉ ุจูุงุก ุงูููุงุฑุณ ุจุงุณุชุฎุฏุงู CONCURRENTLY
- ุฅูุดุงุก ููุงุฑุณ ุฌุฏูุฏุฉ ูุญุณูุฉ
- ุชุญุณูู ููุงุฑุณ ุงูุฌุฏุงูู ุงููุฑุชุจุทุฉ

## โ๏ธ ุชุญุฐูุฑุงุช ูููุฉ

### 1. ุชุฑุชูุจ ุงูุชุดุบูู
```bash
# ุงูุฎุทูุฉ 1: ุงูุชุญุณููุงุช ุงูุฃุณุงุณูุฉ (ูุฑุฉ ูุงุญุฏุฉ)
\i sql/bazaar_performance_optimization.sql

# ุงูุฎุทูุฉ 2: ููุงู ุงูุตูุงูุฉ ุงูุฏูุฑูุฉ (ููููุงู)
\i sql/bazaar_maintenance_jobs.sql

# ุงูุฎุทูุฉ 3: ููุงู ุงูุตูุงูุฉ ุงููุชุฒุงููุฉ (ุฃุณุจูุนูุงู)
\i sql/bazaar_concurrent_maintenance.sql
```

### 2. ูุชุทูุจุงุช CONCURRENTLY
- `bazaar_concurrent_maintenance.sql` ูุฌุจ ุชุดุบููู **ุจุฏูู transaction block**
- ุงุณุชุฎุฏู Supabase SQL Editor ูุจุงุดุฑุฉ
- ูุง ุชุณุชุฎุฏู `BEGIN; ... COMMIT;`

### 3. ุชูููุช ุงูุชุดุบูู
- **ุงูุชุญุณููุงุช ุงูุฃุณุงุณูุฉ**: ูุฑุฉ ูุงุญุฏุฉ ููุท
- **ุงูุตูุงูุฉ ุงูุฏูุฑูุฉ**: ููููุงู (ุฃุซูุงุก ุนูู ุงููุธุงู)
- **ุงูุตูุงูุฉ ุงููุชุฒุงููุฉ**: ุฃุณุจูุนูุงู (ูู ููุช ุงูุตูุงูุฉ)

## ๐ง ุฌุฏููุฉ ุงูููุงู

### ููููุงู
```sql
-- ุชูุธูู cache ูุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช
\i sql/bazaar_maintenance_jobs.sql
```

### ุฃุณุจูุนูุงู
```sql
-- ุฅุนุงุฏุฉ ุจูุงุก ุงูููุงุฑุณ (ุจุฏูู ููู ุงูุฌุฏุงูู)
\i sql/bazaar_concurrent_maintenance.sql
```

### ุดูุฑูุงู
```sql
-- ุชุญุณูู ุดุงูู ููุฌุฏุงูู
VACUUM FULL organizations;  -- ูู ููุช ุงูุตูุงูุฉ ููุท
```

## ๐ ูุฑุงูุจุฉ ุงูุฃุฏุงุก

### ูุญุต ุฃุฏุงุก Cache
```sql
-- ุชูุฑูุฑ ุฃุฏุงุก cache
SELECT 
    COUNT(*) as total_organizations,
    COUNT(CASE WHEN expires_at > NOW() THEN 1 END) as cached_orgs,
    ROUND((COUNT(CASE WHEN expires_at > NOW() THEN 1 END)::NUMERIC / COUNT(*)) * 100, 2) as cache_hit_rate
FROM organization_cache;
```

### ูุญุต ุงูููุงุฑุณ
```sql
-- ูุญุต ุงูููุงุฑุณ ุงููุญุณูุฉ
SELECT 
    indexname,
    indexdef
FROM pg_indexes 
WHERE tablename = 'organizations' 
AND indexname LIKE '%optimized%';
```

## ๐จ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฎุทุฃ: "cannot run inside a transaction block"
**ุงูุณุจุจ**: ูุญุงููุฉ ุชุดุบูู CONCURRENTLY ุฏุงุฎู transaction
**ุงูุญู**: ุชุดุบูู ุงูููู ูู Supabase SQL Editor ูุจุงุดุฑุฉ

### ุฎุทุฃ: "function does not exist"
**ุงูุณุจุจ**: ุนุฏู ุชุดุบูู ููู ุงูุชุญุณููุงุช ุงูุฃุณุงุณูุฉ
**ุงูุญู**: ุชุดุบูู `bazaar_performance_optimization.sql` ุฃููุงู

### ุฎุทุฃ: "index already exists"
**ุงูุณุจุจ**: ูุญุงููุฉ ุฅูุดุงุก ููุฑุณ ููุฌูุฏ
**ุงูุญู**: ุชุฌุงูู ุงูุฎุทุฃ ุฃู ุงุณุชุฎุฏุงู `IF NOT EXISTS`

## ๐ ุงูุฏุนู
ูู ุญุงูุฉ ููุงุฌูุฉ ุฃู ูุดุงูู:
1. ุชุญูู ูู ุชุฑุชูุจ ุชุดุบูู ุงููููุงุช
2. ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ transaction block
3. ุฑุงุฌุน logs ูู Supabase Dashboard
4. ุชุฃูุฏ ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู

## ๐ฏ ุงููุชุงุฆุฌ ุงููุชููุนุฉ
- **ุชูููู ููุช ุงูุชุญููู**: ูู 3000ms ุฅูู < 500ms
- **ุชุญุณูู ุฃุฏุงุก ุงูุงุณุชุนูุงูุงุช**: ูู 1032ms ุฅูู < 50ms
- **ุชูููู ุงูุญูู ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช**: ุจูุณุจุฉ 60%
- **ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู**: ููุฒูุงุฑ ุงูุฌุฏุฏ ูุงูุนุงุฆุฏูู
