# ๐ ุฏููู ุญู ูุดููุฉ ุชุณุฌูู ุงูุฏุฎูู ุงููุฒุฏูุฌ ุจูู ุงููุทุงูุงุช

## ๐ ููุฎุต ุงููุดููุฉ
ุงููุณุชุฎุฏู ููุงุฌู ูุดููุฉ ูู ุชุณุฌูู ุงูุฏุฎูู:
1. ูุณุฌู ุงูุฏุฎูู ูู ุงููููุน ุงูุฑุฆูุณู (ูุซู `stockiha.com`)
2. ูุชู ุชูุฌููู ุฅูู ุงููุทุงู ุงููุฑุนู (ูุซู `org.stockiha.com`)
3. **ููุทูุจ ููู ุชุณุฌูู ุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑู** โ

## ๐ฏ ุงูุญู ุงููุทุจู

### 1. ูุธุงู ููู ุงูุฌูุณุฉ Cross-Domain
ุชู ุฅูุดุงุก ูุธุงู ุดุงูู ูููู ุงูุฌูุณุฉ ุจูู ุงููุทุงูุงุช:

#### ุงููููุงุช ุงูุฌุฏูุฏุฉ:
- **`src/lib/cross-domain-auth.ts`** - ุงููุธุงู ุงูุฃุณุงุณู ูููู ุงูุฌูุณุฉ
- **`src/components/auth/CrossDomainSessionReceiver.tsx`** - ูููู ุงุณุชูุจุงู ุงูุฌูุณุฉ

### 2. ุขููุฉ ุงูุนูู

#### ุนูุฏ ุงูุชูุฌูู ูู ุงููุทุงู ุงูุฑุฆูุณู:
1. **ุญูุธ ุงูุฌูุณุฉ**: ูุชู ุญูุธ ุจูุงูุงุช ุงูุฌูุณุฉ ูู `localStorage` ูุน ุชุดููุฑ base64
2. **ุฅุถุงูุฉ ูุนุงููุงุช URL**: ูุชู ุฅุถุงูุฉ `?transfer_session=true` ููุฅุดุงุฑุฉ ููุฌูุฏ ุฌูุณุฉ ูููููุฉ
3. **ุงูุชูุฌูู ุงูุขูู**: ุงุณุชุฎุฏุงู `redirectWithSession()` ุจุฏูุงู ูู `window.location.replace()`

#### ุนูุฏ ุงููุตูู ูููุทุงู ุงููุฑุนู:
1. **ูุญุต ุชููุงุฆู**: `CrossDomainSessionReceiver` ููุญุต ูุฌูุฏ ูุนุงูู `transfer_session`
2. **ุงุณุชุฑุฌุงุน ุงูุฌูุณุฉ**: ูุชู ุงุณุชุฑุฌุงุน ููู ุชุดููุฑ ุจูุงูุงุช ุงูุฌูุณุฉ
3. **ุชุทุจูู ุงูุฌูุณุฉ**: ุงุณุชุฎุฏุงู `supabase.auth.setSession()` ูุชุทุจูู ุงูุฌูุณุฉ
4. **ุชูุธูู ุงูุจูุงูุงุช**: ุญุฐู ุงูุจูุงูุงุช ุงููุคูุชุฉ ุจุนุฏ ุงูุชุทุจูู

### 3. ุงูุฃูุงู ูุงูุญูุงูุฉ

#### ุชุฃููู ุงูุจูุงูุงุช:
- โ **ุงูุชูุงุก ุตูุงุญูุฉ**: ุงูุฌูุณุฉ ุชูุชูู ุจุนุฏ 5 ุฏูุงุฆู
- โ **ุชุดููุฑ ุงูุจูุงูุงุช**: ุงุณุชุฎุฏุงู base64 ููุชุดููุฑ ุงูุฃุณุงุณู
- โ **ุชูุธูู ุชููุงุฆู**: ุญุฐู ุงูุจูุงูุงุช ุจุนุฏ ุงูุงุณุชุฎุฏุงู
- โ **ุงูุชุญูู ูู ุงูุตุญุฉ**: ูุญุต ุตุญุฉ ุงูุฌูุณุฉ ูุจู ุงูุชุทุจูู

#### ููุน ุงูุชูุงุนุจ:
- โก **ุชุญูู ูู ุงูุชูููุช**: ูุญุต ุฃู ุงูุฌูุณุฉ ููุณุช ูุฏููุฉ
- ๐ **ุชุญูู ูู ุงูุจูุงูุงุช**: ุงูุชุฃูุฏ ูู ูุฌูุฏ `access_token` ู `user`
- ๐งน **ุชูุธูู URL**: ุฅุฒุงูุฉ ูุนุงููุงุช ุงูููู ูู URL ุจุนุฏ ุงูุงุณุชุฎุฏุงู

## ๐ ุงูุชุทุจูู

### ุงูุชุนุฏููุงุช ุงููุทุจูุฉ:

#### 1. ูู `LoginForm.tsx`:
```typescript
// ูุจู - ุงูุชูุฌูู ุงูุนุงุฏู
window.location.replace(`${protocol}//${subdomain}.${domain}/dashboard`);

// ุจุนุฏ - ุงูุชูุฌูู ูุน ููู ุงูุฌูุณุฉ
const { redirectWithSession, generateSubdomainUrl } = await import('@/lib/cross-domain-auth');
const targetUrl = generateSubdomainUrl(orgData.subdomain, '/dashboard');
redirectWithSession(targetUrl);
```

#### 2. ูู `App.tsx`:
```typescript
// ุฅุถุงูุฉ CrossDomainSessionReceiver ูู wrapper
<CrossDomainSessionReceiver>
  <SessionMonitor />
  <ErrorMonitor />
  {/* ุจุงูู ุงูููููุงุช */}
</CrossDomainSessionReceiver>
```

#### 3. ุชูููู Supabase:
```typescript
// ุชุญุณูู ุฅุนุฏุงุฏุงุช cross-domain
configureCrossDomainAuth(); // ูุชู ุงุณุชุฏุนุงุคูุง ุนูุฏ ุจุฏุก ุงูุชุทุจูู
```

## ๐ง ุงูุงุณุชุฎุฏุงู

### ูููุทูุฑูู:
```typescript
import { redirectWithSession, generateSubdomainUrl } from '@/lib/cross-domain-auth';

// ุชูุฌูู ูุน ููู ุงูุฌูุณุฉ
const targetUrl = generateSubdomainUrl('subdomain', '/dashboard');
await redirectWithSession(targetUrl);
```

### ูููุณุชุฎุฏููู:
1. **ุชุณุฌูู ุงูุฏุฎูู ุงูุนุงุฏู** ูู ุงููููุน ุงูุฑุฆูุณู
2. **ุงูุชุธุงุฑ ุฑุณุงูุฉ "ุฌุงุฑู ุงุณุชูุจุงู ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู..."** ูู ุงููุทุงู ุงููุฑุนู
3. **ุงููุตูู ุงูุชููุงุฆู** ุฅูู ููุญุฉ ุงูุชุญูู **ุจุฏูู ุชุณุฌูู ุฏุฎูู ูุฌุฏุฏุงู** โ

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุฑุณุงุฆู ุงูุญุงูุฉ:
- โณ **"ุฌุงุฑู ุงุณุชูุจุงู ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู..."** - ุฃุซูุงุก ุงููุนุงูุฌุฉ
- โ **"ุชู ุงุณุชูุจุงู ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ"** - ุนูุฏ ุงููุฌุงุญ
- โ **"ูุดู ูู ุชุทุจูู ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู"** - ุนูุฏ ุงููุดู (ูุน ุฑุงุจุท ุชุณุฌูู ุฏุฎูู ูุฏูู)

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฅุฐุง ูู ูุนูู ุงูููู:
1. **ุชุญูู ูู Console**: ุงุจุญุซ ุนู ุฑุณุงุฆู ุงููุธุงู
2. **ุชุญูู ูู localStorage**: ูุญุต ูุฌูุฏ `cross_domain_session`
3. **ุชุญูู ูู URL**: ูุฌูุฏ ูุนุงูู `transfer_session=true`

### ุฑุณุงุฆู Console ุงููููุฏุฉ:
```
๐พ ุชู ุญูุธ ุงูุฌูุณุฉ ููููู ุฅูู: [URL]
โ ุชู ุชุทุจูู ุงูุฌูุณุฉ ุงููููููุฉ ุจูุฌุงุญ
โ ุชู ุงูุชุญูู ูู ุตุญุฉ ุงูุฌูุณุฉ ุงููููููุฉ
๐ง ุชู ุชุนููู cookie domain ุฅูู: .[domain]
```

## ๐ ุงูููุงุฆุฏ

### ูููุณุชุฎุฏููู:
- โ **ุชุฌุฑุจุฉ ุณูุณุฉ**: ุชุณุฌูู ุฏุฎูู ูุงุญุฏ ููุท
- โก **ุณุฑุนุฉ ุงููุตูู**: ูุง ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุฅุฏุฎุงู ุงูุจูุงูุงุช
- ๐ **ุฃูุงู ูุญุณู**: ููู ุขูู ููุฌูุณุฉ

### ูููุทูุฑูู:
- ๐ **ุณูููุฉ ุงูุตูุงูุฉ**: ูุธุงู ูููุตู ููุงุจู ููุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู
- ๐ฑ **ุฏุนู ุดุงูู**: ูุนูู ูุน localhost ูุงูุฅูุชุงุฌ
- ๐ง **ูุฑููุฉ ุนุงููุฉ**: ุณูููุฉ ุงูุชุฎุตูุต ูุงูุชูุณูุน

## ๐ก ููุงุญุธุงุช ูุงูุฉ

### ูุทุงูุงุช ูุฏุนููุฉ:
- `ktobi.online`
- `stockiha.com` 
- `bazaar.com`
- `bazaar.dev`
- `localhost` (ููุชุทููุฑ)

### ูุชุทูุจุงุช:
- Supabase Auth ููุนู
- React Router
- localStorage ูุชุงุญ
- ุฏุนู modern browsers

---

**๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ**: ุงููุณุชุฎุฏู ูุณุฌู ุงูุฏุฎูู ูุฑุฉ ูุงุญุฏุฉ ููุท ููุตู ูุจุงุดุฑุฉ ุฅูู ุงููุทุงู ุงููุฑุนู ุฏูู ุฃู ุทูุจุงุช ุฅุถุงููุฉ ูุชุณุฌูู ุงูุฏุฎูู! 