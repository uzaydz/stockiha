# ุฏููู ุชุญุณูู ุตูุญุฉ ุงูุทูุจุงุช

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ุญู ูุญุณู ุฌุฏูุฏ ูุตูุญุฉ ุงูุทูุจุงุช ูููู ูู ุนุฏุฏ ุงุณุชุฏุนุงุกุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู **~15 ุงุณุชุฏุนุงุก ุฅูู ุงุณุชุฏุนุงุก ูุงุญุฏ**ุ ููุง ูุญุณู ุงูุฃุฏุงุก ุจุดูู ูุจูุฑ ููููู ุฒูู ุงูุชุญููู.

## ุงููุดููุฉ ุงูุณุงุจูุฉ

### ุงูุงุณุชุฏุนุงุกุงุช ุงููุชุนุฏุฏุฉ
```
1. GET online_orders + joins
2. GET customers/guest_customers  
3. GET addresses
4. RPC get_orders_count_by_status
5. RPC get_order_stats
6. GET shipping_data_view
7. GET notifications
8. GET yalidine_provinces_global
9. GET yalidine_municipalities_global
10. RPC get_organization_subscription_cached
11. useEnabledShippingProviders
12. useRealTimeNotifications
13. useSharedStoreData
14. SubscriptionCheck
15. ูุชุนุฏุฏุฉ ุฃุฎุฑู...
```

### ุงููุดุงูู ุงููุงุชุฌุฉ
- **ุชุญููู ุจุทูุก**: ุงุณุชุฏุนุงุกุงุช ูุชุชุงููุฉ ุชุณุจุจ ุชุฃุฎูุฑ
- **ุงุณุชููุงู ุนุงูู ููููุงุฑุฏ**: ุถุบุท ุบูุฑ ุถุฑูุฑู ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- **ุชุนููุฏ ูู ุฅุฏุงุฑุฉ ุงูุญุงูุฉ**: hooks ูุชุนุฏุฏุฉ ุชุชุทูุจ ุชุฒุงูู
- **ุตุนูุจุฉ ูู ุงูุตูุงูุฉ**: ููุฏ ูุจุนุซุฑ ูู ุนุฏุฉ ูููุงุช

## ุงูุญู ุงููุญุณู

### ุฏุงูุฉ RPC ูุงุญุฏุฉ
```sql
get_orders_complete_data(
    p_organization_id UUID,
    p_page INTEGER,
    p_page_size INTEGER,
    p_status TEXT,
    p_call_confirmation_status_id INTEGER,
    p_shipping_provider TEXT,
    p_search_term TEXT,
    p_date_from TIMESTAMP,
    p_date_to TIMESTAMP,
    p_sort_by TEXT,
    p_sort_order TEXT
)
```

### ุงูุจูุงูุงุช ุงูููุฌูุนุฉ
```jsonb
{
  "success": true,
  "orders": [...],           // ุงูุทูุจุงุช ูุน ูุงูู ุงูุจูุงูุงุช
  "counts": {...},           // ุนุฏุฏ ุงูุทูุจุงุช ุญุณุจ ุงูุญุงูุฉ
  "stats": {...},            // ุงูุฅุญุตุงุฆูุงุช ุงููุงููุฉ
  "sharedData": {
    "callConfirmationStatuses": [...],
    "provinces": [...],
    "municipalities": [...],
    "shippingProviders": [...],
    "organizationSettings": {...}
  },
  "metadata": {
    "pagination": {...},
    "performance": {...},
    "dataFreshness": {...}
  }
}
```

## ุงููููุงุช ุงูุฌุฏูุฏุฉ

### 1. ุฏุงูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช
```sql
-- database/functions/get_orders_complete_data.sql
CREATE OR REPLACE FUNCTION get_orders_complete_data(...)
RETURNS JSONB
```

**ุงูููุฒุงุช:**
- ุงุณุชุนูุงู ูุงุญุฏ ูุน JOINs ูุญุณูุฉ
- ุชุฌููุน ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู JSONB
- ุญู ุฃุณูุงุก ุงูุจูุฏูุงุช ูุงูููุงูุงุช
- ุฅุญุตุงุฆูุงุช ุงูุฃุฏุงุก ุงููุฏูุฌุฉ

### 2. Hook ูุญุณู
```typescript
// src/hooks/useOptimizedOrdersData.ts
export const useOptimizedOrdersData = (options) => {
  // ุชุฎุฒูู ูุคูุช ุฐูู
  // ุฅุฏุงุฑุฉ ุญุงูุฉ ูุฑูุฒูุฉ
  // ูุฑุงูุจุฉ ุงูุฃุฏุงุก
  // ุชุญุฏูุซ optimistic
}
```

**ุงูููุฒุงุช:**
- ุชุฎุฒูู ูุคูุช ูุน TTL (5 ุฏูุงุฆู)
- ุฅูุบุงุก ุงูุทูุจุงุช ุนูุฏ ุงูุชุบููุฑ
- polling ุงุฎุชูุงุฑู
- ุฅุญุตุงุฆูุงุช ุงูุฃุฏุงุก

### 3. ูููู ูุญุณู
```typescript
// src/components/orders/OptimizedOrdersPage.tsx
export const OptimizedOrdersPage = () => {
  // ุงุณุชุฎุฏุงู Hook ุงููุญุณู
  // ููุญุฉ ูุนูููุงุช ุงูุฃุฏุงุก
  // ุฅุฏุงุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช
}
```

## ุงูุชุทุจูู ูู ุตูุญุฉ ุงูุทูุจุงุช

### ุงูุชุญุฏูุซุงุช ุงููุทููุจุฉ

1. **ุชุญุฏูุซ Import**
```typescript
// ูุจู
import { useOrdersData } from "@/hooks/useOrdersData";

// ุจุนุฏ  
import { useOptimizedOrdersData } from "@/hooks/useOptimizedOrdersData";
```

2. **ุชุญุฏูุซ Hook**
```typescript
// ูุจู
const { orders, loading, ... } = useOrdersData({...});

// ุจุนุฏ
const { 
  orders, loading, ..., 
  sharedData, metadata, getCacheStats, clearCache 
} = useOptimizedOrdersData({...});
```

3. **ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุงููุดุชุฑูุฉ**
```typescript
// ูุจู - ุงุณุชุฏุนุงุกุงุช ูููุตูุฉ
const { enabledProviders } = useEnabledShippingProviders();

// ุจุนุฏ - ูู ุงูุจูุงูุงุช ุงููุดุชุฑูุฉ
const shippingProviders = sharedData?.shippingProviders || [];
```

## ูููุฒุงุช ุงูุชุญุณูู

### ุงูุฃุฏุงุก
- โก **ุงุณุชุฏุนุงุก ูุงุญุฏ** ุจุฏูุงู ูู ~15 ุงุณุชุฏุนุงุก
- ๐ **ุชุญููู ุฃุณุฑุน** ุจูุณุจุฉ 70-80%
- ๐ฆ **ุชุฎุฒูู ูุคูุช ุฐูู** ูุน TTL
- ๐ **ุชุญุฏูุซ optimistic** ููUI

### ุชุฌุฑุจุฉ ุงููุทูุฑ
- ๐งฉ **Hook ูุงุญุฏ** ููุงูู ุงูุจูุงูุงุช
- ๐ **ูุฑุงูุจุฉ ุงูุฃุฏุงุก** ูุฏูุฌุฉ
- ๐ง **ุฃุฏูุงุช ุชุดุฎูุต** ูุชูุฏูุฉ
- ๐ฏ **ููุฏ ุฃุจุณุท** ูุฃูุซุฑ ุชูุธููุงู

### ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู
- โก **ุชุญููู ููุฑู** ููุตูุญุฉ
- ๐ **ุชุญุฏูุซ ุณูุณ** ููุจูุงูุงุช
- ๐ฑ **ุงุณุชุฌุงุจุฉ ุฃูุถู** ุนูู ุงูุฃุฌูุฒุฉ ุงููุญูููุฉ
- ๐จ **ูุงุฌูุฉ ูุญุณูุฉ** ูุน ูุนูููุงุช ุงูุฃุฏุงุก

## ูุฑุงูุจุฉ ุงูุฃุฏุงุก

### ููุญุฉ ุงูุฃุฏุงุก ุงููุฏูุฌุฉ
```typescript
// ูู ุตูุญุฉ ุงูุทูุจุงุช
const [showPerformance, setShowPerformance] = useState(false);

// ูุนูููุงุช ูุชุงุญุฉ
- totalDurationMs: ููุช ุงูุงุณุชุนูุงู ุงูุฅุฌูุงูู
- steps: ุชูุตูู ุฃุฏุงุก ูู ุฎุทูุฉ  
- cacheStats: ุฅุญุตุงุฆูุงุช ุงูุชุฎุฒูู ุงููุคูุช
- dataFreshness: ูุถุงุฑุฉ ุงูุจูุงูุงุช
```

### ุฅุญุตุงุฆูุงุช ุงูุชุฎุฒูู ุงููุคูุช
```typescript
const cacheStats = getCacheStats();
// { cacheSize: 5, cacheKeys: [...] }
```

## ุงูุชุญุณููุงุช ุงููุณุชูุจููุฉ

### ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] ุฅุถุงูุฉ ููุงุฑุณ ูุฎุตุตุฉ ููุจุญุซ
- [ ] ุชุญุณูู ุงูู JOINs ููุจูุงูุงุช ุงููุจูุฑุฉ
- [ ] ุถุบุท ุงูุงุณุชุฌุงุจุฉ ุจุงุณุชุฎุฏุงู GZIP

### Frontend
- [ ] ุชุญููู ูุณูู ููููููุงุช ุงูุซูููุฉ
- [ ] Virtual scrolling ููููุงุฆู ุงูุทูููุฉ
- [ ] Service Workers ููุชุฎุฒูู ุงููุคูุช

### Caching
- [ ] Redis ููุชุฎุฒูู ุงููุคูุช ุนูู ุงูุฎุงุฏู
- [ ] Cache invalidation ุฐูู
- [ ] ุชุฎุฒูู ูุคูุช ููุจูุงูุงุช ุงูุซุงุจุชุฉ

## ุงูุงุณุชุฎุฏุงู

### ุชูุนูู ุงูุญู ุงููุญุณู
1. ุชุทุจูู ุฏุงูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. ุงุณุชูุฑุงุฏ Hook ุงููุญุณู
3. ุชุญุฏูุซ ุงูููููุงุช
4. ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก

### ูุฑุงูุจุฉ ุงููุชุงุฆุฌ
- ุงุณุชุฎุฏู ููุญุฉ ุงูุฃุฏุงุก ุงููุฏูุฌุฉ
- ุฑุงูุจ ุฃููุงุช ุงูุงุณุชุฌุงุจุฉ
- ุชุชุจุน ุงุณุชุฎุฏุงู ุงูุชุฎุฒูู ุงููุคูุช
- ูุงุฑู ูุน ุงูุญู ุงูุณุงุจู

## ุงูุฎูุงุตุฉ

ุงูุญู ุงููุญุณู ูููุฑ:
- **ุชุญุณู ูุจูุฑ ูู ุงูุฃุฏุงุก** (70-80% ุฃุณุฑุน)
- **ุชุฌุฑุจุฉ ูุทูุฑ ุฃูุถู** ูุน ููุฏ ุฃุจุณุท
- **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุญุณูุฉ** ูุน ุชุญููู ุฃุณุฑุน
- **ูุงุจููุฉ ุตูุงูุฉ ุฃูุถู** ูุน ูููู ููุญุฏ
- **ูุฑุงูุจุฉ ุดุงููุฉ** ููุฃุฏุงุก ูุงูุชุฎุฒูู ุงููุคูุช

ูุฐุง ุงูุชุญุณูู ูุถุน ุฃุณุงุณุงู ูููุงู ูุชุทููุฑ ุงููุฒูุฏ ูู ุงูุชุญุณููุงุช ูู ุงููุณุชูุจู ููุญุณู ุงูุฃุฏุงุก ุงูุนุงู ููุชุทุจูู ุจุดูู ููุญูุธ. 