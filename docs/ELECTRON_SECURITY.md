# ุญูุงูุฉ Electron - ููุน ุงููุตูู ูุตูุญุงุช ุงูุณูุจุฑ ุฃุฏููู

## ูุธุฑุฉ ุนุงูุฉ
ุชู ุชุทุจูู **3 ุทุจูุงุช ุญูุงูุฉ** ูููุน ุงููุตูู ุฅูู ุตูุญุงุช ุงูุณูุจุฑ ุฃุฏููู ูู ุชุทุจูู Electron ุณุทุญ ุงูููุชุจ.

## ููุงุฐุง ูุฐู ุงูุญูุงูุฉุ

### ุงูุฃุณุจุงุจ ุงูุฃูููุฉ:
1. **๐ ุนุฒู ุงูุตูุงุญูุงุช:** ุชุทุจูู ุณุทุญ ุงูููุชุจ ูุฎุตุต ููููุธููู ุงูุนุงุฏููู ููุท
2. **๐ ููุน ุณุฑูุฉ ุงููููุงุช:** ูู ุญุงูุฉ ุงุฎุชุฑุงู ุฌูุงุฒ ููุธูุ ูู ูุชููู ุงููุฎุชุฑู ูู ุงููุตูู ููููุงุช ุงูุณูุจุฑ ุฃุฏููู
3. **๐ ุชูููู ุณุทุญ ุงููุฌูู:** ุฅุฒุงูุฉ ุตูุญุงุช ุงูุณูุจุฑ ุฃุฏููู ูู ุงูุชุทุจูู ุงููุญูู ูููู ูู ุงุญุชูุงููุฉ ุงูุงุฎุชุฑุงู
4. **๐ ูุตู ุงูุจูุฆุงุช:** ุงูุณูุจุฑ ุฃุฏููู ูุฌุจ ุฃู ูููู ุนุจุฑ ุงูููุจ ููุท ูุน ูุตุงุฏูุฉ ูููุฉ

### ุงูุณููุงุฑูููุงุช ุงููุญุชููุฉ:
- ููุธู ูุญุงูู ุงููุตูู ูุตูุญุฉ ุงูุณูุจุฑ ุฃุฏููู ุนู ุทุฑูู ุงูุฎุทุฃ
- ุดุฎุต ุบูุฑ ูุตุฑุญ ูู ูุณุชุฎุฏู ุฌูุงุฒ ุงูููุธู
- ูุญุงููุฉ ุงุณุชุฎุฏุงู Developer Tools ูููุตูู ููุตูุญุงุช ุงููุญุธูุฑุฉ
- ูุญุงููุฉ ุชุนุฏูู ุงูู URL ุฃู Hash routing

---

## ุงูุทุจูุงุช ุงูุซูุงุซุฉ ููุญูุงูุฉ

### ุงูุทุจูุฉ 1: Electron Main Process
**ุงูููู:** `electron/main.cjs`

**ููู ุชุนูู:**
```javascript
// ูุงุฆูุฉ ุงููุณุงุฑุงุช ุงููุญุธูุฑุฉ
const BLOCKED_PATHS = [
  '/super-admin',
  '/super-admin/login',
  '/super-admin/dashboard',
  // ... ุงููุฒูุฏ
];

// ููุน ุงูุชููู ูุจู ุญุฏูุซู
mainWindow.webContents.on('will-navigate', (event, navigationUrl) => {
  if (isBlocked(url)) {
    event.preventDefault();  // ุฅููุงู ุงูุชููู
    showWarningDialog();     // ุฅุธูุงุฑ ุชุญุฐูุฑ
    redirectToHome();        // ุฅุนุงุฏุฉ ุชูุฌูู
  }
});

// ุงูุชุญูู ุจุนุฏ ุงูุชููู (double-check)
mainWindow.webContents.on('did-navigate', (event, url) => {
  if (isBlocked(url)) {
    redirectToHome();  // ุฅุนุงุฏุฉ ุชูุฌูู ููุฑูุฉ
  }
});

// ุญูู JavaScript ููุชุญูู ุงูุฅุถุงูู
mainWindow.webContents.on('did-finish-load', () => {
  // ุงูุชุญูู ูู ุงููุณุงุฑ ุงูุญุงูู ูู ุงูุตูุญุฉ
  executeJavaScript(`
    if (currentPath.includes('/super-admin')) {
      window.location.href = '/';
    }
  `);
});
```

**ุงููููุฒุงุช:**
- โ ููุน ุนูู ูุณุชูู ูุงูุฐุฉ Electron ููุณูุง
- โ ูุง ูููู ุชุฌุงูุฒูุง ูู JavaScript
- โ ุฑุณุงูุฉ ุชุญุฐูุฑ native dialog
- โ ุญูุงูุฉ ุญุชู ูุน DevTools ููุชูุญุฉ

---

### ุงูุทุจูุฉ 2: React Router Guard
**ุงูููู:** `src/components/auth/SuperAdminRoute.tsx`

**ููู ุชุนูู:**
```typescript
import { shouldBlockRouteInElectron } from '@/lib/utils/electronSecurity';

useEffect(() => {
  if (shouldBlockRouteInElectron(location.pathname)) {
    console.warn('[Electron Security] ูุญุงููุฉ ูุตูู ูุญุธูุฑุฉ');

    toast({
      variant: 'destructive',
      title: 'ูุตูู ูุญุธูุฑ',
      description: 'ููุญุฉ ุงูุณูุจุฑ ุฃุฏููู ูุชุงุญุฉ ููุท ุนุจุฑ ุงููุชุตูุญ ุงูููุจ'
    });

    navigate('/', { replace: true });
  }
}, [location.pathname]);
```

**ุงููููุฒุงุช:**
- โ ุญูุงูุฉ ุนูู ูุณุชูู React Router
- โ ูุนูู ุญุชู ูู ุชุฌุงูุฒ ุงููุณุชุฎุฏู ุงูุทุจูุฉ ุงูุฃููู
- โ ุฑุณุงูุฉ toast ูุงุถุญุฉ ูููุณุชุฎุฏู
- โ ุฅุนุงุฏุฉ ุชูุฌูู ุชููุงุฆูุฉ

---

### ุงูุทุจูุฉ 3: Component Level Protection
**ุงูููู:** `src/pages/SuperAdminLogin.tsx`

**ููู ุชุนูู:**
```typescript
import { isElectron } from '@/lib/utils/electronSecurity';

useEffect(() => {
  if (isElectron()) {
    toast({
      variant: 'destructive',
      title: 'ูุตูู ูุญุธูุฑ',
      description: 'ุชุณุฌูู ุงูุฏุฎูู ูุณูุจุฑ ุฃุฏููู ุบูุฑ ูุชุงุญ ูู ุชุทุจูู ุณุทุญ ุงูููุชุจ'
    });

    navigate('/', { replace: true });
  }
}, []);
```

**ุงููููุฒุงุช:**
- โ ุญูุงูุฉ ุนูู ูุณุชูู ุงููููู ููุณู
- โ ุญุชู ูู ุชู ุงููุตูู ููููููุ ูู ูุนูู
- โ ุขุฎุฑ ุฎุท ุฏูุงุน

---

## Utility Functions

### `electronSecurity.ts`
```typescript
/**
 * Check if running in Electron
 */
export function isElectron(): boolean {
  return window.navigator.userAgent.toLowerCase().includes('electron');
}

/**
 * Check if path is Super Admin route
 */
export function isSuperAdminRoute(path: string): boolean {
  const SUPER_ADMIN_ROUTES = [
    '/super-admin',
    '/super-admin/login',
    // ... ุงููุฒูุฏ
  ];
  return SUPER_ADMIN_ROUTES.some(route =>
    path === route || path.startsWith(route + '/')
  );
}

/**
 * Should block route in Electron
 */
export function shouldBlockRouteInElectron(path: string): boolean {
  return isElectron() && isSuperAdminRoute(path);
}
```

---

## ุงูุตูุญุงุช ุงููุญุธูุฑุฉ

ุฌููุน ุงูุตูุญุงุช ุงูุชุงููุฉ ูุญุธูุฑุฉ ูู ุชุทุจูู Electron:

1. `/super-admin` - ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ููุณูุจุฑ ุฃุฏููู
2. `/super-admin/login` - ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
3. `/super-admin/dashboard` - ููุญุฉ ุงูุชุญูู
4. `/super-admin/organizations` - ุฅุฏุงุฑุฉ ุงููุคุณุณุงุช
5. `/super-admin/subscriptions` - ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงูุงุช
6. `/super-admin/payment-methods` - ุทุฑู ุงูุฏูุน
7. `/super-admin/activation-codes` - ุฃููุงุฏ ุงูุชูุนูู
8. `/super-admin/yalidine-sync` - ูุฒุงููุฉ Yalidine

---

## ูุง ูุญุฏุซ ุนูุฏ ูุญุงููุฉ ุงููุตููุ

### ุณููุงุฑูู 1: ูุญุงููุฉ ุงูุชููู ูู ุฏุงุฎู ุงูุชุทุจูู
```
1. ุงููุณุชุฎุฏู ูุถุบุท ุนูู ุฑุงุจุท ุฃู ูุญุงูู ุงูุชููู
   โ
2. ุงูุทุจูุฉ 1 (Electron) ุชููุน ุงูุชููู ููุฑุงู
   โ
3. ุฑุณุงูุฉ Dialog ุชุธูุฑ: "ุบูุฑ ูุณููุญ ุจุงููุตูู"
   โ
4. ุฅุนุงุฏุฉ ุชูุฌูู ุชููุงุฆูุฉ ููุตูุญุฉ ุงูุฑุฆูุณูุฉ
```

### ุณููุงุฑูู 2: ูุญุงููุฉ ูุชุงุจุฉ URL ูุจุงุดุฑุฉ
```
1. ุงููุณุชุฎุฏู ูุญุงูู ุชุนุฏูู URL ูู DevTools
   โ
2. ุงูุทุจูุฉ 1 ุชููุน ุงูุชููู
   โ
3. JavaScript ุงููุญููู ูุชุญูู ูู ุงููุณุงุฑ
   โ
4. ุฅุนุงุฏุฉ ุชูุฌูู ููุฑูุฉ
```

### ุณููุงุฑูู 3: ูุญุงููุฉ ุชุญููู ุงูุตูุญุฉ ูู ุงูููุฏ
```
1. ููุฏ JavaScript ูุญุงูู ุชุญููู ุตูุญุฉ ุณูุจุฑ ุฃุฏููู
   โ
2. ุงูุทุจูุฉ 2 (Router Guard) ุชูุชุดู ุงููุญุงููุฉ
   โ
3. Toast notification ุชุธูุฑ
   โ
4. Navigate ุฅูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
```

### ุณููุงุฑูู 4: ูุตูู ูุจุงุดุฑ ูููููู
```
1. ูุญุงููุฉ ุนุฑุถ ูููู ุงูุณูุจุฑ ุฃุฏููู ูุจุงุดุฑุฉ
   โ
2. ุงูุทุจูุฉ 3 (Component Level) ุชูุชุดู Electron
   โ
3. useEffect ูููุน ุงูุนุฑุถ
   โ
4. ุฅุนุงุฏุฉ ุชูุฌูู ููุฑูุฉ
```

---

## ุงูุงุฎุชุจุงุฑ

### ููููุฉ ุงุฎุชุจุงุฑ ุงูุญูุงูุฉ:

#### 1. ุงุฎุชุจุงุฑ ุงูุชููู ุงูุนุงุฏู
```bash
# ุชุดุบูู ุชุทุจูู Electron
npm run electron:dev

# ุญุงูู:
1. ุงููุฑ ุนูู ุฃู ุฑุงุจุท ูุคุฏู ููุณูุจุฑ ุฃุฏููู
   โ ูุฌุจ ุฃู ูุธูุฑ Dialog ููููุน ุงูุชููู

2. ุงุณุชุฎุฏู DevTools ูุญุงูู:
   window.location.href = '/super-admin'
   โ ูุฌุจ ุฃู ูุชู ููุนู ูุฅุนุงุฏุฉ ุงูุชูุฌูู
```

#### 2. ุงุฎุชุจุงุฑ Hash Routing
```bash
# ุญุงูู:
window.location.hash = '#/super-admin'
โ ูุฌุจ ุฃู ูุชู ููุนู
```

#### 3. ุงุฎุชุจุงุฑ ุงููุตูู ุงููุจุงุดุฑ
```bash
# ุญุงูู ูุชุญ URL ูุจุงุดุฑุฉ ูู outside
file:///path/to/app/dist/index.html#/super-admin
โ ูุฌุจ ุฃู ูุชู ุฅุนุงุฏุฉ ุงูุชูุฌูู ููุตูุญุฉ ุงูุฑุฆูุณูุฉ
```

#### 4. ุงูุชุญูู ูู Logging
```bash
# ุงูุชุญ Console ูู DevTools
# ูุฌุจ ุฃู ุชุฑู:
[Electron Security] ูุญุงููุฉ ุงููุตูู ุฅูู ุตูุญุฉ ูุญุธูุฑุฉ: /super-admin
[Electron Security] ุชู ุงูุชุดุงู ูุญุงููุฉ ุชุญููู ุตูุญุฉ ูุญุธูุฑุฉ
```

---

## ุงูุฃุฏุงุก

**ุชุฃุซูุฑ ุนูู ุงูุฃุฏุงุก:** **ุตูุฑ ุชูุฑูุจุงู**
- โ ุงูุชุญูู ูุญุฏุซ ููุท ุนูุฏ ุงูุชููู (ููุณ ูู ูู render)
- โ Function calls ุฎูููุฉ ุฌุฏุงู (string matching ููุท)
- โ ูุง ูุคุซุฑ ุนูู ููุช ุงูุชุญููู ุงูุฃููู

**ุญุฌู ุงูููุฏ ุงููุถุงู:**
- `electronSecurity.ts`: ~2KB
- ุชุนุฏููุงุช ุนูู ุงููููุงุช ุงูููุฌูุฏุฉ: ~3KB
- ุฅุฌูุงูู: **~5KB** (negligible)

---

## ุงูุฃูุงู

### ููุงุท ุงูููุฉ:
โ **3 ุทุจูุงุช ุฏูุงุน** - ุญุชู ูู ุชู ุชุฌุงูุฒ ุทุจูุฉุ ุงูุทุจูุงุช ุงูุฃุฎุฑู ุชุญูู
โ **ูุง ูููู ุชุนุทูููุง** - ูุญููุฉ ุนูู ูุณุชูู Electron ููุณู
โ **Logging ุดุงูู** - ุฌููุน ุงููุญุงููุงุช ูุณุฌูุฉ
โ **ุฑุณุงุฆู ูุงุถุญุฉ** - ุงููุณุชุฎุฏู ูููู ููุงุฐุง ุชู ุงูููุน

### ูุง ูุง ุชุญููู:
โ **ูุง ุชููุน ุงููุตูู ุนุจุฑ ุงูููุจ** - ููุท ูู Electron
โ **ูุง ุชููุน ุงููุตูู ููู API** - ุงูุญูุงูุฉ ุนูู ูุณุชูู ุงููุงุฌูุฉ ููุท
โ **ูุง ุชุญูู ูู modifications ุนูู ุงูููุฏ** - ุฅุฐุง ุนุฏูู ุดุฎุต ุงูููุฏ ุงููุตุฏุฑู

---

## ุงูุตูุงูุฉ

### ุฅุถุงูุฉ ุตูุญุฉ ุฌุฏูุฏุฉ ููุณูุจุฑ ุฃุฏููู:
```typescript
// ูู electronSecurity.ts
const SUPER_ADMIN_ROUTES = [
  '/super-admin',
  '/super-admin/new-page',  // โ ุฃุถู ููุง
  // ...
];

// ูู electron/main.cjs
const BLOCKED_PATHS = [
  '/super-admin',
  '/super-admin/new-page',  // โ ุฃุถู ููุง
  // ...
];
```

### ุฅุฒุงูุฉ ุงูุญูุงูุฉ (ููุชุทููุฑ ููุท):
```typescript
// ูู electronSecurity.ts
export function isElectron(): boolean {
  if (process.env.NODE_ENV === 'development') {
    return false;  // ุชุนุทูู ุงูุญูุงูุฉ ูู ุงูุชุทููุฑ
  }
  return window.navigator.userAgent.toLowerCase().includes('electron');
}
```

โ๏ธ **ุชุญุฐูุฑ:** ูุง ุชุนุทู ุงูุญูุงูุฉ ูู ุงูุฅูุชุงุฌ ุฃุจุฏุงู!

---

## ุงูุฎูุงุตุฉ

### โ ูุง ุชู ุชุญูููู:
- 3 ุทุจูุงุช ุญูุงูุฉ ูููุฉ
- ููุน ุงููุตูู ูู ุฌููุน ุงูุทุฑู
- ุฑุณุงุฆู ูุงุถุญุฉ ูููุณุชุฎุฏู
- Logging ุดุงูู ูููุญุงููุงุช
- ุชุฃุซูุฑ ุตูุฑู ุนูู ุงูุฃุฏุงุก

### ๐ฏ ุงููุฏู:
**ุญูุงูุฉ ุตูุญุงุช ุงูุณูุจุฑ ุฃุฏููู ูู ุงููุตูู ุนุจุฑ ุชุทุจูู ุณุทุญ ุงูููุชุจ**

### โ ุงูุญุงูุฉ:
**ููุชูู ูุฌุงูุฒ ููุฅูุชุงุฌ**

---

## ุงููุฑุงุฌุน
- ุงูุชูุฑูุฑ ุงููุงูู: [SUPER_ADMIN_SECURITY_IMPROVEMENTS.md](./SUPER_ADMIN_SECURITY_IMPROVEMENTS.md)
- Electron Security Best Practices: https://www.electronjs.org/docs/latest/tutorial/security
