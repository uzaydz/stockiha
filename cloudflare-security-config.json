{
  "security": {
    "description": "إعدادات الأمان لـ Cloudflare Pages - Stockiha",
    "headers": {
      "strict_transport_security": {
        "enabled": true,
        "max_age": 31536000,
        "include_subdomains": true,
        "preload": true
      },
      "content_security_policy": {
        "enabled": true,
        "report_only": false,
        "directives": {
          "default-src": "'self'",
          "script-src": "'self' 'nonce-{nonce}' https://connect.facebook.net https://www.googletagmanager.com https://www.google-analytics.com https://js.sentry-cdn.com https://static.cloudflareinsights.com https://www.gstatic.com https://www.google.com",
          "style-src": "'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net",
          "img-src": "'self' data: https: blob:",
          "font-src": "'self' https://fonts.gstatic.com data:",
          "connect-src": "'self' https://*.supabase.co wss://*.supabase.co https://api.yalidine.app",
          "frame-src": "'self' https://www.facebook.com https://connect.facebook.net",
          "object-src": "'none'",
          "base-uri": "'self'",
          "form-action": "'self'",
          "frame-ancestors": "'self' https://www.instagram.com https://*.instagram.com https://www.facebook.com https://*.facebook.com",
          "upgrade-insecure-requests": true
        }
      },
      "x_frame_options": "SAMEORIGIN",
      "x_content_type_options": "nosniff",
      "x_xss_protection": "1; mode=block",
      "referrer_policy": "strict-origin-when-cross-origin",
      "permissions_policy": "camera=(), microphone=(), geolocation=(), payment=()"
    },
    "rate_limiting": {
      "api_endpoints": {
        "requests_per_minute": 100,
        "burst_limit": 20,
        "window_size": 60
      },
      "general": {
        "requests_per_minute": 300,
        "burst_limit": 50,
        "window_size": 60
      },
      "strict_endpoints": [
        "/api/yalidine-fees-proxy",
        "/api/facebook-conversion-api",
        "/api/conversion-events"
      ]
    },
    "waf_rules": {
      "block_common_attacks": true,
      "block_sql_injection": true,
      "block_xss": true,
      "block_bot_traffic": true,
      "challenge_suspicious_requests": true,
      "allowed_countries": ["DZ", "FR", "US", "CA", "GB"],
      "blocked_user_agents": [
        "curl",
        "wget",
        "python-requests",
        "scrapy"
      ]
    },
    "encryption": {
      "api_keys": {
        "algorithm": "AES-256-GCM",
        "key_rotation_days": 90
      },
      "sensitive_data": {
        "encrypt_in_transit": true,
        "encrypt_at_rest": true
      }
    }
  },
  "monitoring": {
    "log_level": "INFO",
    "security_events": {
      "failed_authentication": true,
      "rate_limit_exceeded": true,
      "suspicious_requests": true,
      "api_errors": true
    },
    "alerts": {
      "email_notifications": true,
      "webhook_url": "https://hooks.slack.com/your-webhook",
      "threshold_errors_per_minute": 10,
      "threshold_failed_auth_per_hour": 50
    },
    "metrics": {
      "request_count": true,
      "response_time": true,
      "error_rate": true,
      "cache_hit_ratio": true
    }
  },
  "performance": {
    "caching": {
      "static_assets": {
        "max_age": 31536000,
        "browser_cache": true,
        "edge_cache": true
      },
      "api_responses": {
        "max_age": 300,
        "vary_headers": ["Authorization", "Accept-Language"]
      }
    },
    "compression": {
      "gzip": true,
      "brotli": true,
      "minimum_size": 1024
    },
    "minification": {
      "html": true,
      "css": true,
      "javascript": true
    }
  },
  "domains": {
    "primary": "stockiha.com",
    "www_redirect": true,
    "subdomains": [
      "api.stockiha.com",
      "admin.stockiha.com"
    ],
    "ssl": {
      "mode": "full_strict",
      "min_tls_version": "1.2",
      "cipher_suites": ["ECDHE-RSA-AES128-GCM-SHA256", "ECDHE-RSA-AES256-GCM-SHA384"]
    }
  }
}
