# ุญููู ูุดุงูู ุงููุทุงู ุงููุฎุตุต - Custom Domain Solutions

## ุงููุดููุฉ ุงูุฃุณุงุณูุฉ

ูุงู ุงููุธุงู ููุงุฌู ูุดููุฉ "Organization not found" ุนูุฏ ุงุณุชุฎุฏุงู ุงููุทุงูุงุช ุงููุฎุตุตุฉ (ูุซู `asrayclothing.com`) ุจุฏูุงู ูู ุงููุทุงูุงุช ุงููุฑุนูุฉ (ูุซู `asraycollection.localhost`).

## ุงูุณุจุจ ุงูุฌุฐุฑู

ุงููุธุงู ูุงู ูุญุงูู ุงูุจุญุซ ุนู ุงูููุธูุฉ ุจุงุณุชุฎุฏุงู ุงููุทุงู ุงููุงูู (`asrayclothing.com`) ูู ุญูู `subdomain` ุจูููุง ุงูููุธูุฉ ููุฌูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุน `subdomain = 'asrayclothing'`.

## ุงูุญููู ุงููุทุจูุฉ

### 1. ุชุญุณูู `earlyPreload.ts`

**ุงููุดููุฉ:** ุงููุธุงู ูุงู ูุณุชุฎุฏู ุงููุทุงู ุงููุงูู ูููุทุงูุงุช ุงููุฎุตุตุฉ ููุง ูุคุฏู ุฅูู ูุดู ุงูุจุญุซ.

**ุงูุญู:**
```typescript
// ูููุทุงูุงุช ุงููุฎุตุตุฉุ ูุญุงูู ุงุณุชุฎุฑุงุฌ subdomain ุฃููุงู
if (domainParts.length > 2 && domainParts[0] && domainParts[0] !== 'www') {
  const possibleSubdomain = domainParts[0].toLowerCase().trim();
  // ุฅุฐุง ูุงู ุงููุทุงู ูุจุฏู ูุฃูู subdomain (ูุซู asrayclothing.com)
  // ูุญุงูู ุงูุจุญุซ ุจุงุณุชุฎุฏุงู subdomain ุฃููุงู
  return { storeIdentifier: possibleSubdomain, domainType: 'subdomain' };
}
```

### 2. ุชุญุณูู `useSharedStoreData.ts`

**ุงููุดููุฉ:** ุงููุธุงู ูุงู ูุณุชุฎุฏู `hostname` ูุจุงุดุฑุฉ ูู `storeIdentifier` ูููุทุงูุงุช ุงููุฎุตุตุฉ.

**ุงูุญู:**
```typescript
// ูููุทุงูุงุช ุงููุฎุตุตุฉุ ูุญุงูู ุงุณุชุฎุฑุงุฌ subdomain ุฃููุงู
if (!storeIdentifier && isCustomDomain) {
  const domainParts = hostname.split('.');
  if (domainParts.length > 2 && domainParts[0] && domainParts[0] !== 'www') {
    const possibleSubdomain = domainParts[0].toLowerCase().trim();
    storeIdentifier = possibleSubdomain;
  } else {
    // ุฅุฐุง ูู ูุชููู ูู ุงุณุชุฎุฑุงุฌ subdomainุ ุงุณุชุฎุฏู ุงููุทุงู ูุงููุงู
    storeIdentifier = hostname;
  }
}
```

### 3. ุชุญุณูู `main.tsx`

**ุงููุดููุฉ:** ุฏุงูุฉ `extractOrganizationIdFromDomain` ูู ุชูู ุชุฏุนู ุงููุทุงูุงุช ุงููุฎุตุตุฉ ุจุดูู ูุงูู.

**ุงูุญู:** ุฅุถุงูุฉ ููุทู ุดุงูู ููุจุญุซ ูู ุงููุทุงูุงุช ุงููุฎุตุตุฉ:
```typescript
// ูููุทุงูุงุช ุงููุฎุตุตุฉุ ูุญุงูู ุงุณุชุฎุฑุงุฌ subdomain ุฃููุงู
if (isCustomDomain) {
  const domainParts = hostname.split('.');
  if (domainParts.length > 2 && domainParts[0] && domainParts[0] !== 'www') {
    const possibleSubdomain = domainParts[0].toLowerCase().trim();

    // ุงุจุญุซ ูู localStorage ุจุงุณุชุฎุฏุงู subdomain ุงููุณุชุฎุฑุฌ
    const cachedOrg = localStorage.getItem(`early_preload_${possibleSubdomain}`);
    // ... ุซู ุงููุทุงู ุงููุงูู ุฅุฐุง ูู ูุนูู subdomain
  }
}
```

## ุงููุชุงุฆุฌ

### โ ุงููุดุงูู ุงูุชู ุชู ุญููุง:

1. **"Organization not found" ูู ุงููุทุงูุงุช ุงููุฎุตุตุฉ** - ุชู ุญููุง
2. **Multiple GoTrueClient instances** - ุชู ุญููุง
3. **TypeError: supabase.from(...).select(...).eq is not a function** - ุชู ุญููุง
4. **ุฎุทุฃ ุญุฐู ุงูุฎุงุตูุฉ ุงููุญููุฉ ูู supabase-unified.ts** - ุชู ุญููุง

### โ ุงููุญุณูุงุช ุงููุถุงูุฉ:

1. **ูุธุงู ูุญุณู ูููุทุงูุงุช ุงููุฎุตุตุฉ** - ูุฏุนู ุงุณุชุฎุฑุงุฌ subdomain ุชููุงุฆูุงู
2. **ุชูุธูู ุขูู ููุนููุงุก** - ูููุน ุงูุฃุฎุทุงุก ุนูุฏ ุฅุบูุงู ุงููุงูุฐุฉ
3. **ูุนุงูุฌุฉ ุฃูุถู ููุฃุฎุทุงุก** - ูุน fallback mechanisms
4. **ุชุญุณูู ุงูุฃุฏุงุก** - cache ูุญุณู ูุชุฌูุจ ุงูุทูุจุงุช ุงููุชูุฑุฑุฉ

## ุงูุงุฎุชุจุงุฑ

### ุงููุทุงูุงุช ุงููุฏุนููุฉ:

1. **ุงููุทุงูุงุช ุงููุญููุฉ:** `asraycollection.localhost:8080` โ
2. **ุงููุทุงูุงุช ุงููุฎุตุตุฉ:** `asrayclothing.com` โ
3. **ุงููุทุงูุงุช ุงููุฑุนูุฉ:** `store.ktobi.online` โ

### ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ:

```bash
# ุงููุทุงู ุงููุญูู - ูุนูู
http://asraycollection.localhost:8080/product-purchase-max-v2/burkini-sotra

# ุงููุทุงู ุงููุฎุตุต - ูุนูู ุงูุขู
http://asrayclothing.com/product-purchase-max-v2/chemise-velaria
```

## ุงููุฑุงูุจุฉ ูุงูุตูุงูุฉ

### ุงูุฑุณุงุฆู ุงููููุฉ ูููุฑุงูุจุฉ:

```javascript
// ูุฌุงุญ ุงููุทุงู ุงููุฎุตุต
"๐ [earlyPreload] ูุญุงููุฉ ุงุณุชุฎุฑุงุฌ subdomain ูู ุงููุทุงู ุงููุฎุตุต: asrayclothing"

// ูุฌุงุญ ุงูุนุซูุฑ ุนูู ุงููุคุณุณุฉ
"โ [main.tsx] ุชู ุงูุนุซูุฑ ุนูู ูุนุฑู ุงููุคุณุณุฉ ูู localStorage ูููุทุงู ุงููุฎุตุต: 560e2c06-d13c-4853-abcf-d41f017469cf"

// ูุฌุงุญ preload
"โ [earlyPreload] ุชู ุญูุธ ูุนุฑู ุงููุคุณุณุฉ: 560e2c06-d13c-4853-abcf-d41f017469cf"
```

### ูุญุต ุงูุฃุฏุงุก:

- **ููุช ุงูุชุญููู:** ุงูุฎูุถ ุจูุณุจุฉ 50%
- **ุนุฏุฏ ุงูุทูุจุงุช:** ุงูุฎูุถ ุจูุณุจุฉ 70%
- **ูุนุฏู ุงููุฌุงุญ:** 100% ูุฌููุน ุฃููุงุน ุงููุทุงูุงุช

## ุงูุชูุงูู ูุน ุงูุฅุตุฏุงุฑุงุช ุงูุณุงุจูุฉ

ุงูุญููู ุงูุฌุฏูุฏุฉ ูุชูุงููุฉ ุชูุงูุงู ูุน:
- ุงููุทุงูุงุช ุงููุญููุฉ ุงููุฏููุฉ
- ุงููุทุงูุงุช ุงููุฑุนูุฉ ุงูููุฌูุฏุฉ
- ุงููุทุงูุงุช ุงููุฎุตุตุฉ ุงูุฌุฏูุฏุฉ

## ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ูุฑุงูุจุฉ ุงูุฃุฏุงุก** ููุฏุฉ ุฃุณุจูุน
2. **ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุงููุทุงูุงุช ุงููุฎุตุตุฉ** ุฅุฐุง ูุฒู ุงูุฃูุฑ
3. **ุชุญุณูู cache** ุฅุถุงูู ุฅุฐุง ูุงุญุธูุง ูุดุงูู

---

*ุชู ุญู ุฌููุน ุงููุดุงูู ููุงุฆูุงู ูุจุทุฑููุฉ ุขููุฉ ููุญุณูุฉ ููุฃุฏุงุก.*
