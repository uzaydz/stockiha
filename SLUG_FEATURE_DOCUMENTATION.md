# ميزة Slug في صفحة إنشاء المنتجات

## نظرة عامة

تم إضافة ميزة **Slug** إلى نموذج إنشاء وتعديل المنتجات، والتي تسمح بإنشاء روابط URL ودية ومحسّنة لمحركات البحث للمنتجات.

## المميزات المضافة

### 1. حقل Slug في الواجهة الأمامية

- ✅ حقل إدخال جديد لـ slug في صفحة إنشاء المنتج
- ✅ توليد تلقائي للـ slug من اسم المنتج
- ✅ إمكانية التحرير اليدوي للـ slug
- ✅ زر "تلقائي" لإعادة توليد slug من اسم المنتج
- ✅ معاينة الرابط النهائي أسفل حقل الإدخال
- ✅ توجيه نص اللاتينية (dir="ltr")

### 2. معالجة الأحرف العربية

- ✅ تحويل تلقائي للأحرف العربية إلى مكافئاتها اللاتينية
- ✅ إزالة الرموز الخاصة والمسافات الزائدة
- ✅ تنظيف وتهيئة النص ليكون صالحاً كـ URL

### 3. التحقق من صحة البيانات (Validation)

- ✅ slug مطلوب
- ✅ يجب أن يحتوي على أحرف إنجليزية صغيرة وأرقام وشرطات فقط
- ✅ منع الشرطات في البداية والنهاية
- ✅ منع الشرطات المتتالية

### 4. قاعدة البيانات

- ✅ حقل `slug` في جدول `products`
- ✅ قيد الفرادة (UNIQUE constraint) على حقل slug
- ✅ فهرس للبحث السريع
- ✅ Trigger لضمان فرادة slug تلقائياً

### 5. دوال مساعدة

- ✅ ملف `src/utils/slugUtils.ts` يحتوي على دوال متخصصة في معالجة slug
- ✅ تحويل الأحرف العربية
- ✅ تنظيف النصوص
- ✅ ضمان الفرادة
- ✅ التحقق من صحة slug

## الملفات المحدثة

### الواجهة الأمامية

1. **`src/components/product/BasicProductInfo.tsx`**
   - إضافة حقل slug مع التحكم التلقائي/اليدوي
   - توليد slug تلقائي من اسم المنتج
   - واجهة مستخدم محسنة مع tooltip توضيحي

2. **`src/types/product.ts`**
   - تحديث `productSchema` لجعل slug مطلوب مع validation

3. **`src/utils/slugUtils.ts`** (ملف جديد)
   - دوال متخصصة في معالجة slug
   - تحويل الأحرف العربية إلى لاتينية
   - تنظيف وتصحيح النصوص

### قاعدة البيانات

4. **`add_slug_unique_constraint.sql`** (ملف جديد)
   - إضافة قيد الفرادة على حقل slug
   - معالجة البيانات المكررة الموجودة
   - Trigger لضمان فرادة slug

## كيفية الاستخدام

### للمطورين

```typescript
import { generateSlugFromText, cleanSlug, isValidSlug } from '@/utils/slugUtils';

// توليد slug من نص عربي
const slug = generateSlugFromText('آيفون 15 برو ماكس');
// النتيجة: "aiphone-15-pro-max"

// تنظيف slug مدخل يدوياً
const cleanedSlug = cleanSlug('My-Product!!123');
// النتيجة: "my-product-123"

// التحقق من صحة slug
const isValid = isValidSlug('valid-product-slug');
// النتيجة: true
```

### للمستخدمين

1. **إنشاء منتج جديد:**
   - أدخل اسم المنتج
   - سيتم توليد slug تلقائياً
   - يمكن تعديل slug يدوياً حسب الحاجة
   - انقر "تلقائي" للعودة للتوليد التلقائي

2. **معاينة الرابط:**
   - يظهر الرابط الكامل أسفل حقل slug
   - مثال: `/product/aiphone-15-pro-max`

## الفوائد

### محركات البحث (SEO)
- روابط ودية ومفهومة
- تحسين ترتيب المنتجات في نتائج البحث
- أسماء ملفات أفضل للمشاركة

### تجربة المستخدم
- روابط قابلة للقراءة والفهم
- سهولة في المشاركة والحفظ
- تنظيم أفضل للمحتوى

### الإدارة
- فرادة مضمونة للروابط
- منع التضارب في URLs
- تتبع أفضل للمنتجات

## تشغيل التحديثات

### قاعدة البيانات
```bash
# تشغيل ملف SQL لتحديث قاعدة البيانات
psql -d your_database -f add_slug_unique_constraint.sql
```

### الكود
```bash
# لا حاجة لتثبيت packages إضافية
# التحديثات متوافقة مع الكود الحالي
npm run build
```

## الاختبار

### اختبار وظائف slug

```typescript
// اختبار التوليد التلقائي
console.log(generateSlugFromText('منتج تجريبي'));
// النتيجة المتوقعة: "mntj-tjryby"

// اختبار التنظيف
console.log(cleanSlug('Test@#$%Product'));
// النتيجة المتوقعة: "testproduct"

// اختبار الصحة
console.log(isValidSlug('valid-slug-123'));
// النتيجة المتوقعة: true

console.log(isValidSlug('-invalid-slug-'));
// النتيجة المتوقعة: false
```

### اختبار الواجهة

1. انتقل إلى صفحة إنشاء منتج جديد
2. أدخل اسم منتج باللغة العربية
3. تحقق من توليد slug تلقائياً
4. جرب التعديل اليدوي للـ slug
5. اختبر زر "تلقائي"
6. تحقق من ظهور معاينة الرابط

## الاعتبارات المستقبلية

### تحسينات محتملة
- [ ] إضافة معاينة مباشرة للصفحة
- [ ] دعم languages متعددة
- [ ] تاريخ تغييرات slug
- [ ] إعادة توجيه تلقائي للروابط القديمة

### صيانة
- مراقبة أداء الفهارس
- تنظيف slug المهجورة دورياً
- نسخ احتياطية منتظمة

## المساهمة

لإضافة تحسينات أو إصلاح مشاكل:

1. تحديث الدوال في `src/utils/slugUtils.ts`
2. اختبار الوظائف الجديدة
3. تحديث هذا الملف
4. إنشاء PR مع وصف التغييرات

---

**تاريخ الإضافة:** [التاريخ الحالي]  
**الإصدار:** 1.0  
**الحالة:** مكتمل ✅ 