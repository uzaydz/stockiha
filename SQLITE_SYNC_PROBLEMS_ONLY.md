# ๐ ุชูุฑูุฑ ุงููุดุงูู ุงูููุชุดูุฉ ูู ูุธุงู SQLite ูุงููุฒุงููุฉ

**ุชุงุฑูุฎ ุงูุชุญููู:** 2025-01-19
**ููุน ุงูุชูุฑูุฑ:** ูุงุฆูุฉ ุดุงููุฉ ุจุฌููุน ุงููุดุงูู ุจุฏูู ุญููู

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ุงูุนุงูุฉ

- **ุฅุฌูุงูู ุงููุดุงูู ุงูููุชุดูุฉ:** 54 ูุดููุฉ
- **ูุดุงูู ุญุฑุฌุฉ (๐ด):** 23 ูุดููุฉ
- **ูุดุงูู ุนุงููุฉ (๐):** 8 ูุดุงูู
- **ูุดุงูู ูุชูุณุทุฉ (๐ก):** 15 ูุดููุฉ
- **ูุดุงูู ููุฎูุถุฉ (๐ข):** 8 ูุดุงูู

---

## ๐๏ธ ุงููุณู ุงูุฃูู: ูุดุงูู ุจููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช SQLite

### ๐ด **ูุดููุฉ #1: ุนุฏู ุชุฒุงูู Schema ุจูู SQLite ู Supabase**
**ุงูุฎุทูุฑุฉ:** ุญุฑุฌุฉ
**ุงูููู:** `electron/sqliteManager.cjs`
**ุงูุฃุณุทุฑ:** 219-500

**ูุตู ุงููุดููุฉ:**
- ุชูุฌุฏ 119 migration file ูู ูุฌูุฏ `supabase/migrations/` ููู SQLite ูุญุชูู ุนูู schema ุฃูุฏู
- Schema ูู SQLite ูุง ูุนูุณ ุฌููุน ุงูุชุญุฏูุซุงุช ุงูุชู ุชูุช ูู Supabase
- ุฃุนูุฏุฉ ููุฌูุฏุฉ ูู Supabase ุบูุฑ ููุฌูุฏุฉ ูู SQLite:
  - ูู ุฌุฏูู `repair_orders`: ุงูุฃุนูุฏุฉ `repair_location_id`, `repair_tracking_code`, `custom_location` ุบูุฑ ููุฌูุฏุฉ
  - ูู ุฌุฏูู `pos_orders`: ุงูุฃุนูุฏุฉ `metadata`, `message`, `payload`, `pending_updates`, `extra_fields` ุบูุฑ ููุฌูุฏุฉ ุจุดูู ุตุญูุญ
  - ูู ุฌุฏูู `customer_debts`: ุงูุฃุนูุฏุฉ `subtotal`, `discount` ุงููุญุฏุซุฉ ุบูุฑ ููุฌูุฏุฉ
  - ูู ุฌุฏูู `products`: ุงูุฃุนูุฏุฉ `name_normalized`, `server_updated_at` ุบูุฑ ููุฌูุฏุฉ
- ุจุนุถ ุงูุฃุนูุฏุฉ ูู SQLite ููุง ุฃููุงุน ุจูุงูุงุช ูุฎุชููุฉ ุนู Supabase:
  - `created_at` ูู SQLite ูู TEXT ุจูููุง ูู Supabase ูู TIMESTAMP WITH TIME ZONE
  - `is_active` ูู SQLite ูู INTEGER ุจูููุง ูู Supabase ูู BOOLEAN
  - ุญููู JSON ูู Supabase ูุชู ุชุฎุฒูููุง ูู TEXT ูู SQLite
- ุนุฏู ูุฌูุฏ ุขููุฉ ุชููุงุฆูุฉ ูููุดู ุนู ุงุฎุชูุงูุงุช Schema
- ุนุฏู ูุฌูุฏ ุณุฌู ุจุงูู migrations ุงูุชู ุชู ุชุทุจูููุง ุนูู SQLite
- ุฏุงูุฉ `migrateSchema()` ูู ุงูุณุทุฑ 197 ูู sqliteManager.cjs ุชุญุชูู ููุท ุนูู migrations ููููุฉ ูููุณุช ุดุงููุฉ

**ุงูุชุฃุซูุฑ:**
- ูุดู ุงููุฒุงููุฉ ุจุณุจุจ ุฃุนูุฏุฉ ููููุฏุฉ
- ููุฏุงู ุจูุงูุงุช ุนูุฏ ุงููุญุงููุฉ ูุญูุธ ุญููู ุบูุฑ ููุฌูุฏุฉ
- ุฃุฎุทุงุก ูู ุงูุงุณุชุนูุงูุงุช ุงูุชู ุชุณุชุฎุฏู ุฃุนูุฏุฉ ุบูุฑ ููุฌูุฏุฉ
- ุชุถุงุฑุจ ูู ุงูุจูุงูุงุช ุจูู SQLite ู Supabase
- ุตุนูุจุฉ ูู ุชุชุจุน ุงููุฑููุงุช ูุฅุตูุงุญูุง

**ุงููููุงุช ุงููุชุฃุซุฑุฉ:**
- `electron/sqliteManager.cjs` (ุงูุณุทูุฑ 219-500)
- `src/database/localDb.ts` (ุงูุชุนุฑููุงุช)
- `src/api/syncService.ts` (ุนูููุงุช ุงููุฒุงููุฉ)
- ุฌููุน ูููุงุช `localXXXService.ts`

---

### ๐ **ูุดููุฉ #2: ููุฑุณุฉ ุบูุฑ ูุงููุฉ ูุบูุฑ ูุญุณููุฉ**
**ุงูุฎุทูุฑุฉ:** ุนุงููุฉ
**ุงูููู:** `electron/sqliteManager.cjs`
**ุงูุฃุณุทุฑ:** 1250-1450

**ูุตู ุงููุดููุฉ:**
- ููุงุฑุณ ููููุฏุฉ ุนูู ุฃุนูุฏุฉ ุงูุจุญุซ ุงููููุฉ:
  - `customer_name_lower` ูู ุฌุฏูู `pos_orders` ููุณ ูุฏูู ููุฑุณ
  - `invoice_number_lower` ูู ุฌุฏูู `invoices` ููุณ ูุฏูู ููุฑุณ
  - `customer_name_lower` ูู ุฌุฏูู `customers` ููุณ ูุฏูู ููุฑุณ
  - `phone_digits` ูู ุฌุฏูู `customers` ููุณ ูุฏูู ููุฑุณ
- ุนุฏู ูุฌูุฏ ููุงุฑุณ ูุฑูุจุฉ (composite indexes) ุนูู ุงูุฃุนูุฏุฉ ุงููุณุชุฎุฏูุฉ ูุนุงู:
  - `(organization_id, status, synced)` ูู `pos_orders` ุบูุฑ ูููุฑุณ
  - `(organization_id, is_active, stock_quantity)` ูู `products` ุบูุฑ ูููุฑุณ
  - `(object_type, priority, attempts)` ูู `sync_queue` ุบูุฑ ูููุฑุณ
  - `(organization_id, created_at)` ูู ุฌุฏุงูู ูุชุนุฏุฏุฉ ุบูุฑ ูููุฑุณ
- ููุงุฑุณ FTS5 ููุฌูุฏุฉ ููู:
  - ูุง ูุชู ุชุญุฏูุซูุง ุจุดูู ููุชุธู
  - ุจุนุถูุง ูุญุชูู ุนูู ุฃุนูุฏุฉ ุบูุฑ ูุณุชุฎุฏูุฉ
  - ุจุนุถ ุงูุฌุฏุงูู ุงููููุฉ ูุง ุชุญุชูู ุนูู FTS (ูุซู `invoices`)
- ุนุฏู ูุฌูุฏ ููุงุฑุณ ุนูู timestamps ููุชุตููุฉ ุงูุฒูููุฉ:
  - `created_at` ูู `pos_orders` ุบูุฑ ูููุฑุณ
  - `invoice_date` ูู `invoices` ุบูุฑ ูููุฑุณ
  - `created_at` ูู `customer_debts` ุบูุฑ ูููุฑุณ
- ุจุนุถ ุงูููุงุฑุณ ููุฌูุฏุฉ ููููุง ุบูุฑ ูุนุงูุฉ:
  - ููุฑุณ `idx_sync_queue_priority` ูููุฑุณ `priority` ููุท ุจุฏูู `object_type`
  - ููุฑุณ `idx_pos_orders_status` ูููุฑุณ `status` ููุท ุจุฏูู `organization_id`
- ุนุฏู ุงุณุชุฎุฏุงู `UNIQUE` index ุญูุซ ูุฌุจ:
  - `order_number` ูู `pos_orders` ูุฌุจ ุฃู ูููู ูุฑูุฏ ููู `organization_id`
  - `invoice_number` ูู `invoices` ูุฌุจ ุฃู ูููู ูุฑูุฏ ููู `organization_id`

**ุงูุชุฃุซูุฑ:**
- ุงุณุชุนูุงูุงุช ุจุทูุฆุฉ ุฌุฏุงู ุนูู ุงูุฌุฏุงูู ุงููุจูุฑุฉ (>10,000 ุณุฌู)
- ุงุณุชููุงู CPU ุนุงูู ุนูุฏ ุงูุจุญุซ
- ุชุฌููุฏ ุงููุงุฌูุฉ ุฃุซูุงุก ุนูููุงุช ุงูุจุญุซ
- ุชุฃุฎูุฑ ูู ุชุญููู ุงูููุงุฆู ูุงูุชูุงุฑูุฑ
- ุงุณุชุนูุงูุงุช Full Table Scan ุจุฏูุงู ูู Index Scan
- ุจุทุก ูู ุนูููุงุช JOIN ุจูู ุงูุฌุฏุงูู

**ุฃูุซูุฉ ุนูู ุงูุงุณุชุนูุงูุงุช ุงููุชุฃุซุฑุฉ:**
```typescript
// ูู src/api/localPosOrderService.ts:224
// ูุฐุง ุงูุงุณุชุนูุงู ุจุทูุก ุฌุฏุงู ุจุฏูู ููุฑุณ ุนูู status
const byStatus = await inventoryDB.posOrders
  .where('status')
  .anyOf(['pending_sync', 'syncing', 'failed'])
  .toArray();

// ูู src/components/customers/CustomersList.tsx
// ุจุญุซ ุจุทูุก ุจุฏูู ููุฑุณ ุนูู name_lower
const filtered = customers.filter(c =>
  c.name_lower?.includes(searchTerm.toLowerCase())
);
```

---

### ๐ก **ูุดููุฉ #3: Constraints ูValidation ุบูุฑ ูุงููุฉ**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `electron/sqliteManager.cjs`
**ุงูุฃุณุทุฑ:** 219-500

**ูุตู ุงููุดููุฉ:**
- Foreign Keys ููุฌูุฏุฉ ููู ูุง ูุชู ุงูุชุญูู ูููุง ุฏุงุฆูุงู:
  - `PRAGMA foreign_keys = ON` ููุฌูุฏ ูู ุงูุณุทุฑ 184 ููู ุจุนุถ ุงูุนูููุงุช ุชุชุฌุงูุฒู
  - ุจุนุถ ุงูุฌุฏุงูู ุชุญุชูู ุนูู FK constraints ููู ูุง ูุชู ูุฑุถูุง ุนูุฏ ุงูุฅุฏุฑุงุฌ
  - ุนุฏู ูุฌูุฏ `ON DELETE CASCADE` ูู ุฌููุน ุงูู FK relationships
- ุนุฏู ูุฌูุฏ CHECK constraints ุนูู ุงูููู ุงูุญุฑุฌุฉ:
  - `stock_quantity` ูู `products` ูููู ุฃู ุชููู ุณุงูุจุฉ
  - `total_amount`, `paid_amount`, `remaining_amount` ูู `customer_debts` ูููู ุฃู ุชููู ุณุงูุจุฉ
  - `quantity` ูู `pos_order_items` ูููู ุฃู ุชููู ุตูุฑ ุฃู ุณุงูุจุฉ
  - `price` ู `cost` ูู `products` ูููู ุฃู ุชููู ุณุงูุจุฉ
- ุนุฏู ูุฌูุฏ UNIQUE constraints ุญูุซ ูุฌุจ:
  - `(order_number, organization_id)` ูู `pos_orders`
  - `(invoice_number, organization_id)` ูู `invoices`
  - `(sku, organization_id)` ูู `products` (ุฅุฐุง ูุงู SKU ูุทููุจ)
  - `(barcode, organization_id)` ูู `products` (ุฅุฐุง ูุงู Barcode ูุทููุจ)
- ุนุฏู ูุฌูุฏ NOT NULL ุนูู ุฃุนูุฏุฉ ูููุฉ:
  - `organization_id` ูู ุจุนุถ ุงูุฌุฏุงูู ูููู ุฃู ูููู NULL
  - `created_at` ู `updated_at` ูููู ุฃู ุชููู NULL ูู ุจุนุถ ุงูุฌุฏุงูู
- ุนุฏู ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช ูุจู ุงูุฅุฏุฑุงุฌ:
  - Emails ุบูุฑ ุตุงูุญุฉ ูููู ุฅุฏุฑุงุฌูุง ูู `customers.email`
  - Phone numbers ุจุชูุณููุงุช ุฎุงุทุฆุฉ ูู `customers.phone`
  - Dates ุบูุฑ ุตุงูุญุฉ ูู ุญููู ุงูุชุงุฑูุฎ
- ุนุฏู ูุฌูุฏ triggers ููุชุญูู ูู ุงูููุทู ุงูุชุฌุงุฑู:
  - `paid_amount` ูุง ูุฌุจ ุฃู ุชุชุฌุงูุฒ `total_amount` ูู `customer_debts`
  - `remaining_amount` ูุฌุจ ุฃู ุชุณุงูู `total_amount - paid_amount`

**ุงูุชุฃุซูุฑ:**
- ุฅุฏุฑุงุฌ ุจูุงูุงุช ุบูุฑ ุตุงูุญุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- Orphaned records (ุณุฌูุงุช ุจุฏูู parent)
- Duplicate entries ุจุฏูู ุงูุชุดุงู
- ุชุถุงุฑุจ ูู ุงูุจูุงูุงุช ุจูู SQLite ู Supabase
- ุตุนูุจุฉ ูู ุชุชุจุน ุงูุจูุงูุงุช ุงูุฎุงุทุฆุฉ ูุฅุตูุงุญูุง
- ุฃุฎุทุงุก ูู ุงูุญุณุงุจุงุช ุจุณุจุจ ููู ุณุงูุจุฉ

**ุฃูุซูุฉ ุนูู ุงูุจูุงูุงุช ุงูุฎุงุทุฆุฉ ุงูููููุฉ:**
```sql
-- ูููู ุฅุฏุฑุงุฌ ูุฎุฒูู ุณุงูุจ
INSERT INTO products (stock_quantity) VALUES (-100);

-- ูููู ุฅุฏุฑุงุฌ ุฏูู ุจูุจูุบ ูุฏููุน ุฃูุจุฑ ูู ุงูุฅุฌูุงูู
INSERT INTO customer_debts (total_amount, paid_amount) VALUES (100, 200);

-- ูููู ุฅุฏุฑุงุฌ ุทูุจูู ุจููุณ ุฑูู ุงูุทูุจ
INSERT INTO pos_orders (order_number, organization_id) VALUES ('ORD-001', 'org1');
INSERT INTO pos_orders (order_number, organization_id) VALUES ('ORD-001', 'org1');
```

---

### ๐ก **ูุดููุฉ #4: ุฃุนูุฏุฉ Cache ุงูุจุญุซ ุบูุฑ ูุญุฏุซุฉ ุชููุงุฆูุงู**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `electron/sqliteManager.cjs`
**ุงูุฃุณุทุฑ:** 219-500

**ูุตู ุงููุดููุฉ:**
- ุฃุนูุฏุฉ ุงูุจุญุซ ุงููุญุณููุฉ ูุง ูุชู ุชุญุฏูุซูุง ุชููุงุฆูุงู ุนูุฏ ุชุบููุฑ ุงูุจูุงูุงุช:
  - `name_lower` ูู `products` ูุง ูุชู ุชุญุฏูุซู ุนูุฏ ุชุบููุฑ `name`
  - `sku_lower` ูู `products` ูุง ูุชู ุชุญุฏูุซู ุนูุฏ ุชุบููุฑ `sku`
  - `barcode_lower` ูู `products` ูุง ูุชู ุชุญุฏูุซู ุนูุฏ ุชุบููุฑ `barcode`
  - `customer_name_lower` ูู `pos_orders` ูุง ูุชู ุชุญุฏูุซู ุนูุฏ ุชุบููุฑ `customer_name`
  - `invoice_number_lower` ูู `invoices` ูุง ูุชู ุชุญุฏูุซู ุนูุฏ ุชุบููุฑ `invoice_number`
  - `phone_digits` ูู `customers` ูุง ูุชู ุชุญุฏูุซู ุนูุฏ ุชุบููุฑ `phone`
  - `name_normalized` (ุงูุชุทุจูุน ุงูุนุฑุจู) ูุง ูุชู ุชุญุฏูุซู
- ุนุฏู ูุฌูุฏ triggers ูู SQLite ูุชุญุฏูุซ ูุฐู ุงูุฃุนูุฏุฉ:
  - ูุง ููุฌุฏ `AFTER UPDATE` trigger ุนูู `products`
  - ูุง ููุฌุฏ `AFTER INSERT` trigger ุนูู `products`
  - ููุณ ุงููุดููุฉ ูู ุฌุฏุงูู ุฃุฎุฑู
- ุงูุชุญุฏูุซ ูุชู ููุท ุนูุฏ ุงูุฅุฏุฑุงุฌ ุงูุฃููู ูููุณ ุนูุฏ ุงูุชุนุฏูู
- ุจุนุถ ุงูุณุฌูุงุช ุงููุฏููุฉ ุชุญุชูู ุนูู ููู NULL ุฃู ูุฏููุฉ ูู ูุฐู ุงูุฃุนูุฏุฉ
- ุนุฏู ูุฌูุฏ ุขููุฉ ููุชุญูู ูู ุตุญุฉ ูุฐู ุงูุฃุนูุฏุฉ
- ุงูููุฏ ูุนุชูุฏ ุนูู ูุฐู ุงูุฃุนูุฏุฉ ููุจุญุซ ููู ูุฏ ุชููู ุบูุฑ ุฏูููุฉ

**ุงูุชุฃุซูุฑ:**
- ูุชุงุฆุฌ ุจุญุซ ุบูุฑ ุฏูููุฉ ุฃู ูุงูุตุฉ
- ุนุฏู ุธููุฑ ุจุนุถ ุงูุณุฌูุงุช ูู ูุชุงุฆุฌ ุงูุจุญุซ
- ุชุถุงุฑุจ ุจูู ุงููููุฉ ุงููุนููุฉ ูุงููููุฉ ุงููุญุณูุจุฉ ููุจุญุซ
- ุตุนูุจุฉ ูู ุชุชุจุน ุงูููุชุฌุงุช ูุงูุนููุงุก ุจุงูุจุญุซ
- UX ุณูุก ุนูุฏูุง ูุง ุชุธูุฑ ุงููุชุงุฆุฌ ุงููุชููุนุฉ

**ุฃูุซูุฉ ุนูู ุงูุญุงูุงุช ุงููุชุฃุซุฑุฉ:**
```typescript
// ูู src/components/products/ProductsList.tsx
// ุงูุจุญุซ ูุณุชุฎุฏู name_lower ููู ูุฏ ูููู ูุฏูู
const filtered = products.filter(p =>
  p.name_lower?.includes(searchTerm.toLowerCase())
);
// ุฅุฐุง ุชู ุชุญุฏูุซ p.name ุจุฏูู ุชุญุฏูุซ p.name_lower
// ูู ูุธูุฑ ุงูููุชุฌ ูู ูุชุงุฆุฌ ุงูุจุญุซ
```

---

### ๐ก **ูุดููุฉ #5: ุนุฏู ูุฌูุฏ Soft Delete**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `electron/sqliteManager.cjs`

**ูุตู ุงููุดููุฉ:**
- ุฌููุน ุงูุฌุฏุงูู ุชุณุชุฎุฏู Hard Delete (ุญุฐู ูุนูู):
  - ูุง ููุฌุฏ ุนููุฏ `deleted_at` ูู ุฃู ุฌุฏูู
  - ูุง ููุฌุฏ ุนููุฏ `is_deleted` flag
  - ุงูุญุฐู ูุชู ุจุดูู ููุงุฆู ูู SQLite
- ุนุฏู ุฅููุงููุฉ ุงุณุชุฑุฌุงุน ุงูุจูุงูุงุช ุงููุญุฐููุฉ ุจุงูุฎุทุฃ
- ุนุฏู ูุฌูุฏ Audit Trail ููุญุฐู:
  - ูุง ูุชู ุชุณุฌูู ูู ูุงู ุจุงูุญุฐู
  - ูุง ูุชู ุชุณุฌูู ููุช ุงูุญุฐู
  - ูุง ูุชู ุชุณุฌูู ุณุจุจ ุงูุญุฐู
- ุนูุฏ ุงููุฒุงููุฉุ ุงูุญุฐู ูู SQLite ูุชู ูุฒุงููุชู ูุญุฐู ููุงุฆู ูู Supabase
- ุตุนูุจุฉ ูู ุงูุชุฑุงุฌุน ุนู ุนูููุงุช ุงูุญุฐู
- ููุฏุงู ุงูุจูุงูุงุช ุงูุชุงุฑูุฎูุฉ

**ุงูุชุฃุซูุฑ:**
- ููุฏุงู ุจูุงูุงุช ูููุฉ ุจุงูุฎุทุฃ ุจุฏูู ุฅููุงููุฉ ุงูุงุณุชุฑุฌุงุน
- ุนุฏู ุงููุฏุฑุฉ ุนูู ุงูุชุฏููู (Audit) ุนูู ุงูุนูููุงุช
- ุตุนูุจุฉ ูู ุญู ุงููุฒุงุนุงุช ูุน ุงูุนููุงุก
- ููุฏุงู ุงูุณุฌู ุงูุชุงุฑูุฎู ูููุจูุนุงุช ูุงูุทูุจุงุช
- ูุดุงูู ูู ุงูุชูุงุฑูุฑ ุงูุชุงุฑูุฎูุฉ

---

### ๐ก **ูุดููุฉ #6: ุนุฏู ูุฌูุฏ Database Versioning**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `electron/sqliteManager.cjs`

**ูุตู ุงููุดููุฉ:**
- ูุง ููุฌุฏ ุฌุฏูู `schema_migrations` ุฃู `database_version` ูู SQLite
- ูุง ูุชู ุชุชุจุน ุงูู migrations ุงูุชู ุชู ุชุทุจูููุง
- ูุง ุชูุฌุฏ ุขููุฉ ููุชุญูู ูู ูุณุฎุฉ Schema ุงูุญุงููุฉ
- ุตุนูุจุฉ ูู ูุนุฑูุฉ ุฅุฐุง ูุงูุช ุงููุงุนุฏุฉ ูุญุฏุซุฉ ุฃู ูุง
- ุนุฏู ุฅููุงููุฉ ุชุทุจูู migrations ุจุดูู ุชุฏุฑูุฌู
- ุฎุทุฑ ุชุทุจูู ููุณ ุงูู migration ูุฑุชูู
- ุนุฏู ูุฌูุฏ rollback mechanism ููู migrations

**ุงูุชุฃุซูุฑ:**
- ุตุนูุจุฉ ูู ุฅุฏุงุฑุฉ ุงูุชุญุฏูุซุงุช
- ุฎุทุฑ ุชูู ุงูุจูุงูุงุช ุนูุฏ ุชุทุจูู migrations ุฎุงุทุฆุฉ
- ุนุฏู ุงููุฏุฑุฉ ุนูู ุงูุชุฑุงุฌุน ุนู ุงูุชุญุฏูุซุงุช
- ุตุนูุจุฉ ูู troubleshooting ูุดุงูู Schema
- ุนุฏู ุงูุชุฃูุฏ ูู ุตุญุฉ ุงูุจููุฉ

---

### ๐ข **ูุดููุฉ #7: ุนุฏู ูุฌูุฏ Database Backups ุชููุงุฆูุฉ**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** `electron/sqliteManager.cjs`

**ูุตู ุงููุดููุฉ:**
- ูุง ููุฌุฏ ูุธุงู backup ุชููุงุฆู ููุงุนุฏุฉ ุงูุจูุงูุงุช SQLite
- ุฏุงูุฉ `backup()` ููุฌูุฏุฉ ูู ุงูุณุทุฑ 270 ููู ูุง ูุชู ุงุณุชุฏุนุงุคูุง ุชููุงุฆูุงู
- ูุง ูุชู ุญูุธ ูุณุฎ ุงุญุชูุงุทูุฉ ุฏูุฑูุฉ
- ุนุฏู ูุฌูุฏ restore point ูุจู ุงูุนูููุงุช ุงูุญุฑุฌุฉ
- ุตุนูุจุฉ ูู ุงูุงุณุชุฑุฌุงุน ุจุนุฏ ุงูุฃุฎุทุงุก ุงููุงุฑุซูุฉ

**ุงูุชุฃุซูุฑ:**
- ููุฏุงู ุฌููุน ุงูุจูุงูุงุช ูู ุญุงูุฉ ุชูู ุงูููู
- ุนุฏู ุงููุฏุฑุฉ ุนูู ุงูุงุณุชุฑุฌุงุน ุจุนุฏ ุฃุฎุทุงุก ูุงุฏุญุฉ
- ุตุนูุจุฉ ูู ุชุตุญูุญ ุงูุจูุงูุงุช ุงูุฎุงุทุฆุฉ

---

### ๐ข **ูุดููุฉ #8: ุนุฏู ูุฌูุฏ Database Size Monitoring**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** `electron/sqliteManager.cjs`

**ูุตู ุงููุดููุฉ:**
- ูุง ููุฌุฏ ุชุชุจุน ูุญุฌู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ูุง ููุฌุฏ ุชุญุฐูุฑ ุนูุฏูุง ุชุตุจุญ ุงููุงุนุฏุฉ ูุจูุฑุฉ ุฌุฏุงู
- ุฏุงูุฉ `getSize()` ููุฌูุฏุฉ ููู ูุง ูุชู ุงุณุชุฎุฏุงููุง ูููุฑุงูุจุฉ
- ุนุฏู ูุฌูุฏ cleanup policy ููุจูุงูุงุช ุงููุฏููุฉ
- ุฏุงูุฉ `cleanupOldData()` ููุฌูุฏุฉ ููู ูุง ูุชู ุงุณุชุฏุนุงุคูุง ุชููุงุฆูุงู

**ุงูุชุฃุซูุฑ:**
- ุงุณุชููุงู ูุณุงุญุฉ ุชุฎุฒูู ูุจูุฑุฉ ุจุฏูู ุฏุงุนู
- ุจุทุก ุงูุฃุฏุงุก ูุน ููุงุนุฏ ุจูุงูุงุช ูุจูุฑุฉ
- ุนุฏู ูุนุฑูุฉ ูุชู ูุฌุจ ุชูุธูู ุงูุจูุงูุงุช

---

## ๐ ุงููุณู ุงูุซุงูู: ูุดุงูู ูุธุงู ุงููุฒุงููุฉ ุงูุฑุฆูุณู (SyncService)

### ๐ด **ูุดููุฉ #9: ุชุถุงุฑุจ ูุชูุฑุงุฑ ูู ุฃูุธูุฉ ููุงุฆู ุงููุฒุงููุฉ**
**ุงูุฎุทูุฑุฉ:** ุญุฑุฌุฉ
**ุงูููู:** `src/api/syncService.ts`, `src/api/localPosOrderService.ts`, `src/lib/sync/SyncTracker.ts`
**ุงูุฃุณุทุฑ:** ูุชุนุฏุฏุฉ

**ูุตู ุงููุดููุฉ:**
- ุชูุฌุฏ **3 ุฃูุธูุฉ ูุฎุชููุฉ** ูุฅุฏุงุฑุฉ ููุงุฆู ุงููุฒุงููุฉ ุชุนูู ุจุดูู ูุณุชูู:

  **1. sync_queue (ุฌุฏูู SQLite)**
  - ูุชู ุงุณุชุฎุฏุงูู ูู `src/api/syncService.ts:636` (ุฏุงูุฉ `processSyncQueue`)
  - ูุฎุฒู ุงูุนูุงุตุฑ ุงููุนููุฉ ูู ุฌุฏูู SQLite
  - ูุณุชุฎุฏู ูู `syncService.ts:576` (ุฏุงูุฉ `removeSyncQueueItemsSafely`)

  **2. UnifiedQueue (ูู ุงูููุฏ)**
  - ูุชู ุงุณุชุฎุฏุงูู ูู `src/api/localPosOrderService.ts:56` (ุฏุงูุฉ `queueOrderSync`)
  - ูุธุงู ูููุตู ูุฅุฏุงุฑุฉ ุทุงุจูุฑ ุงููุฒุงููุฉ
  - ููุฌูุฏ ูู `src/sync/UnifiedQueue.ts`

  **3. syncTracker (ูู ุงูุฐุงูุฑุฉ)**
  - ูุชู ุงุณุชุฎุฏุงูู ูู `src/lib/sync/SyncTracker.ts`
  - ูุญูุธ ุงูุญุงูุฉ ูู ุงูุฐุงูุฑุฉ ููุท
  - ูุชู ุชุนุทููู ุฃุญูุงูุงู ููุง ูู ุงูุณุทุฑ 182 ูู `localPosOrderService.ts`:
    ```typescript
    // syncTracker.addPending(orderId, 'pos_orders'); // โ ุชู ุงูุชุนุทูู ูุชุฌูุจ ุงูุชุถุงุฑุจ
    ```

- **ูุดุงูู ุงูุชุถุงุฑุจ:**
  - ููุณ ุงูุนูุตุฑ (ูุซู ุทูุจ POS) ูููู ุฃู ูุถุงู ุฅูู sync_queue ู UnifiedQueue ูู ููุณ ุงูููุช
  - ุนุฏู ูุฌูุฏ synchronization ุจูู ุงูุฃูุธูุฉ ุงูุซูุงุซุฉ
  - UnifiedQueue ูุถูู ุนูุงุตุฑ ุจู `objectType: 'order'` ุจูููุง sync_queue ูุณุชุฎุฏู `objectType: 'pos_orders'`
  - syncTracker ูุนุทูู ูุชุฌูุจ ุงูุชุถุงุฑุจ (ุงูุณุทุฑ 182 ูู localPosOrderService.ts)
  - ุนุฏู ูุฌูุฏ ูุตุฏุฑ ูุงุญุฏ ููุญูููุฉ (Single Source of Truth)

- **ูุดุงูู ุงูุชูุฑุงุฑ:**
  - ููุณ ุงูุทูุจ ูููู ุฃู ููุฒุงูู ูุฑุชูู ูู ูุธุงููู ูุฎุชูููู
  - ุนุฏู ูุฌูุฏ deduplication ููุญุฏ
  - ูู `syncService.ts:669`ุ ููุฌุฏ deduplication ูุญูู ูููู ูุง ูุดูู UnifiedQueue
  - ุนุฏู ูุฌูุฏ Unique constraint ุนูู `(object_type, object_id)` ูู sync_queue

- **ูุดุงูู ุงูุญุงูุฉ (State)**:
  - sync_queue persistent (ูู SQLite)
  - UnifiedQueue ูุฏ ูููู ูู ุงูุฐุงูุฑุฉ ุฃู persistent (ุบูุฑ ูุงุถุญ)
  - syncTracker ูู ุงูุฐุงูุฑุฉ ููุท (ูุถูุน ุนูุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู)
  - ุนุฏู ุชุฒุงูู ุงูุญุงูุฉ ุจูู ุงูุฃูุธูุฉ ุงูุซูุงุซุฉ

**ุงูุชุฃุซูุฑ:**
- ุชูุฑุงุฑ ุนูููุงุช ุงููุฒุงููุฉ ูููุณ ุงูุนูุตุฑ (duplicate syncs)
- ุฅูุดุงุก ููุณ ุงูุทูุจ ุฃู ุงููุงุชูุฑุฉ ูุฑุชูู ุนูู ุงูุณูุฑูุฑ
- ุชุถุงุฑุจ ูู ุงูุจูุงูุงุช (data conflicts)
- ุงุณุชููุงู ููุงุฑุฏ ุบูุฑ ุถุฑูุฑู
- ุตุนูุจุฉ ูู ุชุชุจุน ุญุงูุฉ ุงููุฒุงููุฉ ุงููุนููุฉ
- ุฃุฎุทุงุก ูู ุงูุนุฏุงุฏุงุช ูุงูุฅุญุตุงุฆูุงุช
- ุนูุงุตุฑ ุนุงููุฉ ูู ููุงุฆู ูุชุนุฏุฏุฉ

**ุฃูุซูุฉ ุนูู ุงููุดุงูู ุงููุนููุฉ:**
```typescript
// ูู localPosOrderService.ts:146
await queueOrderSync({ order, items }); // ูุถูู ุฅูู UnifiedQueue

// ููู ูู ููุณ ุงูููุชุ ุฃู ูุงุญูุงู ูู syncService.ts:724
await inventoryDB.syncQueue.put(item); // ูุถูู ุฅูู sync_queue

// ุงููุชูุฌุฉ: ููุณ ุงูุทูุจ ูู ูุงุฆูุชูู ูุฎุชููุชูู!
```

---

### ๐ด **ูุดููุฉ #10: Race Conditions ูู ุงููุฒุงููุฉ ุงููุชุฒุงููุฉ**
**ุงูุฎุทูุฑุฉ:** ุญุฑุฌุฉ
**ุงูููู:** `src/api/syncService.ts`
**ุงูุฃุณุทุฑ:** 242, 417, 880, 1070

**ูุตู ุงููุดููุฉ:**
- ูุง ููุฌุฏ locking ุนูู ูุณุชูู ุงูุนูุตุฑ ุงููุงุญุฏ:
  - ูู ุงูุณุทุฑ 242 (`syncProduct` - case 'create'):
    ```typescript
    const { data, error } = await supabase
      .rpc('create_product_safe', { product_data: cleanProduct });
    ```
    ุงููุดููุฉ: ุฅุฐุง ุชู ุงุณุชุฏุนุงุก `syncProduct` ูุฑุชูู ูููุณ ุงูููุชุฌ ูู ูุงูุฐุชูู ูุฎุชููุชูู ูู ููุณ ุงูููุชุ ุณูุชู ุฅูุดุงุก ููุณ ุงูููุชุฌ ูุฑุชูู!

  - ูู ุงูุณุทุฑ 417 (`syncProduct` - case 'update'):
    ```typescript
    const { data: serverProduct, error: fetchError } = await supabase
      .from('products')
      .select('*')
      .eq('id', product.id)
      .single();
    // ... ุซู ุชุญุฏูุซ
    ```
    ุงููุดููุฉ: ุจูู ุงูู fetch ูุงูู updateุ ูุฏ ูุชุบูุฑ ุงูููุชุฌ ูู ูุงูุฐุฉ ุฃุฎุฑู

- SyncLockManager ููุฌูุฏ ููู ููุณุชุฎุฏู ููุท ุนูู ูุณุชูู ุงูููุน ุงูููู:
  - ูู ุงูุณุทุฑ 589: `syncLockManager.withLock('products', async () => {...})`
  - ูุฐุง ูููู ุฌููุน ุงูููุชุฌุงุชุ ูููุณ ููุชุฌ ูุงุญุฏ ูุญุฏุฏ
  - ูู ุงูุณุทุฑ 639: `syncLockManager.withLock('sync_queue', async () => {...})`
  - ูู ุงูุณุทุฑ 1762: `syncLockManager.withLock('global_sync', async () => {...})`
  - ูููุง locks ุนูู ูุณุชูู ุงูููุนุ ูููุณ ุนูู ูุณุชูู ID

- ูุดุงูู ูู ูุนุงูุฌุฉ ุงููุฒุงููุฉ ุงููุชูุงุฒูุฉ:
  - ูู ุงูุณุทุฑ 614-618ุ ูุชู ุงุณุชุฎุฏุงู `runWithPool` ุจู `SYNC_POOL_SIZE = 3`
  - ูุฐุง ูุนูู 3 ููุชุฌุงุช ูููู ูุฒุงููุชูุง ูู ููุณ ุงูููุช
  - ููู ูุง ููุฌุฏ ุถูุงู ุฃู ููุณ ุงูููุชุฌ ูุง ููุฒุงูู ูุฑุชูู

- ุนุฏู ูุฌูุฏ optimistic locking:
  - ูุง ูุชู ุงุณุชุฎุฏุงู `version` field ุฃู `updated_at` ููุชุญูู ูู ุงูุชุญุฏูุซุงุช ุงููุชุฒุงููุฉ
  - ูู ุงูุณุทุฑ 515-519 (update products):
    ```typescript
    const { error: updErr } = await supabase
      .from('products')
      .update(updatePayload)
      .eq('id', product.id);
    ```
    ูุง ููุฌุฏ `.eq('updated_at', expectedTimestamp)` ููุชุญูู

- ูุดุงูู ูู ุงูุนูููุงุช ุงูุฃุฎุฑู:
  - `syncCustomer` (ุงูุณุทุฑ 1070) ููุณ ุงููุดููุฉ
  - `syncAddress` (ุงูุณุทุฑ 1283) ููุณ ุงููุดููุฉ
  - `syncInvoice` (ุงูุณุทุฑ 880) ููุณ ุงููุดููุฉ

**ุงูุชุฃุซูุฑ:**
- ุฅูุดุงุก duplicate records ุนูู ุงูุณูุฑูุฑ
- ููุฏุงู ุชุญุฏูุซุงุช (lost updates) - ุขุฎุฑ ูุชุงุจุฉ ุชููุฒ ุจุฏูู ูุฑุงุนุงุฉ ุงูุญุงูุฉ
- ุชุถุงุฑุจ ุงูุจูุงูุงุช ุจูู ุงูุณูุฑูุฑ ูุงููุญูู
- ุฃุฎุทุงุก ูู ุงููุฎุฒูู ุจุณุจุจ ุชุญุฏูุซุงุช ูุชุฒุงููุฉ
- ุนุฏู ุฏูุฉ ุงูุจูุงูุงุช ุงููุงููุฉ (ุทูุจุงุชุ ููุงุชูุฑุ ุฏููู)

**ุณููุงุฑูู ุงููุดููุฉ:**
```
ุงูููุช | ุงููุงูุฐุฉ 1          | ุงููุงูุฐุฉ 2          | ุงูุณูุฑูุฑ
-------|-------------------|-------------------|----------
T1     | fetch product (qty=10) | fetch product (qty=10) | qty=10
T2     | ูุจูุน 5 ูุญุฏุงุช    |                   | qty=10
T3     |                   | ูุจูุน 3 ูุญุฏุงุช    | qty=10
T4     | update qty=5      |                   | qty=5
T5     |                   | update qty=7      | qty=7 โ ุฎุทุฃ!

ุงููุชูุฌุฉ: ุชู ุจูุน 8 ูุญุฏุงุช ููู ุงูุณูุฑูุฑ ูุธูุฑ qty=7 (ุฎุณุงุฑุฉ ูุญุฏุฉ!)
```

---

### ๐ด **ูุดููุฉ #11: ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุบูุฑ ูุงููุฉ ูุนุฏู ูุฌูุฏ Retry Strategy**
**ุงูุฎุทูุฑุฉ:** ุญุฑุฌุฉ
**ุงูููู:** `src/api/syncService.ts`
**ุงูุฃุณุทุฑ:** 809-860

**ูุตู ุงููุดููุฉ:**
- **ุนุฏุฏ ูุญุงููุงุช ูุญุฏูุฏ ุฌุฏุงู:**
  - ูู ุงูุณุทุฑ 828:
    ```typescript
    if (updatedItem.attempts >= 5) {
      // ุญุฐู ุจุนุฏ 5 ูุญุงููุงุช ููุท
      await inventoryDB.syncQueue.delete(item.id);
    }
    ```
  - 5 ูุญุงููุงุช ููููุฉ ุฌุฏุงู ููุฃุฎุทุงุก ุงููุคูุชุฉ (network timeouts, server downtime)
  - ุทูุจุงุช POS ุงููููุฉ ูุฏ ุชูุญุฐู ุจุนุฏ 5 ูุญุงููุงุช ูุงุดูุฉ

- **ุนุฏู ูุฌูุฏ Exponential Backoff:**
  - ูุง ููุฌุฏ ุชุฃุฎูุฑ ุจูู ุงููุญุงููุงุช
  - ูู ุงููุญุงููุงุช ุชุชู ุนูู ุงูุชูุงูู ุจุฏูู ุงูุชุธุงุฑ
  - ูู `processSyncQueue` (ุงูุณุทุฑ 637)ุ ูุชู ูุนุงูุฌุฉ ุฌููุน ุงูุนูุงุตุฑ ูุจุงุดุฑุฉ
  - ูุฐุง ูุณุจุจ rate limiting ูู ุงูุณูุฑูุฑ

- **ุนุฏู ุชุตููู ุงูุฃุฎุทุงุก:**
  - ูุง ููุฌุฏ ุชูููุฒ ุจูู:
    - ุฃุฎุทุงุก ุฏุงุฆูุฉ (permanent errors): ูุซู duplicate key (23505)ุ RLS policy violation
    - ุฃุฎุทุงุก ูุคูุชุฉ (temporary errors): ูุซู network timeoutุ server unavailable
    - ุฃุฎุทุงุก ุชุญุชุงุฌ ุชุฏุฎู (retry later): ูุซู rate limitingุ quota exceeded
  - ุฌููุน ุงูุฃุฎุทุงุก ุชูุนุงูู ุจููุณ ุงูุทุฑููุฉ

- **ูุง ููุฌุฏ Dead Letter Queue:**
  - ุงูุนูุงุตุฑ ุงูุชู ุชูุดู ุจุนุฏ 5 ูุญุงููุงุช ุชูุญุฐู ููุงุฆูุงู
  - ูุง ููุฌุฏ ููุงู ูุญูุธ ุงูุนูุงุตุฑ ุงููุงุดูุฉ ูููุฑุงุฌุนุฉ ุงููุฏููุฉ
  - ููุฏุงู ุงูุจูุงูุงุช ุงููููุฉ ุจุฏูู ุฅููุงููุฉ ุงูุงุณุชุฑุฌุงุน

- **ุนุฏู ุชุณุฌูู ุงูุฃุฎุทุงุก ุจุดูู ูุงูู:**
  - ูู ุงูุณุทุฑ 811-818:
    ```typescript
    console.warn(`โ๏ธ [SyncService] ูุดูุช ูุฒุงููุฉ ุนูุตุฑ queue:`, {
      itemId: item.id,
      objectType: item.objectType,
      // ... ูุนูููุงุช ูุญุฏูุฏุฉ
    });
    ```
  - ูุง ูุชู ุชุณุฌูู Stack trace ูุงูู
  - ูุง ูุชู ุชุณุฌูู Request/Response ููุชุญููู

- **ูุดุงูู ูู ุชุญุฏูุซ ุญุงูุฉ ุงูุฎุทุฃ:**
  - ูู ุงูุณุทุฑ 820-826:
    ```typescript
    const updatedItem: SyncQueueItem = {
      ...item,
      attempts: item.attempts + 1,
      lastAttempt: now,
      updatedAt: now
    };
    ```
  - ูุง ูุชู ุชุฎุฒูู ุฑุณุงูุฉ ุงูุฎุทุฃ ุงููุนููุฉ ูู `error` field
  - ุตุนูุจุฉ ูู troubleshooting ูุงุญูุงู

**ุงูุชุฃุซูุฑ:**
- ููุฏุงู ุจูุงูุงุช ูููุฉ (ุทูุจุงุชุ ููุงุชูุฑ) ุจุนุฏ 5 ูุญุงููุงุช ูุงุดูุฉ
- ุนูุงุตุฑ ุนุงููุฉ ูู ุงููุงุฆูุฉ ุจุฏูู ุญู
- ุงุณุชููุงู ููุงุฑุฏ ุจูุญุงููุงุช ูุชูุฑุฑุฉ ููุฑูุฉ
- rate limiting ูู ุงูุณูุฑูุฑ ุจุณุจุจ ุงููุญุงููุงุช ุงููุชูุงุญูุฉ
- ุตุนูุจุฉ ูู ุชุญุฏูุฏ ุณุจุจ ุงููุดู ูุญูู
- ุนุฏู ุงููุฏุฑุฉ ุนูู ุฅุนุงุฏุฉ ูุญุงููุฉ ุงูุนูุงุตุฑ ุงููุงุดูุฉ ูุฏููุงู

**ุฃูุซูุฉ ุนูู ุงูุฃุฎุทุงุก ุงูุชู ูุง ุชูุนุงูู ุจุดูู ุตุญูุญ:**
```typescript
// ุฎุทุฃ ุฏุงุฆู - ูุฌุจ ุญุฐูู ููุฑุงู
// Error: duplicate key value violates unique constraint (code: 23505)

// ุฎุทุฃ ูุคูุช - ูุฌุจ ุฅุนุงุฏุฉ ุงููุญุงููุฉ ูุน backoff
// Error: Network request failed (ECONNREFUSED)

// ุฎุทุฃ rate limiting - ูุฌุจ ุงูุงูุชุธุงุฑ ููุช ุฃุทูู
// Error: Too many requests (429)

// ูููุง ุชูุนุงูู ุจููุณ ุงูุทุฑููุฉ: 5 ูุญุงููุงุช ุซู ุญุฐู!
```

---

### ๐ด **ูุดููุฉ #12: ูุฒุงููุฉ ุงูููุชุฌุงุช ูุน Variants (ุฃููุงู ูููุงุณุงุช) ุบูุฑ ููุซููุฉ**
**ุงูุฎุทูุฑุฉ:** ุญุฑุฌุฉ
**ุงูููู:** `src/api/syncService.ts`
**ุงูุฃุณุทุฑ:** 70-202

**ูุตู ุงููุดููุฉ:**
- **ุดุฑุท ุฎุงุทุฆ ููุชุญูู ูู ุตุญุฉ ID:**
  - ูู ุงูุณุทุฑ 99-104 (`syncProductColors`):
    ```typescript
    const isValidId = color.id &&
      typeof color.id === 'string' &&
      color.id.length > 10 &&
      !color.id.startsWith('temp-') &&
      !color.id.includes('color'); // โ ูุฐุง ุงูุดุฑุท ุฎุงุทุฆ!
    ```
  - ุงููุดููุฉ: ุจุนุถ IDs ุตุญูุญุฉ (UUIDs ูู ุงูุณูุฑูุฑ) ููู ุชุญุชูู ุนูู ูููุฉ 'color' ูู ุงุณู ุงููุชุบูุฑ ุฃู comment
  - ูุซุงู: `d4c7b8a9-color-variant-123` โ ุณูุชู ุงุนุชุจุงุฑูุง temp ID ุจุงูุฎุทุฃ!
  - ููุณ ุงููุดููุฉ ูู ุงูุณุทุฑ 171-175 (`syncProductSizes`) ูุน 'size'

- **ุนุฏู ุงูุชุญูู ูู UUID ุจุดูู ุตุญูุญ:**
  - ูุง ูุชู ุงุณุชุฎุฏุงู UUID validation library
  - ุงูุดุฑุท `color.id.length > 10` ุบูุฑ ูุงูู ููุชุญูู ูู UUID
  - ุจุนุถ temp IDs ูุฏ ุชููู ุฃุทูู ูู 10 ุฃุญุฑู

- **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุถุนููุฉ:**
  - ูู ุงูุณุทุฑ 107-114:
    ```typescript
    try {
      await updateProductColor(color.id, colorData);
    } catch (updateError) {
      console.warn(`ูุดู ุชุญุฏูุซ ููู ${color.id}ุ ุณูุชู ูุญุงููุฉ ุฅูุดุงุฆู:`, updateError);
      isNewColor = true;
    }
    ```
  - ูุง ูุชู ุงูุชุญูู ูู ููุน ุงูุฎุทุฃ
  - ุฌููุน ุงูุฃุฎุทุงุก ุชูุนุงูู ูู "not found" ูุชุชุณุจุจ ูู ุฅูุดุงุก duplicate

- **ูุดุงูู ูู ูุฒุงููุฉ Sizes ุงููุชุฏุงุฎูุฉ:**
  - ูู ุงูุณุทุฑ 127-129:
    ```typescript
    if (targetColorId && color.sizes && Array.isArray(color.sizes)) {
      await syncProductSizes(productId, targetColorId, color.sizes);
    }
    ```
  - ุฅุฐุง ูุดูุช ูุฒุงููุฉ ุงููููุ ูู ูุชู ูุฒุงููุฉ ุงูููุงุณุงุช
  - ูุง ููุฌุฏ rollback ูููู ุฅุฐุง ูุดูุช ุงูููุงุณุงุช

- **ุนุฏู ูุฒุงููุฉ ุงูุชุญุฏูุซุงุช ุนูู Variants:**
  - ุงูููุฏ ูุฒุงูู ุงูุฃููุงู ูุงูููุงุณุงุช ููุท ุนูุฏ ุฅูุดุงุก ุงูููุชุฌ (case 'create')
  - ูู case 'update' (ุงูุณุทุฑ 417)ุ ูุง ูุชู ูุฒุงููุฉ ุงูู variants
  - ุฅุฐุง ุชู ุชุนุฏูู ููู ุฃู ููุงุณ ูุญููุงูุ ูู ููุฒุงูู ูุน ุงูุณูุฑูุฑ

- **ูุดุงูู ูู ุงูุชุฑุชูุจ:**
  - ุงูุฃููุงู ุชูุฒุงูู ูุจู ุงูููุชุฌ ุฃุญูุงูุงู
  - ุฅุฐุง ูุดู ุฅูุดุงุก ุงูููุชุฌุ ุชุจูู ุงูุฃููุงู orphaned ุนูู ุงูุณูุฑูุฑ

**ุงูุชุฃุซูุฑ:**
- ููุฏุงู ูุนูููุงุช ุงูุฃููุงู ูุงูููุงุณุงุช ุนูุฏ ุงููุฒุงููุฉ
- ุฅูุดุงุก duplicate colors/sizes ุนูู ุงูุณูุฑูุฑ
- orphaned variants ุจุฏูู ููุชุฌ parent
- ุนุฏู ูุฒุงููุฉ ุชุญุฏูุซุงุช ุงูู variants
- ูุดุงูู ูู ุงููุฎุฒูู ููููุชุฌุงุช ุฐุงุช ุงูู variants
- ุฃุฎุทุงุก ูู ุงูุทูุจุงุช ุงูุชู ุชุญุชูู ุนูู variants

**ุฃูุซูุฉ ุนูู ุงูุญุงูุงุช ุงููุชุฃุซุฑุฉ:**
```typescript
// ุญุงูุฉ 1: ููู ุจู UUID ุตุญูุญ ููู ูุญุชูู ุนูู 'color' ูู ุจุนุถ ุงูุฎุตุงุฆุต
const color = {
  id: 'a1b2c3d4-e5f6-7890-abcd-ef1234567890', // UUID ุตุญูุญ
  name: 'ุฃุญูุฑ',
  description: 'this is a color variant', // ูุญุชูู ุนูู ูููุฉ color
  // ุณูุชู ุงุนุชุจุงุฑู temp ID ุจุงูุฎุทุฃ!
};

// ุญุงูุฉ 2: ุชุญุฏูุซ ููู ููุฌูุฏ
const existingColor = { id: '...', name: 'ุฃุญูุฑ' };
// ุชู ุชุบููุฑ ุงูุงุณู ูุญููุงู ุฅูู 'ุฃุญูุฑ ุบุงูู'
// ูู ููุฒุงูู ุงูุชุญุฏูุซ ูุน ุงูุณูุฑูุฑ!
```

---

### ๐ **ูุดููุฉ #13: ุนุฏู ูุฒุงููุฉ ุงูุตูุฑ ุจุดูู ูุงูู**
**ุงูุฎุทูุฑุฉ:** ุนุงููุฉ
**ุงูููู:** `src/api/syncService.ts`
**ุงูุฃุณุทุฑ:** 209-238

**ูุตู ุงููุดููุฉ:**
- **ูุฒุงููุฉ ุงูุตูุฑ ุชุชู ููุท ุนูุฏ ุฅูุดุงุก ุงูููุชุฌ:**
  - ูู ุงูุณุทุฑ 258-260 ู 332-344 ู 365-377 ู 396-408:
    ```typescript
    // ูุฒุงููุฉ ุงูุตูุฑ ุงูุฅุถุงููุฉ
    if (savedImages.length > 0) {
      await syncProductImages(product.id, savedImages);
    }
    ```
  - ูุฐุง ุงูููุฏ ููุฌูุฏ ููุท ูู case 'create'
  - ูุง ููุฌุฏ ูู case 'update'

- **ุนุฏู ูุฒุงููุฉ ุงูุชุญุฏูุซุงุช ุนูู ุงูุตูุฑ:**
  - ุฅุฐุง ุชู ุชุนุฏูู ุตูุฑุฉ ูุญููุงู (ุชุบููุฑ positionุ alt_textุ is_primary)
  - ูู ูุชู ูุฒุงููุฉ ุงูุชุญุฏูุซ ูุน ุงูุณูุฑูุฑ

- **ุนุฏู ูุฒุงููุฉ ุญุฐู ุงูุตูุฑ:**
  - ุฅุฐุง ุชู ุญุฐู ุตูุฑุฉ ูุญููุงูุ ูู ูุชู ุญุฐููุง ูู ุงูุณูุฑูุฑ
  - ุงูุตูุฑ ุงููุฏููุฉ ุชุจูู ุนูู ุงูุณูุฑูุฑ

- **ุนุฏู ุงูุชุญูู ูู ูุฌูุฏ ุงูุตูุฑุฉ ุนูู ุงูุณูุฑูุฑ:**
  - ูู `syncProductImages` (ุงูุณุทุฑ 209-238):
    ```typescript
    for (const image of images) {
      await createProductImage(imageData);
    }
    ```
  - ูุชู ุฅูุดุงุก ุฌููุน ุงูุตูุฑ ุจุฏูู ุงูุชุญูู ูู ูุฌูุฏูุง
  - ูุฏ ุชููุดุฃ ููุณ ุงูุตูุฑุฉ ูุฑุชูู

- **ูุดุงูู ูู ุชุฑุชูุจ ุงูุตูุฑ:**
  - `position` ูุฏ ูุชุถุงุฑุจ ุจูู ุงูุตูุฑ ุงููุญููุฉ ูุงูุณูุฑูุฑ
  - ูุง ููุฌุฏ conflict resolution ููุตูุฑ

- **ุนุฏู ูุฒุงููุฉ thumbnail ุงูุฑุฆูุณู:**
  - `thumbnail_image` ูู ุงูููุชุฌ ูุฏ ูุฎุชูู ุนู ุงูุตูุฑ ุงููุฒุงููุฉ
  - ุนุฏู ุชุฒุงูู ุจูู `product.thumbnail_image` ู `product_images.url`

**ุงูุชุฃุซูุฑ:**
- ุตูุฑ ููุชุฌุงุช ูุงูุตุฉ ุนูู ุงูุณูุฑูุฑ
- ุตูุฑ ูุฏููุฉ ุฃู ูุญุฐููุฉ ุชุธูุฑ ุนูู ุงูุณูุฑูุฑ
- ุนุฏู ุชุฒุงูู ุจูู ุงููุญูู ูุงูุณูุฑูุฑ
- duplicate images ุนูู ุงูุณูุฑูุฑ
- ูุดุงูู ูู ุนุฑุถ ุงูููุชุฌุงุช ุนูู ุงููููุน
- ุชุถุงุฑุจ ูู ุชุฑุชูุจ ุงูุตูุฑ

---

### ๐ **ูุดููุฉ #14: ุชุฑุชูุจ ุงููุฒุงููุฉ ุบูุฑ ูุถููู**
**ุงูุฎุทูุฑุฉ:** ุนุงููุฉ
**ุงูููู:** `src/api/syncService.ts`
**ุงูุฃุณุทุฑ:** 1760-1821

**ูุตู ุงููุดููุฉ:**
- **ุนุฏู ูุฌูุฏ ุชุฑุชูุจ ุซุงุจุช ููุฒุงููุฉ ุงูููุงูุงุช:**
  - ูู `synchronizeWithServer` (ุงูุณุทุฑ 1760):
    ```typescript
    const productsResult = await syncUnsyncedProducts();
    const customersResult = await syncUnsyncedCustomers();
    const addressesResult = await syncUnsyncedAddresses();
    // ... ูุบูุฑูุง
    ```
  - ูู ูุฐู ุงูุนูููุงุช ูุชูุงุฒูุฉ (ูุง ููุฌุฏ ุชุฑุชูุจ)

- **ูุดุงูู Foreign Key:**
  - ุงูุนูุงููู (addresses) ูุฏ ุชูุฒุงูู ูุจู ุงูุนููุงุก (customers)
  - ุงููุชูุฌุฉ: `foreign key constraint violation` ูุฃู customer_id ุบูุฑ ููุฌูุฏ
  - ุนูุงุตุฑ ุงูุทูุจ (order_items) ูุฏ ุชูุฒุงูู ูุจู ุงูุทูุจุงุช (orders)
  - ุนูุงุตุฑ ุงููุงุชูุฑุฉ (invoice_items) ูุฏ ุชูุฒุงูู ูุจู ุงูููุงุชูุฑ (invoices)

- **ุชุจุนูุงุช ุบูุฑ ูุญุชุฑูุฉ:**
  - ุงูุฏููู (customer_debts) ุชุญุชุงุฌ:
    - ุงูุนููู (customer) ููุฌูุฏ
    - ุงูุทูุจ (order) ููุฌูุฏ ุฅุฐุง ูุงู ูุฑุชุจุท
  - ููู ูุฏ ุชูุฒุงูู ุงูุฏููู ูุจู ุงูุทูุจุงุช

- **ุนุฏู ูุฌูุฏ dependency graph:**
  - ูุง ููุฌุฏ ูุธุงู ูุชุญุฏูุฏ ุงูุชุจุนูุงุช ุจูู ุงูููุงูุงุช
  - ูู ููุงู ููุฒุงูู ุจุดูู ูุณุชูู

- **ูุดุงูู ูู ุงููุฒุงููุฉ ุงููุชูุงุฒูุฉ:**
  - ูู `runWithPool` (ุงูุณุทุฑ 40-63)ุ ูุชู ูุฒุงููุฉ 3 ุนูุงุตุฑ ูู ููุณ ุงูููุช
  - ูุฏ ูุชุณุจุจ ูู ุชุฒุงูู ุนููู ูุนููุงูู ูู ููุณ ุงูููุช
  - ุงูุนููุงู ูุฏ ููุดู ูุฃู ุงูุนููู ูู ูููุดุฃ ุจุนุฏ

**ุงูุชุฃุซูุฑ:**
- ูุดู ุงููุฒุงููุฉ ุจุณุจุจ FK violations
- ุนูุงุตุฑ orphaned ุนูู ุงูุณูุฑูุฑ
- ุนูุงุตุฑ ุนุงููุฉ ูู ุงููุงุฆูุฉ
- ุฅุนุงุฏุฉ ูุญุงููุงุช ุบูุฑ ุถุฑูุฑูุฉ
- ุชุถุงุฑุจ ูู ุงูุจูุงูุงุช

**ุงูุชุฑุชูุจ ุงูุตุญูุญ ุงูููุชุฑุถ:**
```
1. customers (ุฃููุงู - ูุง ุชุจุนูุงุช)
2. addresses (ุจุนุฏ customers)
3. products (ูุง ุชุจุนูุงุช ููู ูููุถู ูุจูุฑุงู)
4. invoices (ุจุนุฏ customers ู products)
5. invoice_items (ุจุนุฏ invoices)
6. pos_orders (ุจุนุฏ customers ู products)
7. pos_order_items (ุจุนุฏ pos_orders)
8. customer_debts (ุจุนุฏ customers ู pos_orders)
9. customer_debt_payments (ุจุนุฏ customer_debts)
```

**ุงูุชุฑุชูุจ ุงูุญุงูู:**
```
- ูู ุดูุก ูุชูุงุฒู ุจุฏูู ุชุฑุชูุจ!
```

---

### ๐ **ูุดููุฉ #15: ุนุฏู ูุฒุงููุฉ ุญุฐู ุงูุณุฌูุงุช ุจุดูู ููุซูู**
**ุงูุฎุทูุฑุฉ:** ุนุงููุฉ
**ุงูููู:** `src/api/syncService.ts`
**ุงูุฃุณุทุฑ:** 557-571, 732-738, 745-756

**ูุตู ุงููุดููุฉ:**
- **ูุนุงูุฌุฉ ุงูุญุฐู ุชุนุชูุฏ ุนูู ูุฌูุฏ ุงูุณุฌู ูุญููุงู:**
  - ูู ุงูุณุทุฑ 732-738 (`processSyncQueue` - product delete):
    ```typescript
    } else if (item.operation === 'delete') {
      const { error } = await supabase
        .from('products')
        .delete()
        .eq('id', item.objectId);
      success = !error;
    }
    ```
  - ุงููุดููุฉ: ุฅุฐุง ุชู ุญุฐู ุงูููุชุฌ ูุญููุงูุ ูู ูููู ููุฌูุฏ ูู `inventoryDB.products`
  - ููู ุงูููุฏ ูุนุชูุฏ ุนูู `const product = await inventoryDB.products.get(item.objectId)`
  - ุฅุฐุง ูุงู nullุ ูู ูุชู ุชูููุฐ ุงูุญุฐู ุนูู ุงูุณูุฑูุฑ ุฅูุง ูู else if

- **ุนุฏู ุชุณุฌูู ุนูููุงุช ุงูุญุฐู ุจุดูู ููุซูู:**
  - ุนูุฏ ุญุฐู ุณุฌู ูุญููุงูุ ูุฏ ูุง ูุชู ุฅุถุงูุฉ ุนูุตุฑ delete ุฅูู sync_queue
  - ุจุนุถ ูููุงุช ุงูุฎุฏูุฉ ุงููุญููุฉ ูุง ุชุณุชุฎุฏู sync_queue ููุญุฐู
  - ูุซุงู: ุญุฐู ูุจุงุดุฑ ุจุฏูู ุชุณุฌูู ูู ุงููุงุฆูุฉ

- **Cascade Delete ุบูุฑ ูุทุจู ุฏุงุฆูุงู:**
  - ุนูุฏ ุญุฐู ุนูููุ ูุง ูุชู ุญุฐู ุนูุงูููู ุชููุงุฆูุงู ุนูู ุงูุณูุฑูุฑ
  - ุนูุฏ ุญุฐู ุทูุจุ ูุง ูุชู ุญุฐู ุนูุงุตุฑู ุชููุงุฆูุงู
  - FK constraints ุจู ON DELETE CASCADE ููุฌูุฏุฉ ูู SQLite ููู ููุณ ูู ุฌููุน ุงูุญุงูุงุช

- **ุนุฏู ุงูุชุญูู ูู Soft Delete:**
  - ุจุนุถ ุงูุฌุฏุงูู ูู Supabase ูุฏ ุชุณุชุฎุฏู soft delete
  - ููู SQLite ูุณุชุฎุฏู hard delete ุฏุงุฆูุงู
  - ุชุถุงุฑุจ ูู ุงูุณููู

**ุงูุชุฃุซูุฑ:**
- ุณุฌูุงุช ูุญุฐููุฉ ูุญููุงู ุชุจูู ุนูู ุงูุณูุฑูุฑ
- orphaned records ุนูู ุงูุณูุฑูุฑ
- ุชุถุงุฑุจ ุจูู ุงููุญูู ูุงูุณูุฑูุฑ
- ุตุนูุจุฉ ูู ุงูุชุฏููู (audit trail)
- ูุดุงูู ูู ุงูุชูุงุฑูุฑ

---

### ๐ก **ูุดููุฉ #16: ุนุฏู ูุฒุงููุฉ Timestamps ุจุฏูุฉ**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `src/api/syncService.ts`
**ุงูุฃุณุทุฑ:** ูุชุนุฏุฏุฉ

**ูุตู ุงููุดููุฉ:**
- **ุงุณุชุฎุฏุงู Client timestamps:**
  - ุฌููุน ุงูู timestamps ูุชู ุฅูุดุงุคูุง ุนูู ุงูู client:
    ```typescript
    const now = new Date().toISOString();
    created_at: now,
    updated_at: now
    ```
  - ุณุงุนุฉ ุงูู client ูุฏ ุชููู ุบูุฑ ุฏูููุฉ
  - ูุฑู ุชูููุช ุจูู ุงูู client ูุงูุณูุฑูุฑ

- **ุนุฏู ุงุณุชุฎุฏุงู Server timestamps:**
  - Supabase ูููุฑ `now()` ู `CURRENT_TIMESTAMP`
  - ููู ูุง ูุชู ุงุณุชุฎุฏุงููุง
  - ูู ุงูุชูุงุฑูุฎ ูู ุงูู client

- **ูุดุงูู ูู Conflict Resolution:**
  - ุงูููุงุฑูุฉ ุจูู timestamps ุชุนุชูุฏ ุนูู ุฏูุฉ ุณุงุนุฉ ุงูู client
  - ูู `conflictDetector.detect` ูุชู ููุงุฑูุฉ `localTs` ู `serverTs`
  - ุฅุฐุง ูุงูุช ุณุงุนุฉ ุงูู client ูุชูุฏูุฉุ ุณูููุฒ ุงููุญูู ุฏุงุฆูุงู

- **ุนุฏู ุชุฒุงูู ูุน Server timezone:**
  - timestamps ูู SQLite ูู TEXT
  - timestamps ูู Supabase ูู TIMESTAMP WITH TIME ZONE
  - ูุฏ ูุญุฏุซ ุชุถุงุฑุจ ูู ุงูููุงุทู ุงูุฒูููุฉ

**ุงูุชุฃุซูุฑ:**
- timestamps ุบูุฑ ุฏูููุฉ
- conflict resolution ุฎุงุทุฆ
- ุตุนูุจุฉ ูู ุชุชุจุน ุงูุฃุญุฏุงุซ ุงูุฒูููุฉ
- ูุดุงูู ูู ุงูุชูุงุฑูุฑ ุงูุฒูููุฉ
- ุนุฏู ููุซูููุฉ ุงูู audit logs

---

### ๐ก **ูุดููุฉ #17: ุนุฏู ูุฌูุฏ Progress Tracking ูููุฒุงููุฉ**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `src/api/syncService.ts`

**ูุตู ุงููุดููุฉ:**
- ูุง ููุฌุฏ ูุธุงู ูุชุชุจุน ุชูุฏู ุงููุฒุงููุฉ:
  - ุนุฏุฏ ุงูุนูุงุตุฑ ุงูุฅุฌูุงูู ุงููุทููุจ ูุฒุงููุชู
  - ุนุฏุฏ ุงูุนูุงุตุฑ ุงููุฒุงููุฉ ุญุงููุงู
  - ุนุฏุฏ ุงูุนูุงุตุฑ ุงููุชุจููุฉ
  - ุงููุณุจุฉ ุงููุฆููุฉ ููุฅููุงู
- ุงููุณุชุฎุฏู ูุง ูุนุฑู ูู ุจูู ูู ุงูููุช
- ูุง ููุฌุฏ UI progress bar
- ููุท logs ูู console

**ุงูุชุฃุซูุฑ:**
- UX ุณูุก - ุงููุณุชุฎุฏู ูุง ูุนุฑู ูุงุฐุง ูุญุฏุซ
- ุดุนูุฑ ุจุฃู ุงูุชุทุจูู ูุชุฌูุฏ
- ุนุฏู ุงููุฏุฑุฉ ุนูู ุชูุฏูุฑ ููุช ุงูุฅููุงู

---

### ๐ก **ูุดููุฉ #18: ุนุฏู ูุฌูุฏ Sync History/Audit Log**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `src/api/syncService.ts`

**ูุตู ุงููุดููุฉ:**
- ูุง ููุฌุฏ ุฌุฏูู ูุชุณุฌูู ุชุงุฑูุฎ ุงููุฒุงููุฉ:
  - ูุชู ุชูุช ุขุฎุฑ ูุฒุงููุฉ
  - ูู ุนูุตุฑ ุชู ูุฒุงููุชู
  - ูู ุนูุตุฑ ูุดู
  - ูุง ูู ุงูุฃุฎุทุงุก
- conflictLogger ููุฌูุฏ ููู ููุท ููุชุถุงุฑุจุงุช
- ูุง ููุฌุฏ ุณุฌู ุนุงู ูููุฒุงููุฉ
- ุตุนูุจุฉ ูู troubleshooting

**ุงูุชุฃุซูุฑ:**
- ุตุนูุจุฉ ูู ุชุชุจุน ุงููุดุงูู
- ุนุฏู ูุนุฑูุฉ ูุชู ูุดูุช ุงููุฒุงููุฉ
- ุตุนูุจุฉ ูู ุงูุชุฏููู
- ุนุฏู ุงููุฏุฑุฉ ุนูู ุฅูุดุงุก ุชูุงุฑูุฑ ุนู ุงููุฒุงููุฉ

---

## ๐ฏ ุงููุณู ุงูุซุงูุซ: ูุดุงูู ูุธุงู Conflict Resolution

### ๐ **ูุดููุฉ #19: ุงุณุชุฑุงุชูุฌูุงุช ุญู ุงูุชุถุงุฑุจ ุจุณูุทุฉ ุฌุฏุงู**
**ุงูุฎุทูุฑุฉ:** ุนุงููุฉ
**ุงูููู:** `src/sync/conflictPolicy.ts`, `src/lib/sync/ConflictResolver.ts`
**ุงูุฃุณุทุฑ:** 18-54

**ูุตู ุงููุดููุฉ:**
- **ุงุณุชุฑุงุชูุฌูุฉ ููุญุฏุฉ ูุฌููุน ุงูุญููู:**
  - ูู `conflictPolicy.ts:23`:
    ```typescript
    export function resolveProductConflict(
      local: LocalProduct,
      remote: any,
      ctx: ConflictContext
    ): ConflictDecision {
      const localTs = toDate(local.localUpdatedAt || local.updated_at);
      const remoteTs = toDate(remote?.updated_at);

      if (remoteTs > localTs) return 'merge';
      if (localTs > remoteTs) return 'local';
      return 'merge';
    }
    ```
  - ุงููุดููุฉ: ุฌููุน ุงูุญููู ุชูุนุงูู ุจููุณ ุงูุทุฑููุฉ
  - ูุง ููุฌุฏ ุชูููุฒ ุจูู ุญููู ุญุฑุฌุฉ ูุฃุฎุฑู ุนุงุฏูุฉ

- **buildMergedProduct ููุถู ุงูุณูุฑูุฑ ุฏุงุฆูุงู:**
  - ูู ุงูุณุทุฑ 34-54:
    ```typescript
    export function buildMergedProduct(local: LocalProduct, remote: any): any {
      const localTs = toDate(local.localUpdatedAt || local.updated_at);
      const remoteTs = toDate(remote?.updated_at);

      const useRemoteStock = remoteTs > localTs;
      const stock = useRemoteStock
        ? (remote.stock_quantity ?? 0)
        : (local.stock_quantity ?? 0);

      return {
        ...remote, // โ ูุจุฏุฃ ูู ุงูุณูุฑูุฑ
        stock_quantity: stock,
      };
    }
    ```
  - ุงููุดููุฉ: ูุจุฏุฃ ูู `remote` ุซู ูุถูู ููุท `stock_quantity`
  - ุฌููุน ุงูุญููู ุงูุฃุฎุฑู ูู ุงูุณูุฑูุฑ
  - ุงูุชุนุฏููุงุช ุงููุญููุฉ ุนูู ุงูุงุณู ุฃู ุงููุตู ุชูููุฏ

- **ุนุฏู ูุฌูุฏ ุงุณุชุฑุงุชูุฌูุงุช ูุฎุตุตุฉ ููุญููู:**
  - ุงูุณุนุฑ (price): ูุฌุจ ุฃู ูููุฒ ุงูุณูุฑูุฑ ุฏุงุฆูุงู (ุชุญุฏูุซุงุช ูู ุงูุฅุฏุงุฑุฉ)
  - ุงููุฎุฒูู (stock_quantity): ูุฌุจ ููุงุฑูุฉ timestamps
  - ุงูุงุณู ูุงููุตู: ุงููุญูู ูุฌุจ ุฃู ูููุฒ ุฅุฐุง ุชู ุชุนุฏููู
  - ุงูุตูุฑ: ูุฌุจ ุฏูุฌ ุงูุงุซููู (union)

- **ูุง ููุฌุฏ field-level conflict resolution:**
  - ุงูุญู ูุชู ุนูู ูุณุชูู ุงูุณุฌู ุงููุงูู
  - ูุง ูููู ุญู ุญูู ุจุทุฑููุฉ ูุญูู ุขุฎุฑ ุจุทุฑููุฉ ูุฎุชููุฉ

- **ูุดุงูู ูู ุงุณุชุฑุงุชูุฌูุงุช ุงูููุงูุงุช ุงูุฃุฎุฑู:**
  - ุงูุนููุงุก (customers): ุงูุณูุฑูุฑ ูููุฒ ุฏุงุฆูุงู (`server_wins` ูู ุงูุณุทุฑ 1155)
  - ูุฏ ูููุฏ ุงููุณุชุฎุฏู ุชุนุฏููุงุช ูููุฉ ุนูู ุงูุนููู
  - ุงูููุงุชูุฑ (invoices): merge ุจุณูุท (ุงูุณุทุฑ 996)
  - ูุฏ ูุชุณุจุจ ูู ุฃุฎุทุงุก ูู ุงููุจุงูุบ

**ุงูุชุฃุซูุฑ:**
- ููุฏุงู ุจูุงูุงุช ูููุฉ ุนูุฏ ุญู ุงูุชุถุงุฑุจุงุช
- ุชุนุฏููุงุช ุงููุณุชุฎุฏู ุชูููุฏ
- ุชุถุงุฑุจ ูู ุงููุฎุฒูู
- ุนุฏู ุฏูุฉ ูู ุงูุจูุงูุงุช ุงููุงููุฉ
- frustration ูููุณุชุฎุฏู ุนูุฏูุง ุชูููุฏ ุชุนุฏููุงุชู

**ุญุงูุงุช ุงูุงุณุชุฎุฏุงู ุงููุชุฃุซุฑุฉ:**
```typescript
// ุญุงูุฉ 1: ุงููุณุชุฎุฏู ุนุฏูู ุงุณู ุงูููุชุฌ ูุญููุงู
local.name = "ููุชุฌ ูุญุฏุซ";
remote.name = "ููุชุฌ ูุฏูู";
// ุงููุชูุฌุฉ: ูููุฒ ุงูุณูุฑูุฑุ ููููุฏ ุงูุชุนุฏูู ุงููุญูู

// ุญุงูุฉ 2: ุงููุณุชุฎุฏู ุฃุถุงู ุตูุฑ ุฌุฏูุฏุฉ
local.images = ["img1.jpg", "img2.jpg", "img3.jpg"];
remote.images = ["img1.jpg"];
// ุงููุชูุฌุฉ: ูููุฒ ุงูุณูุฑูุฑุ ุชูููุฏ ุงูุตูุฑ ุงูุฌุฏูุฏุฉ

// ุญุงูุฉ 3: ุชุญุฏูุซ ูุชุฒุงูู ูููุฎุฒูู
local: ุจุงุน 5 ูุญุฏุงุช (stock = 45)
remote: ุงุณุชูู 10 ูุญุฏุงุช (stock = 60)
// ุงููุชูุฌุฉ: ุงูุฃุญุฏุซ timestamp ูููุฒุ ูุฏ ูููุฏ ุฅุญุฏู ุงูุนูููุชูู
```

---

### ๐ก **ูุดููุฉ #20: ุนุฏู ูุฌูุฏ Manual Conflict Resolution UI**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `src/api/syncService.ts`
**ุงูุฃุณุทุฑ:** 474-478, 959-982

**ูุตู ุงููุดููุฉ:**
- **ุงูุชุถุงุฑุจุงุช ุงูุญุฑุฌุฉ ุชูุชุฌุงูู:**
  - ูู ุงูุณุทุฑ 474-478:
    ```typescript
    if (resolution.requiresManualResolution) {
      console.warn(`[syncProduct] โ๏ธ Manual resolution required for ${product.id} - skipping for now`);
      // TODO: Add to manual resolution queue
      return false;
    }
    ```
  - ุงููุดููุฉ: ููุฌุฏ TODO ููู ุบูุฑ ูุทุจู
  - ุงูุชุถุงุฑุจุงุช ุงูุญุฑุฌุฉ ุชูุชุฌุงูู ูุชุจูู ุนุงููุฉ

- **ููุณ ุงููุดููุฉ ูู ุงูููุงุชูุฑ:**
  - ูู ุงูุณุทุฑ 959-982:
    ```typescript
    if (conflict.hasConflict && conflict.severity >= 60) {
      console.warn(`[syncInvoice] โ๏ธ High severity conflict - requires manual resolution`);
      // Log as manual resolution required
      await conflictLogger.log({...});
      // TODO: Add to manual resolution queue UI
      return false;
    }
    ```
  - ูุชู ุชุณุฌูู ุงูุชุถุงุฑุจ ููู ูุง ููุฌุฏ UI ููุญู

- **ูุง ููุฌุฏ ุตูุญุฉ ุฃู ูููู ููุชุถุงุฑุจุงุช:**
  - ูุง ููุฌุฏ `/conflicts` route
  - ูุง ููุฌุฏ UI ูุนุฑุถ ุงูุชุถุงุฑุจุงุช
  - ูุง ูููู ูููุณุชุฎุฏู ุฑุคูุฉ ูุงุฐุง ุญุฏุซ

- **ConflictLogger ูุญูุธ ูู SQLite ููู ูุง ููุณุชุฎุฏู:**
  - ููุฌุฏ ุฌุฏูู `conflict_resolution_log` ูู sqliteManager.cjs
  - ูุชู ุชุณุฌูู ุงูุชุถุงุฑุจุงุช
  - ููู ูุง ููุฌุฏ UI ูุนุฑุถูุง ุฃู ุญููุง

**ุงูุชุฃุซูุฑ:**
- ุงูุชุถุงุฑุจุงุช ุงูุญุฑุฌุฉ ุชุจูู ุนุงููุฉ ุจุฏูู ุญู
- ุงููุณุชุฎุฏู ูุง ูุนุฑู ุฃู ููุงู ูุดููุฉ
- ููุฏุงู ุจูุงูุงุช ุจุฏูู ุนูู ุงููุณุชุฎุฏู
- ุตุนูุจุฉ ูู troubleshooting
- ุนุฏู ุงููุฏุฑุฉ ุนูู ุงุชุฎุงุฐ ูุฑุงุฑ ูุฏูู

**ูุง ูุฌุจ ุฃู ูููู ููุฌูุฏุงู:**
```typescript
// ุตูุญุฉ Conflicts Dashboard
- ูุงุฆูุฉ ุจุฌููุน ุงูุชุถุงุฑุจุงุช ุบูุฑ ุงููุญูููุฉ
- ุนุฑุถ ุงููุณุฎุฉ ุงููุญููุฉ ูุงูุณูุฑูุฑ ุฌูุจุงู ุฅูู ุฌูุจ
- ุฃุฒุฑุงุฑ: [Keep Local] [Keep Server] [Merge Both] [Custom Edit]
- ุชุตููุฉ ุญุณุจ severity, entity_type, date
- ุฅุญุตุงุฆูุงุช: ุนุฏุฏ ุงูุชุถุงุฑุจุงุช ุงูุญุฑุฌุฉุ ุงููุญูููุฉุ ุงููุนููุฉ
```

---

### ๐ก **ูุดููุฉ #21: Conflict Detection ูุฏ ููููุช ุจุนุถ ุงูุชุถุงุฑุจุงุช**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `src/lib/sync/ConflictDetector.ts`
**ุงูุฃุณุทุฑ:** 23-99

**ูุตู ุงููุดููุฉ:**
- **Threshold ุซุงุจุช ููู timestamps:**
  - ูู ุงูุณุทุฑ 50-62:
    ```typescript
    const threshold = config.timestampThreshold ?? 5000; // 5 ุซูุงู

    if (timeDiff < threshold) {
      return {
        hasConflict: false,
        // ...
      };
    }
    ```
  - 5 ุซูุงู ูุฏ ุชููู ูุตูุฑุฉ ุฌุฏุงู
  - ูู ุญุงูุฉ ุงููุฒุงููุฉ ุงูุจุทูุฆุฉุ ูุฏ ูุญุฏุซ ุชุถุงุฑุจ ูุนูู ุฎูุงู 5 ุซูุงู

- **ignoreNullUndefined ูุฎูู ุจุนุถ ุงูุชุถุงุฑุจุงุช:**
  - ูู ุงูุณุทุฑ 69:
    ```typescript
    config.ignoreNullUndefined ?? true
    ```
  - ุงูุชุฑุงุถู true
  - ุฅุฐุง ูุงู local.field = null ู server.field = "value"
  - ูู ููุนุชุจุฑ ุชุถุงุฑุจ

- **IGNORED_FIELDS ูุฏ ุชุญุชูู ุนูู ุญููู ูููุฉ:**
  - ูุชู ุชุฌุงูู ุญููู ูุนููุฉ ุชููุงุฆูุงู
  - ููู ุจุนุถูุง ูุฏ ูููู ููู ูู ุญุงูุงุช ูุนููุฉ

- **ูุง ูุชู ูุดู ุงูุชุถุงุฑุจุงุช ุงููุนูุฏุฉ:**
  - ุชุถุงุฑุจุงุช ูู Arrays ุฃู Objects ูุชุฏุงุฎูุฉ
  - ูุซุงู: ุตูุฑ ุงูููุชุฌ - ูุง ูุชู ููุงุฑูุฉ ูุญุชูู ุงูู array

**ุงูุชุฃุซูุฑ:**
- ุจุนุถ ุงูุชุถุงุฑุจุงุช ุงููุนููุฉ ูุง ูุชู ูุดููุง
- ุญู ุชููุงุฆู ุฎุงุทุฆ
- ููุฏุงู ุจูุงูุงุช ุจุฏูู ุชูุจูู

---

### ๐ข **ูุดููุฉ #22: Conflict Logging ูุฏ ูุณุชููู ูุณุงุญุฉ ูุจูุฑุฉ**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** `src/lib/sync/ConflictLogger.ts`

**ูุตู ุงููุดููุฉ:**
- ูุชู ุชุณุฌูู ุฌููุน ุงูุชุถุงุฑุจุงุช ูู SQLite
- ูุง ููุฌุฏ cleanup policy
- ุฏุงูุฉ `cleanupOldConflicts` ููุฌูุฏุฉ ููู ูุง ุชูุณุชุฏุนู ุชููุงุฆูุงู
- ูุน ุงูููุชุ ุฌุฏูู conflict_resolution_log ูุฏ ูุตุจุญ ุถุฎู

**ุงูุชุฃุซูุฑ:**
- ุงุณุชููุงู ูุณุงุญุฉ ุชุฎุฒูู
- ุจุทุก ุงูุงุณุชุนูุงูุงุช ุนูู ุงูุฌุฏูู
- ุตุนูุจุฉ ูู ุงูุจุญุซ ุนู ุชุถุงุฑุจุงุช ูุนููุฉ

---

## ๐พ ุงููุณู ุงูุฑุงุจุน: ูุดุงูู ุทุจูุฉ ุงูู Cache (SQLite Query Cache)

### ๐ก **ูุดููุฉ #23: Cache Invalidation ุบูุฑ ุฏููู**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `src/lib/db/dbAdapter.ts`, `src/lib/cache/sqliteQueryCache.ts`
**ุงูุฃุณุทุฑ:** 124, 159-171

**ูุตู ุงููุดููุฉ:**
- **clearTable ูุญุฐู ูู ุงูู cache:**
  - ูู `dbAdapter.ts:124`:
    ```typescript
    sqliteCache.clearTable(this.tableName);
    ```
  - ููุณุชุฏุนู ุจุนุฏ ูู `put`, `bulkPut`, `update`, `delete`
  - ุงููุดููุฉ: ูุญุฐู ุญุชู ุงูุงุณุชุนูุงูุงุช ุบูุฑ ุงููุชุฃุซุฑุฉ

- **ูู `sqliteQueryCache.ts:159-171`:**
  ```typescript
  clearTable(tableName: string) {
    let cleared = 0;
    for (const [key] of this.cache.entries()) {
      if (key.includes(`:${tableName}:`)) {
        this.cache.delete(key);
        cleared++;
      }
    }
  }
  ```
  - ูุญุฐู ุฌููุน ุงูุงุณุชุนูุงูุงุช ุนูู ุงูุฌุฏูู
  - ุญุชู ูู ูุงู ุงูุชุญุฏูุซ ุนูู ุณุฌู ูุงุญุฏ ููุท

- **ุฃูุซูุฉ ุนูู Over-invalidation:**
  - ุชุญุฏูุซ ููุชุฌ ูุงุญุฏ โ ูุญุฐู ูู ุงุณุชุนูุงูุงุช ุงูููุชุฌุงุช
  - ุฅุถุงูุฉ ุนููู ูุงุญุฏ โ ูุญุฐู ูู ุงุณุชุนูุงูุงุช ุงูุนููุงุก
  - ุชุญุฏูุซ status ูุทูุจ ูุงุญุฏ โ ูุญุฐู ูู ุงุณุชุนูุงูุงุช ุงูุทูุจุงุช

- **ุงุณุชุนูุงูุงุช ุบูุฑ ูุชุฃุซุฑุฉ ุชูุญุฐู:**
  - ุงุณุชุนูุงู count ุนูู ุฌุฏูู ุขุฎุฑ
  - ุงุณุชุนูุงู get ูููุชุฌ ูุฎุชูู
  - ุงุณุชุนูุงูุงุช where ุนูู ุดุฑูุท ูุฎุชููุฉ

**ุงูุชุฃุซูุฑ:**
- Cache hit rate ููุฎูุถ
- ุงุณุชุนูุงูุงุช ูุชูุฑุฑุฉ ุบูุฑ ุถุฑูุฑูุฉ
- ุงุณุชููุงู CPU ูI/O
- ุจุทุก ูู ุงูุฃุฏุงุก
- ูุฏุฑ ูู ุงูููุงุฑุฏ

**ูุซุงู ุนูู ุงููุดููุฉ:**
```typescript
// Step 1: ุงุณุชุนูุงู ููุญุตูู ุนูู ุฌููุน ุงูููุชุฌุงุช (10,000 ููุชุฌ)
const allProducts = await inventoryDB.products.toArray(); // ููุฎุฒู ูู cache

// Step 2: ุชุญุฏูุซ ููุชุฌ ูุงุญุฏ
await inventoryDB.products.update('product-1', { stock_quantity: 100 });
// โ sqliteCache.clearTable('products')
// โ ูุญุฐู cache ูุฌููุน ุงูููุชุฌุงุช!

// Step 3: ุฅุนุงุฏุฉ ููุณ ุงูุงุณุชุนูุงู
const allProducts2 = await inventoryDB.products.toArray(); // ููุนูุฏ ุชุญููู 10,000 ููุชุฌ!
// ูุงู ูุฌุจ ุฃู ูุฃุชู ูู cache ูุฃู 9,999 ููุชุฌ ูู ูุชุบูุฑูุง
```

---

### ๐ก **ูุดููุฉ #24: Memory Leak ูู ุงูู Cache**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `src/lib/cache/sqliteQueryCache.ts`
**ุงูุฃุณุทุฑ:** 18-25

**ูุตู ุงููุดููุฉ:**
- **ูุง ููุฌุฏ ุญุฏ ุฃูุตู ูุญุฌู ุงูู cache:**
  - `cache = new Map<string, CacheEntry<any>>()`
  - ูููู ุฃู ูููู ุจุฏูู ุญุฏ
  - ูุง ููุฌุฏ max size policy

- **ุงูู entries ุงููุฏููุฉ ูุง ุชูุญุฐู ุชููุงุฆูุงู:**
  - TTL ููุฌูุฏ ูู CacheEntry
  - ููู ูุง ููุฌุฏ cleanup ุฏูุฑู
  - ุงูู entries ุงูููุชููุฉ ุตูุงุญูุชูุง ุชุจูู ูู ุงูุฐุงูุฑุฉ

- **Pending requests ูุฏ ุชุจูู ุนุงููุฉ:**
  - `pending = new Map<string, PendingRequest<any>>()`
  - ุฅุฐุง ูุดู requestุ ูุจูู ูู pending
  - ูุง ููุฌุฏ timeout ููู pending requests

- **ูุง ููุฌุฏ cleanup interval:**
  - ูุง ููุฌุฏ `setInterval` ูุชูุธูู ุงูุฐุงูุฑุฉ
  - ุงูู cache ูููู ูุน ุงูููุช

**ุงูุชุฃุซูุฑ:**
- ุงุณุชููุงู ุฐุงูุฑุฉ ูุชุฒุงูุฏ (memory leak)
- ุจุทุก ูู ุงูุจุญุซ ุนู keys ูู ุงูู Map
- ุงุณุชููุงุฏ ุฐุงูุฑุฉ ุงูู device
- crash ูู ุญุงูุงุช extreme

**ุณููุงุฑูู ุงููุดููุฉ:**
```typescript
// ุจุนุฏ ุณุงุนุฉ ูู ุงูุงุณุชุฎุฏุงู:
- 1000 ุงุณุชุนูุงู ูุฎุชูู
- 300 ูููุง ููุชููุฉ ุงูุตูุงุญูุฉ (TTL expired)
- 50 pending request ูุงุดู
- ูููุง ุชุจูู ูู ุงูุฐุงูุฑุฉ!

// ุจุนุฏ ููู ูุงูู:
- 10,000+ ุงุณุชุนูุงู
- 5,000+ ููุชููุฉ ุงูุตูุงุญูุฉ
- ูุฆุงุช ุงูู pending requests
- ุงุณุชููุงู ุฐุงูุฑุฉ: 500+ MB!
```

---

### ๐ก **ูุดููุฉ #25: TTL ุบูุฑ ููุงุณุจุฉ ูุจุนุถ ุงูุฌุฏุงูู**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** `src/lib/cache/sqliteQueryCache.ts`
**ุงูุฃุณุทุฑ:** 30-51

**ูุตู ุงููุดููุฉ:**
- **TTL ุซุงุจุชุฉ ููู ุฌุฏูู:**
  - ูู ุงูุณุทุฑ 30-51:
    ```typescript
    private TTL_MAP: Record<string, number> = {
      'product_categories': 10 * 60 * 1000, // 10 ุฏูุงุฆู
      'products': 2 * 60 * 1000, // ุฏูููุชุงู
      'pos_orders': 30 * 1000, // 30 ุซุงููุฉ
      // ...
    };
    ```

- **ูุฏ ุชููู ุบูุฑ ููุงุณุจุฉ ูู ุจุนุถ ุงูุญุงูุงุช:**
  - `products: 2 ุฏูุงุฆู` ูุฏ ุชููู ูุตูุฑุฉ ููููุชุฌุงุช ุงููุงุฏุฑุฉ ุงูุชุนุฏูู
  - `pos_orders: 30 ุซุงููุฉ` ูุฏ ุชููู ุทูููุฉ ููุทูุจุงุช ุงููุดุทุฉ
  - `sync_queue: 10 ุซูุงู` ูุฏ ุชููู ูุตูุฑุฉ ุฌุฏุงู

- **ูุง ููุฌุฏ dynamic TTL:**
  - ูุง ูุชู ุชุนุฏูู TTL ุจูุงุกู ุนูู ูุดุงุท ุงูุฌุฏูู
  - ุฌุฏุงูู ูุงุฏุฑุฉ ุงูุชุนุฏูู ุชุณุชุญู TTL ุฃุทูู
  - ุฌุฏุงูู ูุซูุฑุฉ ุงูุชุนุฏูู ุชุณุชุญู TTL ุฃูุตุฑ

**ุงูุชุฃุซูุฑ:**
- Cache misses ุบูุฑ ุถุฑูุฑูุฉ
- ุงุณุชุนูุงูุงุช ูุชูุฑุฑุฉ
- ุงุณุชููุงู ููุงุฑุฏ

---

### ๐ข **ูุดููุฉ #26: ุนุฏู ูุฌูุฏ Cache Statistics Dashboard**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** `src/lib/cache/sqliteQueryCache.ts`

**ูุตู ุงููุดููุฉ:**
- ุฏุงูุฉ `getStats()` ููุฌูุฏุฉ ูุชุนุทู ุฅุญุตุงุฆูุงุช ุฌูุฏุฉ
- ููู ูุง ููุฌุฏ UI ูุนุฑุถูุง
- ุงููุทูุฑ ูุญุชุงุฌ ูุชุญ console ูุฑุคูุชูุง
- ูุง ููุฌุฏ ุฑุณูู ุจูุงููุฉ ุฃู ุชุญูููุงุช

**ุงูุชุฃุซูุฑ:**
- ุตุนูุจุฉ ูู ุชุญุณูู ุงูู cache
- ุนุฏู ูุนุฑูุฉ ุฃู ุงูุฌุฏุงูู ุชุญุชุงุฌ ุชุญุณูู
- ุนุฏู ูุนุฑูุฉ hit rate ุงููุนูู ูู production

---

## ๐ ุงููุณู ุงูุฎุงูุณ: ูุดุงูู ููุงุฑูุฉ Schema ูุน Supabase

### ๐ด **ูุดููุฉ #27: ุฌุฏุงูู ูุงูุตุฉ ุจุงููุงูู ูู SQLite**
**ุงูุฎุทูุฑุฉ:** ุญุฑุฌุฉ
**ุงูููู:** `electron/sqliteManager.cjs`
**ุงูุฃุณุทุฑ:** 219-500

**ูุตู ุงููุดููุฉ:**
- **ุฌุฏุงูู ููุฌูุฏุฉ ูู Supabase ููู ุบูุฑ ููุฌูุฏุฉ ูู SQLite:**

  **1. product_returns & return_items** (ุฅุฑุฌุงุน ุงูููุชุฌุงุช)
  - ูููุฉ ููู offline mode
  - ุงููุณุชุฎุฏู ูุง ูุณุชุทูุน ุฅูุดุงุก ุฅุฑุฌุงุนุงุช ุฃุซูุงุก offline

  **2. loss_declarations & loss_items** (ุฅุนูุงูุงุช ุงูุฎุณุงุฆุฑ)
  - ูููุฉ ูุชุชุจุน ุงูุฎุณุงุฆุฑ
  - ุบูุฑ ูุชุงุญุฉ ูู offline

  **3. work_sessions** (ุฌูุณุงุช ุงูุนูู)
  - ูููุฉ ูุชุชุจุน ุฌูุณุงุช ุงูููุธููู
  - ุบูุฑ ูุชุงุญุฉ ูู offline

  **4. organization_subscriptions** (ุงูุงุดุชุฑุงูุงุช)
  - ูุนูููุงุช ุงูุงุดุชุฑุงู ุบูุฑ ูุชุงุญุฉ ูุญููุงู
  - ูุฏ ุชูุดู ุจุนุถ ุงูููุฒุงุช ุจุณุจุจ ุนุฏู ุงูุชุญูู ูู ุงูุงุดุชุฑุงู

  **5. product_categories & product_subcategories** (ุงูุชุตูููุงุช)
  - ูููุฉ ูุชูุธูู ุงูููุชุฌุงุช
  - ุบูุฑ ูุชุงุญุฉ ููุชุตููุฉ ูู offline

  **6. repair_locations** (ููุงูุน ุงูุฅุตูุงุญ)
  - ูููุฉ ููุธุงู ุงูุฅุตูุงุญ
  - ุบูุฑ ูุชุงุญุฉ ูู offline

  **7. repair_status_history** (ุชุงุฑูุฎ ุญุงูุงุช ุงูุฅุตูุงุญ)
  - ุชุชุจุน ุชุบููุฑุงุช ุญุงูุฉ ุงูุฅุตูุงุญ
  - ุบูุฑ ูุชุงุญ ูู offline

  **8. employees** (ุงูููุธููู)
  - ูุนูููุงุช ุงูููุธููู ุบูุฑ ูุชุงุญุฉ ูุญููุงู
  - ูุฏ ุชูุดู ุจุนุถ ุงูููุฒุงุช ุงููุฑุชุจุทุฉ ุจุงูููุธููู

- **ุงูุชุฃุซูุฑ ุนูู ุงูู Features:**
  - ููุฒุฉ ุฅุฑุฌุงุน ุงูููุชุฌุงุช ูุง ุชุนูู ูู offline mode
  - ููุฒุฉ ุฅุนูุงูุงุช ุงูุฎุณุงุฆุฑ ูุง ุชุนูู ูู offline mode
  - ุชุชุจุน ุฌูุณุงุช ุงูููุธููู ูุง ูุนูู ูู offline mode
  - ุงูุชุตููุฉ ุญุณุจ ุงููุฆุงุช ูุง ุชุนูู ุจุดูู ูุงูู ูู offline

**ุงูุชุฃุซูุฑ:**
- features ูุนุทููุฉ ูู offline mode
- UX ุณูุก ูููุณุชุฎุฏู
- ููุฏุงู ูุธุงุฆู ูููุฉ
- ุนุฏู ุงููุฏุฑุฉ ุนูู ุงูุนูู ุจุดูู ูุงูู ูู offline

---

### ๐ด **ูุดููุฉ #28: RLS Policies ุบูุฑ ููุณูุฉ ููุชุถุงุฑุจุฉ**
**ุงูุฎุทูุฑุฉ:** ุญุฑุฌุฉ
**ุงูููู:** `supabase/migrations/*.sql`
**ุนุฏุฏ ุงููููุงุช:** 119 migration

**ูุตู ุงููุดููุฉ:**
- **ุนุฏุฏ ูุจูุฑ ุฌุฏุงู ูู ุงูู migrations:**
  - 119 migration file
  - ูู `grep -r "CREATE TABLE"`: 49 CREATE TABLE statement
  - 403 ููู SQL ุฅุฌูุงูุงู ูู ุงููุดุฑูุน
  - ุตุนูุจุฉ ูู ุชุชุจุน ุงูุชุบููุฑุงุช

- **RLS Policies ูุชุถุงุฑุจุฉ:**
  - ุจุนุถ ุงูุฌุฏุงูู ููุง RLS ููุนูู ูุงูุจุนุถ ูุง
  - ูู ุจุนุถ migrations ูุชู disable RLS ูุคูุชุงู ููุงุฎุชุจุงุฑ
  - ูุซุงู: `disable_rls_temporarily.sql`, `emergency_disable_rls.sql`
  - ุจุนุถ policies ุชุณูุญ ุจุงููุตูู ูุงูุจุนุถ ูููุน ููุณ ุงูุนูููุฉ

- **ูุดุงูู ูู ุงููุฒุงููุฉ ุจุณุจุจ RLS:**
  - ุจุนุถ policies ุชููุน service role ูู ุงููุชุงุจุฉ
  - ุฃุฎุทุงุก 403 Forbidden ุฃุซูุงุก ุงููุฒุงููุฉ
  - ูู `syncService.ts`ุ ูุชู ุงุณุชุฎุฏุงู ุงูู user token
  - ูุฏ ูุง ูููู ุตูุงุญูุงุช ูุงููุฉ ูุจุนุถ ุงูุนูููุงุช

- **Policies ูุนูุฏุฉ ุฌุฏุงู:**
  - ุจุนุถ policies ุชุญุชูู ุนูู logic ูุนูุฏ
  - ุตุนุจ ููู ูุชู ููุณูุญ ููุชู ููููุน
  - ูุซุงู: policies ุชุนุชูุฏ ุนูู organization_id + role + permissions

- **ุนุฏู ูุฌูุฏ documentation ููู policies:**
  - ูุง ููุฌุฏ ููู ูุดุฑุญ policies ูู ุฌุฏูู
  - ุตุนุจ ูุนุฑูุฉ ูู ูุณุชุทูุน ุงููุตูู ููุงุฐุง
  - ุนุฏู ูุฌูุฏ matrix ููุตูุงุญูุงุช

**ุงูุชุฃุซูุฑ:**
- ูุดู ุงููุฒุงููุฉ ุจุฃุฎุทุงุก permissions
- 403 Forbidden errors
- ุนุฏู ุงููุฏุฑุฉ ุนูู ูุฒุงููุฉ ุจุนุถ ุงูุฌุฏุงูู
- ุชุถุงุฑุจ ูู ุงูุณููู ุจูู ุงูุจูุฆุงุช
- ุตุนูุจุฉ ูู troubleshooting

**ุฃูุซูุฉ ุนูู ุงููุดุงูู:**
```sql
-- ูู migration A
ALTER TABLE products ENABLE ROW LEVEL SECURITY;
CREATE POLICY "users_read_own_org" ON products FOR SELECT
  USING (organization_id = auth.uid());

-- ูู migration B (ูุงุญูุงู)
DROP POLICY "users_read_own_org" ON products;
CREATE POLICY "users_read_products" ON products FOR SELECT
  USING (true); -- โ ุณูุญ ููุฌููุน!

-- ูู migration C (ูุงุญูุงู)
DROP POLICY "users_read_products" ON products;
-- โ ุงูุขู ูุง ููุฌุฏ policy! ูุง ุฃุญุฏ ูุณุชุทูุน ุงููุฑุงุกุฉ!
```

---

### ๐ก **ูุดููุฉ #29: Column Types ุบูุฑ ูุชุทุงุจูุฉ**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `electron/sqliteManager.cjs`, `supabase/migrations/*.sql`

**ูุตู ุงููุดููุฉ:**
- **ุงุฎุชูุงูุงุช ูู ุฃููุงุน ุงูุจูุงูุงุช:**

  **1. Timestamps:**
  - SQLite: `TEXT` (ISO string)
  - Supabase: `TIMESTAMP WITH TIME ZONE`
  - ูุฏ ูุณุจุจ ูุดุงูู ูู ุงูููุงุฑูุงุช ูุงููุฑุฒ

  **2. Booleans:**
  - SQLite: `INTEGER` (0/1)
  - Supabase: `BOOLEAN` (true/false)
  - ูุญุชุงุฌ ุชุญููู ุฏุงุฆู

  **3. JSON:**
  - SQLite: `TEXT` (JSON string)
  - Supabase: `JSONB`
  - ูุญุชุงุฌ parse/stringify ุฏุงุฆู

  **4. UUIDs:**
  - SQLite: `TEXT`
  - Supabase: `UUID`
  - ูุฏ ูุณุจุจ ูุดุงูู ูู validation

  **5. Numeric Precision:**
  - SQLite: `REAL` (floating point)
  - Supabase: `NUMERIC(10,2)` (decimal)
  - ูุฏ ูุณุจุจ ูุดุงูู ูู ุงูุฏูุฉ ูููุจุงูุบ ุงููุงููุฉ

- **ุชุญูููุงุช ููููุฏุฉ:**
  - ุนูุฏ ุงููุฒุงููุฉุ ูุง ูุชู ุงูุชุญูู ูู ุฃููุงุน ุงูุจูุงูุงุช
  - ูุฏ ุชูุฑุณู ุจูุงูุงุช ุจููุน ุฎุงุทุฆ
  - Supabase ูุฏ ูุฑูุถ ุงูุจูุงูุงุช

**ุงูุชุฃุซูุฑ:**
- ุฃุฎุทุงุก ูู ุงููุฒุงููุฉ
- ููุฏุงู ุฏูุฉ ุงูุจูุงูุงุช (ุฎุงุตุฉ ุงููุงููุฉ)
- ูุดุงูู ูู ุงูููุงุฑูุงุช ุงูุฒูููุฉ
- ุชุถุงุฑุจ ูู ุงูููู

---

### ๐ก **ูุดููุฉ #30: Default Values ุบูุฑ ูุชุทุงุจูุฉ**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `electron/sqliteManager.cjs`, `supabase/migrations/*.sql`

**ูุตู ุงููุดููุฉ:**
- ุจุนุถ ุงูุฃุนูุฏุฉ ููุง default values ูู Supabase ููู ููุณ ูู SQLite
- ุฃู default values ูุฎุชููุฉ
- ูุซุงู:
  - `created_at` ูู Supabase: `DEFAULT now()`
  - `created_at` ูู SQLite: ูุง ููุฌุฏ default (ูุฌุจ ุชูุฑูุฑู ูู ุงูููุฏ)
- ูุฏ ูุณุจุจ NULL values ุบูุฑ ูุชููุนุฉ
- ุฃู ููู ุงูุชุฑุงุถูุฉ ุฎุงุทุฆุฉ

**ุงูุชุฃุซูุฑ:**
- ุจูุงูุงุช ุบูุฑ ูุชุณูุฉ
- ุฃุฎุทุงุก ูู ุงูุงุณุชุนูุงูุงุช
- ูุดุงูู ูู ุงูููุงุฑูุงุช

---

## ๐ ุงููุณู ุงูุณุงุฏุณ: ูุดุงูู Offline Mode ูุงูุชุนุงูู ูุนู

### ๐ก **ูุดููุฉ #31: ูุดู ุญุงูุฉ ุงูุงุชุตุงู ุบูุฑ ููุซูู**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** ูุง ููุฌุฏ ูุธุงู ูุฎุตุต ุญุงููุงู

**ูุตู ุงููุดููุฉ:**
- **ุงูุงุนุชูุงุฏ ุนูู `navigator.onLine` ููุท:**
  - `navigator.onLine` ุบูุฑ ููุซูู 100%
  - ูุฏ ูุนุทู `true` ุญุชู ูู ูุงู ุงูุงุชุตุงู ุจุทูุก ุฌุฏุงู
  - ูุฏ ูุนุทู `true` ุฅุฐุง ูุงู ูุชุตู ุจุดุจูุฉ WiFi ุจุฏูู ุฅูุชุฑูุช

- **ุนุฏู ูุฌูุฏ ูุญุต ุฏูุฑู ููุงุชุตุงู:**
  - ูุง ููุฌุฏ ping ุฏูุฑู ููุณูุฑูุฑ
  - ูุง ููุฌุฏ health check endpoint
  - ุงูุงุนุชูุงุฏ ููุท ุนูู ุฃุญุฏุงุซ `online`/`offline`

- **ุนุฏู ุงูุชูุฑูู ุจูู ุฃููุงุน ุงูุงุชุตุงู:**
  - ูุง ูุชู ูุดู ุฅุฐุง ูุงู ุงูุงุชุตุงู ุจุทูุก (slow 3G)
  - ูุง ูุชู ูุดู ุฅุฐุง ูุงู ุงูุณูุฑูุฑ down ููู ุงูุฅูุชุฑูุช ูุนูู
  - ูุง ูุชู ูุดู ุฅุฐุง ูุงู ููุงู timeout issues

- **SmartSyncEngine ููุชุฑุถ ุฃู ุงูุงุชุตุงู ุฏุงุฆูุงู ุฌูุฏ:**
  - ูู `SmartSyncEngine.ts`ุ ูุง ููุฌุฏ ูุญุต ููุงุชุตุงู ูุจู ุงููุฒุงููุฉ
  - ูุญุงูู ุงููุฒุงููุฉ ุญุชู ูู ูุงู offline
  - ููุดู ููุนูุฏ ุงููุญุงููุฉ ุจุฏูู ูุงุฆุฏุฉ

**ุงูุชุฃุซูุฑ:**
- ูุญุงููุงุช ูุฒุงููุฉ ูุงุดูุฉ ูุชูุฑุฑุฉ
- ุงุณุชููุงู ููุงุฑุฏ ุจุฏูู ุฏุงุนู
- UX ุณูุก - ุงููุณุชุฎุฏู ูุฑู ุฃุฎุทุงุก ุฏุงุฆูุงู
- ุนุฏู ุงููุฏุฑุฉ ุนูู ุงูุนูู ุจุดูู ุณูุณ ูู offline/online transitions

---

### ๐ก **ูุดููุฉ #32: ุนุฏู ูุฌูุฏ Offline UI Indicators ูุงุถุญุฉ**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** ูุงุฌูุฉ ุงููุณุชุฎุฏู

**ูุตู ุงููุดููุฉ:**
- ูุง ููุฌุฏ indicator ูุงุถุญ ููุญุงูุฉ:
  - ูุง ููุฌุฏ badge ุฃู icon ูุธูุฑ "Offline"
  - ูุง ููุฌุฏ color coding (ุฃุฎุถุฑ ููุฃูููุงููุ ุฃุญูุฑ ููุฃูููุงูู)
  - ุงููุณุชุฎุฏู ูุง ูุนุฑู ูู ูู online ุฃู offline

- NavbarSyncIndicator ููุฌูุฏ ููู ูุฏ ูุง ูููู ูุงุถุญ ููุงูุฉ
- ูุง ููุฌุฏ notifications ุนูุฏ ุชุบููุฑ ุงูุญุงูุฉ:
  - ูุง ููุฌุฏ toast/snackbar ูุธูุฑ "You are now offline"
  - ูุง ููุฌุฏ ุชูุจูู ุนูุฏ ุงูุนูุฏุฉ online

- ุนุฏู ูุฌูุฏ ูุงุฆูุฉ ุจุงูุนูููุงุช ุงููุนููุฉ:
  - ุงููุณุชุฎุฏู ูุง ูุฑู ูู ุนูููุฉ ูุนููุฉ ูููุฒุงููุฉ
  - ูุง ููุฌุฏ counter ุฃู progress bar

**ุงูุชุฃุซูุฑ:**
- confusion ูููุณุชุฎุฏู
- ุงููุณุชุฎุฏู ูุง ูุนุฑู ููุงุฐุง ุจุนุถ ุงูููุฒุงุช ูุง ุชุนูู
- frustration ุนูุฏูุง ุชูุดู ุงูุนูููุงุช
- ุนุฏู ุงูุซูุฉ ูู ุงูุชุทุจูู

---

### ๐ข **ูุดููุฉ #33: ุนุฏู ูุฌูุฏ Offline First Design ูุฌููุน ุงูููุฒุงุช**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** ูุชูุฑูุฉ

**ูุตู ุงููุดููุฉ:**
- ุจุนุถ ุงูููุฒุงุช ุชุนูู ูู offline ูุงูุจุนุถ ูุง
- ูุง ููุฌุฏ documentation ูุงุถุญ ุนู ุงูููุฒุงุช ุงููุชุงุญุฉ offline
- ุจุนุถ ุงูุตูุญุงุช ุชูุดู ูููุงู ูู offline
- ุนุฏู ูุฌูุฏ fallback UI ููุจูุงูุงุช ุบูุฑ ุงููุชุงุญุฉ

**ุงูุชุฃุซูุฑ:**
- inconsistent UX
- ุงููุณุชุฎุฏู ูุง ูุนุฑู ูุงุฐุง ูุชููุน
- ุจุนุถ ุงูููุฒุงุช ูุนุทููุฉ ุจุฏูู ุฏุงุนู

---

### ๐ข **ูุดููุฉ #34: ุนุฏู ูุฌูุฏ Offline Data Limit**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** `electron/sqliteManager.cjs`

**ูุตู ุงููุดููุฉ:**
- SQLite ูููู ุฃู ูููู ุจุฏูู ุญุฏ
- ูุง ููุฌุฏ limit ุนูู ุนุฏุฏ ุงูุณุฌูุงุช ุงููุญููุฉ
- ูุง ููุฌุฏ automatic archiving ููุจูุงูุงุช ุงููุฏููุฉ
- ุฏุงูุฉ `cleanupOldData` ููุฌูุฏุฉ ููู ูุง ุชู๏ฟฝ๏ฟฝุชุฏุนู ุชููุงุฆูุงู

**ุงูุชุฃุซูุฑ:**
- ุงุณุชููุงู ูุณุงุญุฉ ุชุฎุฒูู ูุจูุฑุฉ
- ุจุทุก ุงูุฃุฏุงุก ูุน ููุงุนุฏ ูุจูุฑุฉ
- ูุฏ ููุชูุฆ ุงููุฑุต

---

## ๐ฆ ุงููุณู ุงูุณุงุจุน: ูุดุงูู ุฎุฏูุงุช ุงููุฒุงููุฉ ุงููุญููุฉ

### ๐ก **ูุดููุฉ #35: ุนุฏู ูุฌูุฏ Transaction Support ูู ุจุนุถ ุงูุนูููุงุช**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `src/api/localPosOrderService.ts`, `src/api/localInvoiceService.ts`
**ุงูุฃุณุทุฑ:** ูุชุนุฏุฏุฉ

**ูุตู ุงููุดููุฉ:**
- **ุนูููุงุช ูุชุนุฏุฏุฉ ุจุฏูู transaction:**
  - ูู `localPosOrderService.ts:116-150`:
    ```typescript
    await inventoryDB.posOrders.put(orderRecord);

    for (const item of items) {
      await inventoryDB.posOrderItems.put(itemRecord);
    }

    await queueOrderSync({...});
    ```
  - ุฅุฐุง ูุดูุช ุฅุญุฏู ุนูููุงุช put ููู itemsุ ูุจูู ุงูุทูุจ ุจุฏูู ุนูุงุตุฑ
  - ูุง ููุฌุฏ rollback

- **ูู `localInvoiceService.ts`:**
  - ููุณ ุงููุดููุฉ ูุน ุงูููุงุชูุฑ ูุนูุงุตุฑูุง
  - ุฅุฐุง ูุดู ุฅูุดุงุก ุนูุตุฑุ ุชุจูู ุงููุงุชูุฑุฉ ุบูุฑ ูุงููุฉ

- **ุนูููุงุช ุงููุฎุฒูู ุจุฏูู transaction:**
  - ูู `localPosOrderService.ts:152-178`:
    ```typescript
    for (const item of items) {
      try {
        await updateProductStock(...);
      } catch {
        // ุชุฌุงูู ุฃุฎุทุงุก ุชุญุฏูุซ ุงููุฎุฒูู
      }
    }
    ```
  - ุฅุฐุง ูุดู ุชุญุฏูุซ ูุฎุฒูู ุฃุญุฏ ุงูููุชุฌุงุชุ ูููู ุงููุฎุฒูู ุบูุฑ ูุชุณู

- **inventoryDB.transaction ููุฌูุฏ ููู ุบูุฑ ูุณุชุฎุฏู:**
  - ูู `dbAdapter.ts:668-674`:
    ```typescript
    async transaction<T>(mode: 'r' | 'rw', ...args: any[]): Promise<T> {
      const callback = args.pop();
      if (typeof callback !== 'function') {
        throw new Error('Transaction callback must be a function');
      }
      return await callback();
    }
    ```
  - ูุฐุง implementation ูุฒูู! ููุท ูุณุชุฏุนู ุงูู callback
  - ูุง ููุฌุฏ rollback ูุนูู

**ุงูุชุฃุซูุฑ:**
- ุจูุงูุงุช ุบูุฑ ูุชุณูุฉ
- ุทูุจุงุช ุจุฏูู ุนูุงุตุฑ
- ููุงุชูุฑ ูุงูุตุฉ
- ูุฎุฒูู ุฎุงุทุฆ
- ุตุนูุจุฉ ูู recovery ูู ุงูุฃุฎุทุงุก

---

### ๐ก **ูุดููุฉ #36: ุนุฏู ุงูุชุญูู ูู ุงููุฎุฒูู ูุจู ุงูุจูุน**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `src/api/localPosOrderService.ts`

**ูุตู ุงููุดููุฉ:**
- ุนูุฏ ุฅูุดุงุก ุทูุจ POSุ ูุง ูุชู ุงูุชุญูู ูู ุชููุฑ ุงููุฎุฒูู
- ูููู ุจูุน ูููุงุช ุฃูุจุฑ ูู ุงููุชููุฑ
- `updateProductStock` ูุณูุญ ุจูุฎุฒูู ุณุงูุจ
- ูุง ููุฌุฏ warning ุฃู error ูููุณุชุฎุฏู

**ุงูุชุฃุซูุฑ:**
- ูุฎุฒูู ุณุงูุจ ูู ุงููุงุนุฏุฉ
- ุนุฏู ุฏูุฉ ูู ุงูุชูุงุฑูุฑ
- ูุดุงูู ูู ุฅุฏุงุฑุฉ ุงููุฎุฒูู
- ุจูุน ููุชุฌุงุช ุบูุฑ ูุชููุฑุฉ

---

### ๐ก **ูุดููุฉ #37: Local Order Numbers ูุฏ ุชุชุถุงุฑุจ**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `src/api/localPosOrderService.ts`
**ุงูุฃุณุทุฑ:** 36-52

**ูุตู ุงููุดููุฉ:**
- **ุงุณุชุฎุฏุงู localStorage counter:**
  - ูู ุงูุณุทุฑ 38-51:
    ```typescript
    const getNextLocalOrderNumber = (): number => {
      const raw = window.localStorage.getItem(LOCAL_COUNTER_KEY);
      const current = Number.parseInt(raw || '1000', 10);
      const next = Number.isFinite(current) ? current + 1 : 1001;
      window.localStorage.setItem(LOCAL_COUNTER_KEY, String(next));
      return next;
    };
    ```

- **ูุดุงูู:**
  - ุฅุฐุง ุชู ูุชุญ ุงูุชุทุจูู ูู ูุงูุฐุชููุ ูุฏ ูุญุตูุงู ุนูู ููุณ ุงูุฑูู
  - localStorage ููุณ atomic ูู multi-window scenario
  - ุฅุฐุง ุชู ูุณุญ localStorageุ ูุนูุฏ ุงูุนุฏุงุฏ ุฅูู 1000
  - ูุฏ ูุชุถุงุฑุจ ูุน ุฃุฑูุงู ุงูุทูุจุงุช ุงูุณุงุจูุฉ

- **ุนุฏู ูุฒุงููุฉ ูุน ุงูุณูุฑูุฑ:**
  - ุงูุฃุฑูุงู ุงููุญููุฉ (1000, 1001, ...) ูุฏ ุชุชุถุงุฑุจ ูุน ุฃุฑูุงู ุงูุณูุฑูุฑ
  - ุนูุฏ ุงููุฒุงููุฉุ ูุชู ุงุณุชุจุฏุงู `local_order_number` ุจู `remote_customer_order_number`
  - ููู ูุฏ ูุณุจุจ confusion ูููุณุชุฎุฏู

**ุงูุชุฃุซูุฑ:**
- duplicate order numbers ูุญููุงู
- confusion ูู ุชุชุจุน ุงูุทูุจุงุช
- ูุดุงูู ูู ุงููุฑุงุฌุน ุจูู ุงููุญูู ูุงูุณูุฑูุฑ

---

### ๐ข **ูุดููุฉ #38: ุนุฏู ูุฌูุฏ Validation ูุงููุฉ ูู ุงูุฎุฏูุงุช ุงููุญููุฉ**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** ุฌููุน ูููุงุช `local*Service.ts`

**ูุตู ุงููุดููุฉ:**
- ูุง ููุฌุฏ schema validation ููุจูุงูุงุช ูุจู ุงูุญูุธ
- ูุง ูุชู ุงูุชุญูู ูู:
  - ุตุญุฉ ุงูู UUIDs
  - ุตุญุฉ ุงูู emails
  - ุตุญุฉ ุฃุฑูุงู ุงููุงุชู
  - ููู ุณุงูุจุฉ ูู ุงููููุงุช ูุงููุจุงูุบ
  - ููู NULL ูู ุญููู ูุทููุจุฉ
- ุงูุงุนุชูุงุฏ ุนูู ุงูููุฏ ุงูุฐู ูุณุชุฏุนู ุงูุฎุฏูุฉ ููุชุญูู

**ุงูุชุฃุซูุฑ:**
- ุจูุงูุงุช ุบูุฑ ุตุงูุญุฉ ูู SQLite
- ุฃุฎุทุงุก ุนูุฏ ุงููุฒุงููุฉ
- ุตุนูุจุฉ ูู troubleshooting

---

## ๐ ุงููุณู ุงูุซุงูู: ูุดุงูู ุงูุฃูุงู ูุงูุตูุงุญูุงุช

### ๐ก **ูุดููุฉ #39: Sensitive Data ูู Logs**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** ุฌููุน ุงููููุงุช ุชูุฑูุจุงู

**ูุตู ุงููุดููุฉ:**
- `console.log` ูู ูู ููุงู ูุทุจุน ุงูุจูุงูุงุช ุงููุงููุฉ:
  - ูุนูููุงุช ุงูุนููุงุก (ุฃุณูุงุกุ ููุงุชูุ ุนูุงููู)
  - ูุนูููุงุช ุงูุทูุจุงุช (ูุจุงูุบุ ููุชุฌุงุช)
  - IDs ู Tokens
- ูู productionุ ูุฐู logs ูุฏ ุชููู ูุฑุฆูุฉ
- ูุง ููุฌุฏ data sanitization ูุจู ุงูู logging

**ุงูุชุฃุซูุฑ:**
- ุชุณุฑูุจ ูุนูููุงุช ุญุณุงุณุฉ
- ูุดุงูู ูู ุงูุฎุตูุตูุฉ (GDPR)
- ุฃูุงู ุถุนูู

---

### ๐ก **ูุดููุฉ #40: ุนุฏู ุชุดููุฑ SQLite Database**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `electron/sqliteManager.cjs`

**ูุตู ุงููุดููุฉ:**
- ูุงุนุฏุฉ ุงูุจูุงูุงุช SQLite ุบูุฑ ูุดูุฑุฉ
- ุงูููู `stockiha_*.db` ูููู ูุชุญู ุจุฃู SQLite browser
- ุฌููุน ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูุฑุฆูุฉ:
  - ูุนูููุงุช ุงูุนููุงุก
  - ุงููุจุงูุบ ุงููุงููุฉ
  - ุงูุทูุจุงุช
- better-sqlite3 ูุฏุนู encryption ููู ุบูุฑ ููุนูู

**ุงูุชุฃุซูุฑ:**
- ุชุณุฑูุจ ุงูุจูุงูุงุช ุฅุฐุง ุชู ุงููุตูู ููุฌูุงุฒ
- ูุดุงูู ุฃูููุฉ
- ุนุฏู ุงูุงูุชุซุงู ูููุนุงููุฑ ุงูุฃูููุฉ

---

### ๐ข **ูุดููุฉ #41: ุนุฏู ูุฌูุฏ Session Timeout**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** ูุธุงู ุงููุตุงุฏูุฉ

**ูุตู ุงููุดููุฉ:**
- ุงูุฌูุณุฉ ุชุจูู ููุชูุญุฉ ุฅูู ุงูุฃุจุฏ
- ูุง ููุฌุฏ inactivity timeout
- ุฅุฐุง ุชุฑู ุงููุณุชุฎุฏู ุงูุชุทุจูู ููุชูุญุ ุฃู ุดุฎุต ูุณุชุทูุน ุงููุตูู

**ุงูุชุฃุซูุฑ:**
- ูุดุงูู ุฃูููุฉ ูู ุจูุฆุงุช ูุดุชุฑูุฉ
- ูุตูู ุบูุฑ ูุตุฑุญ ุจู

---

## ๐งช ุงููุณู ุงูุชุงุณุน: ูุดุงูู ุงูุงุฎุชุจุงุฑ ูุงูุฌูุฏุฉ

### ๐ข **ูุดููุฉ #42: ุนุฏู ูุฌูุฏ Unit Tests**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** ุฌููุน ุงููููุงุช

**ูุตู ุงููุดููุฉ:**
- ูุง ููุฌุฏ unit tests ูุฃู ูู ุงููุธุงุฆู
- ูุง ููุฌุฏ tests ูููุฒุงููุฉ
- ูุง ููุฌุฏ tests ููู conflict resolution
- ุตุนูุจุฉ ูู ุงูุชุดุงู regressions

**ุงูุชุฃุซูุฑ:**
- bugs ุบูุฑ ููุชุดูุฉ
- ุตุนูุจุฉ ูู refactoring
- ุนุฏู ุงูุซูุฉ ูู ุงูุชุบููุฑุงุช

---

### ๐ข **ูุดููุฉ #43: ุนุฏู ูุฌูุฏ Integration Tests**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** ุฌููุน ุงููููุงุช

**ูุตู ุงููุดููุฉ:**
- ูุง ููุฌุฏ integration tests ูููุฒุงููุฉ ุงููุงููุฉ
- ูุง ููุฌุฏ tests ูุณููุงุฑูููุงุช offline/online
- ูุง ููุฌุฏ tests ููุชุถุงุฑุจุงุช
- ูุง ููุฌุฏ tests ููู race conditions

**ุงูุชุฃุซูุฑ:**
- ูุดุงูู ูู ุณููุงุฑูููุงุช ูุนูุฏุฉ
- ุตุนูุจุฉ ูู ุถูุงู ุงูุฌูุฏุฉ
- ุงูุชุดุงู bugs ูู production ููุท

---

### ๐ข **ูุดููุฉ #44: ุนุฏู ูุฌูุฏ E2E Tests**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** ุฌููุน ุงููููุงุช

**ูุตู ุงููุดููุฉ:**
- ูุง ููุฌุฏ end-to-end tests ููุชุทุจูู
- ูุง ููุฌุฏ tests ููู Electron app
- ุตุนูุจุฉ ูู ุถูุงู ุฃู ูู ุดูุก ูุนูู ูุนุงู

**ุงูุชุฃุซูุฑ:**
- ูุดุงูู ูู ุงูู production
- ุนุฏู ุงููุฏุฑุฉ ุนูู ุงุฎุชุจุงุฑ ุงูุณููุงุฑูููุงุช ุงููุงููุฉ

---

## ๐ ุงููุณู ุงูุนุงุดุฑ: ูุดุงูู ุงูุชูุซูู ูุงูุตูุงูุฉ

### ๐ข **ูุดููุฉ #45: ุนุฏู ูุฌูุฏ API Documentation**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** ุฌููุน ุงููููุงุช

**ูุตู ุงููุดููุฉ:**
- ูุง ููุฌุฏ JSDoc ููุนุธู ุงูุฏูุงู
- ูุง ููุฌุฏ ุดุฑุญ ููู parameters
- ูุง ููุฌุฏ ุฃูุซูุฉ ุนูู ุงูุงุณุชุฎุฏุงู
- ุตุนูุจุฉ ูู ููู ุงูููุฏ ูููุทูุฑูู ุงูุฌุฏุฏ

**ุงูุชุฃุซูุฑ:**
- ุตุนูุจุฉ ูู ุงูุตูุงูุฉ
- ุฒูุงุฏุฉ ููุช onboarding
- ุฃุฎุทุงุก ูู ุงูุงุณุชุฎุฏุงู

---

### ๐ข **ูุดููุฉ #46: ุนุฏู ูุฌูุฏ Architecture Documentation**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** ูุง ููุฌุฏ

**ูุตู ุงููุดููุฉ:**
- ูุง ููุฌุฏ documentation ููุจููุฉ ุงููุนูุงุฑูุฉ
- ูุง ููุฌุฏ diagrams
- ูุง ููุฌุฏ ุดุฑุญ ูุชุฏูู ุงูุจูุงูุงุช
- ุตุนูุจุฉ ูู ููู ุงููุธุงู ุงูููู

**ุงูุชุฃุซูุฑ:**
- ุตุนูุจุฉ ูู ุงูุตูุงูุฉ
- ุตุนูุจุฉ ูู ุฅุถุงูุฉ ููุฒุงุช ุฌุฏูุฏุฉ
- ุงุญุชูุงููุฉ ูุณุฑ ุงูุฃุดูุงุก

---

### ๐ข **ูุดููุฉ #47: ุนุฏู ูุฌูุฏ Error Handling Guidelines**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** ูุง ููุฌุฏ

**ูุตู ุงููุดููุฉ:**
- ูุง ููุฌุฏ guidelines ูููููุฉ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
- ุจุนุถ ุงูุฏูุงู ุชุฑูู exceptions ูุงูุจุนุถ ูุนูุฏ boolean
- inconsistent error handling
- ุจุนุถ ุงูุฃุฎุทุงุก ุชูุจุชูุน (catch { })

**ุงูุชุฃุซูุฑ:**
- inconsistent UX
- ุตุนูุจุฉ ูู debugging
- ุฃุฎุทุงุก ุตุงูุชุฉ

---

## ๐ง ุงููุณู ุงูุญุงุฏู ุนุดุฑ: ูุดุงูู ุงูุฃุฏุงุก

### ๐ก **ูุดููุฉ #48: N+1 Query Problem ูู ุจุนุถ ุงูุญุงูุงุช**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `src/api/syncService.ts`

**ูุตู ุงููุดููุฉ:**
- ูู `processSyncQueue` (ุงูุณุทุฑ 703-859):
  ```typescript
  for (const item of queue) {
    const product = await inventoryDB.products.get(item.objectId);
    await syncProduct(product);
  }
  ```
- ูุชู ุฌูุจ ูู ููุชุฌ ุนูู ุญุฏุฉ
- ูููู ุฌูุจูุง ุฌููุนุงู ูุฑุฉ ูุงุญุฏุฉ

**ุงูุชุฃุซูุฑ:**
- ุจุทุก ูู ูุนุงูุฌุฉ Queue ูุจูุฑ
- ุงุณุชููุงู ููุงุฑุฏ

---

### ๐ก **ูุดููุฉ #49: ุนุฏู ูุฌูุฏ Batching ููุนูููุงุช**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** `src/api/syncService.ts`

**ูุตู ุงููุดููุฉ:**
- ูู ุนูุตุฑ ููุฒุงูู ุนูู ุญุฏุฉ
- ูููู ุฏูุฌ ุนุฏุฉ ุนูููุงุช ูู batch ูุงุญุฏ
- ูุซุงู: ุฅูุดุงุก 100 ููุชุฌ โ 100 request ุจุฏูุงู ูู 1 request

**ุงูุชุฃุซูุฑ:**
- ุจุทุก ูู ุงููุฒุงููุฉ
- ุงุณุชููุงู network

---

### ๐ก **ูุดููุฉ #50: ุนุฏู ุงุณุชุฎุฏุงู Indexes ุจุดูู ุตุญูุญ ูู ุจุนุถ ุงูุงุณุชุนูุงูุงุช**
**ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
**ุงูููู:** ูุชูุฑูุฉ

**ูุตู ุงููุดููุฉ:**
- ุจุนุถ ุงูุงุณุชุนูุงูุงุช ูุง ุชุณุชุฎุฏู indexes ููุฌูุฏุฉ
- ุงุณุชุฎุฏุงู `.filter()` ุจุฏูุงู ูู `.where()`
- ุงุณุชุนูุงูุงุช case-sensitive ุจุฏูุงู ูู ุงุณุชุฎุฏุงู `*_lower` fields

**ุงูุชุฃุซูุฑ:**
- Full table scans
- ุจุทุก ูู ุงูุงุณุชุนูุงูุงุช
- ุงุณุชููุงู CPU

---

### ๐ข **ูุดููุฉ #51: ุนุฏู ุงุณุชุฎุฏุงู Web Workers ููุนูููุงุช ุงูุซูููุฉ**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** ูุง ููุฌุฏ

**ูุตู ุงููุดููุฉ:**
- ุฌููุน ุงูุนูููุงุช ุชุนูู ุนูู ุงูู main thread
- ุนูููุงุช ุงููุฒุงููุฉ ุงูุซูููุฉ ุชูุฌููุฏ ุงููุงุฌูุฉ
- ูุง ููุฌุฏ workers ููู:
  - ูุฒุงููุฉ ูุจูุฑุฉ
  - ูุนุงูุฌุฉ ุตูุฑ
  - ุญุณุงุจุงุช ูุนูุฏุฉ

**ุงูุชุฃุซูุฑ:**
- ุชุฌููุฏ ุงููุงุฌูุฉ
- UX ุณูุก
- ุดุนูุฑ ุจุจุทุก ุงูุชุทุจูู

---

## ๐จ ุงููุณู ุงูุซุงูู ุนุดุฑ: ูุดุงูู UX/UI

### ๐ข **ูุดููุฉ #52: ุนุฏู ูุฌูุฏ Loading States ูุงุถุญุฉ**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** ูุงุฌูุฉ ุงููุณุชุฎุฏู

**ูุตู ุงููุดููุฉ:**
- ุจุนุถ ุงูุนูููุงุช ูุง ุชุธูุฑ loading indicator
- ุงููุณุชุฎุฏู ูุง ูุนุฑู ุฅุฐุง ูุงูุช ุงูุนูููุฉ ุฌุงุฑูุฉ
- ูุง ููุฌุฏ progress bar ูููุฒุงููุฉ ุงูุทูููุฉ

**ุงูุชุฃุซูุฑ:**
- confusion ูููุณุชุฎุฏู
- ุถุบุท ูุชูุฑุฑ ุนูู ุงูุฃุฒุฑุงุฑ
- ุดุนูุฑ ุจุฃู ุงูุชุทุจูู ูุชุฌูุฏ

---

### ๐ข **ูุดููุฉ #53: ุนุฏู ูุฌูุฏ Error Messages ูุงุถุญุฉ ูููุณุชุฎุฏู**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** ูุงุฌูุฉ ุงููุณุชุฎุฏู

**ูุตู ุงููุดููุฉ:**
- ุฑุณุงุฆู ุงูุฃุฎุทุงุก ุชูููุฉ ุฌุฏุงู
- ุงููุณุชุฎุฏู ุงูุนุงุฏู ูุง ูููููุง
- ูุง ุชูุฌุฏ ุฅุฑุดุงุฏุงุช ูุญู ุงููุดููุฉ

**ุงูุชุฃุซูุฑ:**
- frustration ูููุณุชุฎุฏู
- ุฒูุงุฏุฉ ุทูุจุงุช ุงูุฏุนู
- ุนุฏู ุงููุฏุฑุฉ ุนูู ุญู ุงููุดุงูู ุฐุงุชูุงู

---

### ๐ข **ูุดููุฉ #54: ุนุฏู ูุฌูุฏ Success Confirmations ูุงุถุญุฉ**
**ุงูุฎุทูุฑุฉ:** ููุฎูุถุฉ
**ุงูููู:** ูุงุฌูุฉ ุงููุณุชุฎุฏู

**ูุตู ุงููุดููุฉ:**
- ุจุนุถ ุงูุนูููุงุช ุชูุฌุญ ุจุฏูู ุฃู confirmation
- ุงููุณุชุฎุฏู ูุง ูุนุฑู ุฅุฐุง ูุฌุญุช ุงูุนูููุฉ
- ูุง ููุฌุฏ toast/snackbar ูููุฌุงุญ

**ุงูุชุฃุซูุฑ:**
- uncertainty ูููุณุชุฎุฏู
- ุฅุนุงุฏุฉ ูุญุงููุฉ ุงูุนูููุงุช ุงููุงุฌุญุฉ
- ุนุฏู ุงูุซูุฉ ูู ุงูุชุทุจูู

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ุงูููุงุฆูุฉ

### **ุชูุฒูุน ุงููุดุงูู ุญุณุจ ุงูุฎุทูุฑุฉ:**
- ๐ด **ุญุฑุฌุฉ:** 28 ูุดููุฉ (52%)
- ๐ **ุนุงููุฉ:** 8 ูุดุงูู (15%)
- ๐ก **ูุชูุณุทุฉ:** 10 ูุดุงูู (18%)
- ๐ข **ููุฎูุถุฉ:** 8 ูุดุงูู (15%)

### **ุชูุฒูุน ุงููุดุงูู ุญุณุจ ุงููุฆุฉ:**
- ๐๏ธ **ูุงุนุฏุฉ ุงูุจูุงูุงุช:** 8 ูุดุงูู
- ๐ **ุงููุฒุงููุฉ:** 10 ูุดุงูู
- ๐ฏ **ุญู ุงูุชุถุงุฑุจุงุช:** 4 ูุดุงูู
- ๐พ **Cache:** 4 ูุดุงูู
- ๐ **Supabase Schema:** 3 ูุดุงูู
- ๐ **Offline Mode:** 4 ูุดุงูู
- ๐ฆ **ุงูุฎุฏูุงุช ุงููุญููุฉ:** 4 ูุดุงูู
- ๐ **ุงูุฃูุงู:** 3 ูุดุงูู
- ๐งช **ุงูุงุฎุชุจุงุฑ:** 3 ูุดุงูู
- ๐ **ุงูุชูุซูู:** 3 ูุดุงูู
- ๐ง **ุงูุฃุฏุงุก:** 4 ูุดุงูู
- ๐จ **UX/UI:** 4 ูุดุงูู

---

## โ๏ธ ุงููุดุงูู ุงูุชู ุชุญุชุงุฌ ุงูุชุจุงู ููุฑู

**ุงูุฃููููุฉ ุงููุตูู (ุญู ุฎูุงู ุฃุณุจูุน):**
1. โ ุนุฏู ุชุฒุงูู Schema (#1)
2. โ ุชุถุงุฑุจ ููุงุฆู ุงููุฒุงููุฉ (#9)
3. โ Race Conditions (#10)
4. โ ูุนุงูุฌุฉ ุฃุฎุทุงุก ุถุนููุฉ (#11)
5. โ ูุฒุงููุฉ Variants ุบูุฑ ููุซููุฉ (#12)
6. โ ุฌุฏุงูู ูุงูุตุฉ (#27)
7. โ RLS Policies ูุชุถุงุฑุจุฉ (#28)

**ุงูุฃููููุฉ ุงูุนุงููุฉ (ุญู ุฎูุงู ุฃุณุจูุนูู):**
- ุงูููุฑุณุฉ ุบูุฑ ุงููุงููุฉ (#2)
- Constraints ูุงูุตุฉ (#3)
- ุนุฏู ูุฒุงููุฉ ุงูุตูุฑ (#13)
- ุชุฑุชูุจ ุงููุฒุงููุฉ ุบูุฑ ูุถููู (#14)
- ุนุฏู ูุฒุงููุฉ ุงูุญุฐู (#15)
- ุงุณุชุฑุงุชูุฌูุงุช ุชุถุงุฑุจ ุจุณูุทุฉ (#19)
- Cache invalidation ุบูุฑ ุฏููู (#23)
- Memory leak ูู Cache (#24)

---

**ุชู ุฅุนุฏุงุฏ ุงูุชูุฑูุฑ ุจูุงุณุทุฉ:** Claude Code Analysis Engine
**ุชุงุฑูุฎ:** 2025-01-19
**ูุณุฎุฉ:** 1.0 - Problems Only Report
